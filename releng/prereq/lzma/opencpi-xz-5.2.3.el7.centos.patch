diff -rupN xz-5.0.5.orig/configure.ac xz-5.0.5/configure.ac
--- xz-5.0.5.orig/configure.ac	2015-09-10 06:36:04.928649454 -0400
+++ xz-5.0.5/configure.ac	2015-09-10 06:36:32.312327497 -0400
@@ -29,6 +29,12 @@ echo "$PACKAGE_STRING"
 
 echo
 echo "System type:"
+OS_VERSION
+AS_CASE([$host_os],[*darwin*],[HOSTOS="macos"],[*linux*],[HOSTOS="linux"])
+AC_SUBST([HOSTOS])
+AS_CASE([$host_cpu],[x86_64],[HOSTARCH="x86_64"],[i?86],[HOSTARCH="x86"],[arm*],[HOSTARCH="arm"])
+AC_SUBST([HOSTARCH])
+
 # This is needed to know if assembler optimizations can be used.
 AC_CANONICAL_HOST
 
@@ -535,6 +541,7 @@
 # The -Wno-unsupported is used to silence warnings about missing
 # "subdir-objects".
 AM_INIT_AUTOMAKE([1.12 foreign tar-v7 filename-length-max=99 serial-tests -Wno-unsupported])
+m4_ifdef([AM_SILENT_RULES], [AM_SILENT_RULES([yes])])
 AC_PROG_LN_S
 
 AC_PROG_CC_C99
diff -rupN xz-5.0.5.orig/m4/osver.m4 xz-5.0.5/m4/osver.m4
--- xz-5.0.5.orig/m4/osver.m4	1969-12-31 19:00:00.000000000 -0500
+++ xz-5.0.5/m4/osver.m4	2015-09-10 06:36:32.313327485 -0400
@@ -0,0 +1,51 @@
+AC_DEFUN([OS_VERSION],
+[
+	AC_CACHE_CHECK([os version], os_cv_os_ver, [
+		AC_ARG_WITH(os-ver,
+		AC_HELP_STRING([--with-os-ver], [host os version (default from environment variable 'TARGET_OS_VERSION', options: c6/c7/zynq/rhel default is'c6')]),
+		os_cv_os_ver=$withval,
+        if test "x${TARGET_OS_VERSION}" != "x"; then
+			os_cv_os_ver=${TARGET_OS_VERSION}
+		else 
+		if test -f /etc/redhat-release; then
+        # redhat/centos is just based on the major release number,
+        # with minor releases assumed to be binary compatible.
+        temp=$(cat /etc/redhat-release)       
+        temp2=$( sed -e 's/\([0-9]\)\..*/\1/' /etc/redhat-release)
+        v2=$(sed -e 's/^@<:@^0-9@:>@*\(@<:@0-9@:>@\+\)\..*$/\1/' /etc/redhat-release)
+        v3=$(echo $v2 | sed 's/\ (Final)//')
+        v1=$(echo "$temp" | sed 's/^\(.\).*/\1/' |  tr A-Z a-z)         
+        echo $v1$v3
+        if test "$temp" = ""; then
+        echo Cannot parse redhat/centos release from /etc/redhat-release 1>&2
+    exit 1
+  fi
+  os_cv_os_ver=$v1$v3
+elif test -f /etc/lsb-release; then
+  . /etc/lsb-release
+  os_cv_os_ver=`echo $DISTRIB_ID|sed 's/^\(.\).*/\1/' | tr A-Z a-z``echo $DISTRIB_RELEASE|sed 's/^\([^.]*\).*/\1/'`
+elif test -f /etc/os-release; then
+  # We'll assume debian
+  . /etc/os-release
+  os_cv_os_ver=d$VERSION_ID
+elif test $HostSystem = darwin -a "`which sw_vers`" != ""; then
+  os_cv_os_ver=`sw_vers -productVersion | sed 's/^\([0-9][0-9]*\.[0-9][0-9]*\).*/\1/' | tr . _`
+elif test "$HostSystem" = linux -a -f /etc/rootfs_version; then
+  os_cv_os_ver=iv
+elif test "$HostSystem" = linux -a "$HostProcessor" = armv7l; then
+  os_cv_os_ver=zynq
+else
+  echo Cannot determine runtime host'!!' 1>&2
+  exit 1
+fi
+		fi
+		)
+    AC_MSG_CHECKING($os_cv_os_ver)
+	dnl check if this is a cross compile session, prepend the sysroot
+	AS_IF([test "x$cross_compiling" = "xyes"],[ 
+	CROSS_SYSROOT=`$CC --print-sysroot`
+	os_os_ver=${CROSS_SYSROOT}${os_cv_os_ver}
+	])
+	])
+AC_SUBST(os_ver, $os_cv_os_ver)
+])
