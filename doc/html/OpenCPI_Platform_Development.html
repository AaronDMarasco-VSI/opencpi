<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
  <!-- This file was converted to xhtml by Writer2xhtml ver. 1.5.2. See http://writer2latex.sourceforge.net for more info. -->
  <head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <title>OCPI_ODT</title>
    <meta charset="UTF-8" />
    <meta content="" name="description" />
    <meta content="" name="keywords" />
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC" />
    <meta content="OCPI_ODT" name="DC.title" />
    <meta content="" name="DC.subject" />
    <meta content="" name="DC.description" />
    <meta content="James Kulp" name="DC.creator" />
    <meta content="2016-05-23T18:12:01.172280000" name="DC.date" />
    <meta content="en" name="DC.language" />
    <style media="all" type="text/css">
      body {font-family:Calibri,serif;font-size:13.333334px}
      span.Code {font-family:'Courier New',monospace;font-weight:bold;font-size:16.0px;background-color:transparent}
      span.FirstEmphasis {font-family:Arial,serif;font-style:italic;font-weight:bold;font-size:16.0px}
      a:link {font-family:Arial,sans-serif;font-size:16.0px;color:#0000ff;text-decoration:underline}
      a:visited {color:#800000;text-decoration:underline}
      p.ListNumber {margin-left:38.4px;margin-right:38.4px;margin-top:4.8px;margin-bottom:4.8px;border:none;padding:0;text-indent:-19.2px;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.List3 {margin-left:0;margin-right:0;margin-top:0;margin-bottom:9.331201px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.Standard {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.TableHeading {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-weight:bold;font-size:16.0px}
      p.TableCaptionbefore {margin-left:0;margin-right:0;margin-top:9.6px;margin-bottom:14.400001px;border:none;padding:0;text-align:center;font-family:Arial,serif;font-style:italic;font-size:16.0px}
      p.Code {margin-left:24.0px;margin-right:0;margin-top:4.0032px;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:'Courier New',monospace;font-weight:bold;font-size:14.666667px}
      p.TableContents {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:14.666667px}
      p.Contents3 {margin-left:32.016px;margin-right:0;margin-top:0;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:Calibri,serif;font-size:14.666667px}
      p.ContentsHeading {page-break-before:always;margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:8.016px;border:none;padding:0;text-align:center;font-family:'Liberation Sans',sans-serif;font-weight:bold;font-size:16.0px}
      p.Textbody {margin-left:0;margin-right:0;margin-top:0;margin-bottom:9.331201px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.Contents2 {margin-left:15.984px;margin-right:0;margin-top:0;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:Calibri,serif;font-weight:bold;font-size:14.666667px}
      p.IndentHang {margin-left:60.019196px;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-indent:-36.0192px;text-align:left;font-family:Arial,serif;font-style:normal;font-size:16.0px}
      p.ListBullet {margin-left:38.4px;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-indent:-19.2px;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.Contents1 {margin-left:0;margin-right:0;margin-top:8.016px;margin-bottom:0;border:none;padding:0;text-align:left;font-family:Calibri,serif;font-weight:bold;font-size:16.0px}
      p.Body {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      h1 {page-break-before:always;margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-weight:bold;font-size:18.666668px;clear:left}
      h2 {page-break-before:always;margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-style:italic;font-weight:bold;font-size:16.0px;clear:left}
      h3 {margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-style:italic;font-size:16.0px;clear:left}
      h4 {margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-style:italic;font-size:16.0px;clear:left}
      .listlevel1Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel2Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel3Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel4Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel5Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel6Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel7Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel8Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel9Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel1WWNum32 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel2WWNum32 {margin-top:0;margin-bottom:0;list-style-type:bullet;clear:left}
      .listlevel3WWNum32 {margin-top:0;margin-bottom:0;list-style-type:square;clear:left}
      .listlevel4WWNum32 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel5WWNum32 {margin-top:0;margin-bottom:0;list-style-type:bullet;clear:left}
      .listlevel6WWNum32 {margin-top:0;margin-bottom:0;list-style-type:square;clear:left}
      .listlevel7WWNum32 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel8WWNum32 {margin-top:0;margin-bottom:0;list-style-type:bullet;clear:left}
      .listlevel9WWNum32 {margin-top:0;margin-bottom:0;list-style-type:square;clear:left}
    </style>
  </head>
  <body dir="ltr">
    <p class="Standard" dir="ltr" style="text-align:center"><span style="font-weight:bold;font-size:37.333336px">OpenCPI<br />Platform Development<br />Guide</span></p>
    <p class="Standard" dir="ltr" style="text-align:center;font-size:18.666668px"> </p>
    <p class="Standard" dir="ltr" style="font-size:18.666668px"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr" style="font-style:italic;font-weight:bold;font-size:29.333334px;color:#ff0000">Preliminary</p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr" style="page-break-before:always;margin-top:0;margin-bottom:0;text-align:center;font-style:italic">Revision History</p>
    <table cellspacing="0" dir="ltr" id="Table1table" style="margin-top:0;margin-bottom:0;margin-left:0;margin-right:auto;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="text-align:center;font-weight:bold;font-size:10.666667px">Revision</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="text-align:center;font-weight:bold;font-size:10.666667px">Description of Change</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="text-align:center;font-weight:bold;font-size:10.666667px">Date</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.01</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0"><span style="font-size:9.333334px">Initial</span></p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0"><span style="font-size:9.333334px">2014-12-15</span></p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.5</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Release partial draft</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2015-02-27</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.6</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Add more general introduction to enabling systems for OpenCPI</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2015-04-23</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.7</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Add content about device workers/subdevices/device proxies and endpoint proxies.</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2015-05-06</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.8</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Add content about platforms and platform workers, apply review comments for HDL devices</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2015-06-22</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.9</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Add content about developing HDL  platform support outside the core directory tree</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2015-08-28</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:52.6624px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">1.0</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:458.32962px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Update for 2016Q2 release</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:59.996803px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2016-05-23</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0"> </p>
    <p class="Contents1" dir="ltr" style="page-break-before:always;text-align:center">Table of Contents</p>
    <div id="TableofContents1">
      <p class="ContentsHeading" dir="ltr"></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">1 </span><a href="#toc0">Introduction</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">1.1 </span><a href="#toc1">References</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">2 </span><a href="#toc2">OpenCPI Systems and Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">2.1 </span><a href="#toc3">Inside an OpenCPI Platform</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">2.2 </span><a href="#toc4">Development and Execution</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">2.3 </span><a href="#toc5">Enabling New Systems for OpenCPI</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">2.4 </span><a href="#toc6">A Process Template for Enabling OpenCPI on a New System.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.1 </span><a href="#toc7">System inventory</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.2 </span><a href="#toc8">Processor,  interconnect and device assessment</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.3 </span><a href="#toc13">Assemble Technical Data Package</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.4 </span><a href="#toc14">Experiments to Establish Feasibility and Missing Information</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.5 </span><a href="#toc15">Planning and Specification</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.6 </span><a href="#toc16">Technical Development</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.7 </span><a href="#toc17">Verification</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">2.4.8 </span><a href="#toc18">Contribution</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">3 </span><a href="#toc19">Enabling the Development Host</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">3.1 </span><a href="#toc20">Operating System Installation</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">3.2 </span><a href="#toc21">Development Tools Installation for the Development Host.</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">4 </span><a href="#toc22">Enabling GPP Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.1 </span><a href="#toc23">Enabling Development for New GPP Platforms</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.1 </span><a href="#toc24">Developing a Tool-chain Installation Script</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.2 </span><a href="#toc25">The File to Define the Full Target Specification for the Platform.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.3 </span><a href="#toc26">Developing the Environment Setup Script</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.4 </span><a href="#toc27">Files to Provide Settings for Environment Variables for Framework Development</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.5 </span><a href="#toc28">The Script to Recognize the Currently Running Platform</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.6 </span><a href="#toc29">Developing a Cross-development Component Build Script</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.1.7 </span><a href="#toc30">Summary for Enabling Development for a New GPP Platform</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.2 </span><a href="#toc31">Enabling Execution for GPP Platforms</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">5 </span><a href="#toc32">Enabling FPGA Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.1 </span><a href="#toc33">Physical FPGA Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.2 </span><a href="#toc34">Simulator FPGA Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.3 </span><a href="#toc35">Enabling Development for FPGA Platforms</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.3.1 </span><a href="#toc36">Installing the Tool Chain</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.3.2 </span><a href="#toc37">Integrating the Tool Chain into the OpenCPI HDL Build Process.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.3.3 </span><a href="#toc38">Building All the Existing Portable HDL Code</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.3.4 </span><a href="#toc39">Scripts for HDL Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.4 </span><a href="#toc40">Enabling Execution for FPGA platforms</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.4.1 </span><a href="#toc41">Creating the XML Metadata Definition of the Platform</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.4.2 </span><a href="#toc44">Creating the Platform Worker</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.4.3 </span><a href="#toc49">Specifying Platform Configurations in XML Files.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.4.4 </span><a href="#toc50">Testing the Basic Platform without Devices</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.5 </span><a href="#toc51">Device Support for FPGA Platforms</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.1 </span><a href="#toc52">Device Component Specs and Device Worker Modularity</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.2 </span><a href="#toc53">Device Proxies — Software Workers that Control HDL Device Workers</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.3 </span><a href="#toc54">A Device Worker Implements the Data Sheet</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.4 </span><a href="#toc55">Subdevice Workers</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.5 </span><a href="#toc56">Higher-level Endpoint Proxies Suitable for Applications</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.6 </span><a href="#toc57">XML Metadata for Device Workers/Subdevices/DeviceProxies/EndpointProxies</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.5.7 </span><a href="#toc63">Associating Device Workers and Subdevice Workers with Platforms and Cards.</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">6 </span><a href="#toc64">Enabling GPU Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">6.1 </span><a href="#toc65">Enabling Development for GPU Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">6.2 </span><a href="#toc66">Enabling Execution for GPU Platforms</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">6.3 </span><a href="#toc67">I/O Device Support for GPU Pßlatforms</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">7 </span><a href="#toc68">Glossary</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">8 </span><a href="#toc69">From PPT:</a></p>
    </div>
    <h1 dir="ltr" id="toc0"><span class="SectionNumber">1 </span><a id="Toc144999751"></a><a id="Toc57540727"></a><a id="RefHeading10151060509377"></a><a id="Toc57540730"></a>Introduction</h1>
    <p class="Body" dir="ltr"><a id="GoBack"></a>This document describes how to enable OpenCPI components and applications to run on new platforms.  It assumes a basic knowledge of OpenCPI as described in the <span class="FirstEmphasis">OpenCPI Overview</span> and <span class="FirstEmphasis">OpenCPI Component Development Guide</span>.  Platform development is the third class of OpenCPI development, beyond component development and application development.  It involves configuring, adapting and wrapping various aspects of hardware platforms, operating systems, system libraries, and development tools.  It applies to general purpose computing platforms, FPGA platforms and GPU platforms.  It applies to self-hosted development as well as cross development.</p>
    <p class="Body" dir="ltr">The questions this document tries to answer are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">What are suitable platforms?</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">What is involved in making a platform ready?</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">What are the actual steps and processes for making a platform ready?</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">These questions are answered separately for execution vs. development.</p>
    <p class="Body" dir="ltr">These questions are answered separately for GPP, FPGA, and GPU platforms.</p>
    <p class="Body" dir="ltr">After introducing all these topics, this document has sections for each aspect in the following table, </p>
    <p class="TableCaptionbefore" dir="ltr">Table 1:  Categories of Platform Development</p>
    <table cellspacing="0" dir="ltr" id="Table3table" style="margin-top:0;margin-bottom:0;margin-right:auto;width:620.1312px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:69.262405px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8px">
            <p class="TableHeading" dir="ltr" style="text-align:center;font-size:14.666667px"> </p>
            <p class="TableHeading" dir="ltr" style="text-align:center;font-size:14.666667px">Examples</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8672px">
            <p class="TableHeading" dir="ltr" style="text-align:center;font-size:14.666667px">Development<br />Tools</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:126.79521px">
            <p class="TableHeading" dir="ltr" style="text-align:center;font-size:14.666667px">Execution<br />Environment</p>
          </td>
          <td style="border:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:181.73439px">
            <p class="TableHeading" dir="ltr" style="text-align:center;font-size:14.666667px">I/O and Interconnect<br />Device Support</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:69.262405px">
            <p class="Textbody" dir="ltr" style="font-weight:bold;font-size:12.0px">General-Purpose Processors<br />(GPPs)</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">X86<br />(Intel/AMD),</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">ARM<br />(Xilinx/Altera/TI)</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8672px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Compiler<br />tool-chains</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:126.79521px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Operating System,</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Libraries,</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Drivers</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:181.73439px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:69.262405px">
            <p class="Textbody" dir="ltr" style="font-weight:bold;font-size:12.0px">FPGAs</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Xilinx<br />(virtex, zynq)</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Altera<br />(stratix, cyclone)</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Mentor/Modelsim</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8672px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Synthesis</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Place&amp;route</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Simulation</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:126.79521px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Bitstream loading</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Control Plane Drivers</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Data Plane Drivers</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:181.73439px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Directly attached I/O devices</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:69.262405px">
            <p class="Textbody" dir="ltr" style="font-weight:bold;font-size:12.0px">Graphics Processors</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Nvidia Tesla</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">AMD FirePro</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:99.8672px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Compilers,<br />Profilers</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:126.79521px">
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Execution Management</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Drivers</p>
            <p class="Textbody" dir="ltr" style="font-size:12.0px">Data Plane Drivers</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:181.73439px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 dir="ltr" id="toc1"><span class="SectionNumber">1.1 </span><a id="Toc144999752"></a><a id="RefHeading10171060509377"></a>References</h2>
    <p class="Standard" dir="ltr">This document requires information from several others.  To actually perform platform development it is generally useful to understand OpenCPI component and application development, as well as the installation process for previously enabled platforms.  To simply get a flavor for what is involved in platform development, only the OpenCPI Introduction is required.</p>
    <p class="TableCaptionbefore" dir="ltr">Table 1 - Table of Reference Documents</p>
    <table cellspacing="0" dir="ltr" id="Table2table" style="margin-top:0;margin-bottom:0;margin-left:0;margin-right:auto;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:222.80319px">
            <p class="TableHeading" dir="ltr">Title</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:101.7376px">
            <p class="TableHeading" dir="ltr">Published By</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:246.46722px">
            <p class="TableHeading" dir="ltr">Link</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:222.80319px">
            <p class="Standard" dir="ltr">OpenCPI Introduction</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:101.7376px">
            <p class="Standard" dir="ltr" style="text-align:center">OpenCPI</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:246.46722px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:222.80319px">
            <p class="Standard" dir="ltr">OpenCPI Installation Guide</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:101.7376px">
            <p class="Standard" dir="ltr" style="text-align:center">OpenCPI</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:246.46722px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:222.80319px">
            <p class="Standard" dir="ltr">OpenCPI Component Development Guide</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:101.7376px">
            <p class="Standard" dir="ltr" style="text-align:center">OpenCPI</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:246.46722px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:222.80319px">
            <p class="Standard" dir="ltr">OpenCPI Application Development Guide</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:101.7376px">
            <p class="Standard" dir="ltr" style="text-align:center">OpenCPI</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:middle;width:246.46722px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h1 dir="ltr" id="toc2"><span class="SectionNumber">2 </span><a id="Toc144999753"></a><a id="RefHeading10191060509377"></a>OpenCPI Systems and Platforms</h1>
    <p class="Standard" dir="ltr">OpenCPI provides a consistent model and framework for component-based application development and execution on various combinations of (“heterogeneous”) processing technologies, focusing mostly on embedded systems.</p>
    <p class="Standard" dir="ltr">An “<span style="font-style:italic;font-weight:bold">OpenCPI system</span>” is a collection of processing elements that can be used together as resources for running component-based applications.  While, at a high level, the system has processors of various types that are “places for components to run”,  each processor is itself part of a hardware subsystem.  These subsystems are wired together using some interconnect technologies (e.g. networks, buses, fabrics, cables).</p>
    <p class="Standard" dir="ltr">We call each available processor and its surrounding directly-connected hardware a <span class="FirstEmphasis">platform</span>.  Most commonly, a platform is a “card” or “motherboard” housing a processor and associated memory and I/O devices.  We call the data paths that allow platforms to communicate with each other <span class="FirstEmphasis">interconnects</span>.  The most common interconnects for OpenCPI systems are PCI Express or Ethernet, although others are also supported and used for some platforms (e.g. the AXI system interconnects on Xilinx Zynq-based systems).</p>
    <p class="Standard" dir="ltr">The scope of a system can be a small embedded system that fits in a pocket, or racks full of network-connected hardware that act as a “system of systems”.  Since this “system” definition is somewhat broad, we target the efforts to enable running OpenCPI at each <span class="FirstEmphasis">platform</span> and <span class="FirstEmphasis">interconnect</span> within a system.  Hence <span style="font-style:italic;font-weight:bold">platform development</span> is enabling a platform, and <span style="font-style:normal">enabling a system is</span><span style="font-style:italic"> enabling whatever platforms and interconnects are in the system</span>.</p>
    <p class="Standard" dir="ltr">Our most common and simple example system is the ZedBoard from Digilent (zedboard.org), which is based on the Xilinx Zynq chip.  This chip is called a “system on chip” or SoC, and indeed has two processing elements connected with an interconnect, all on one chip:  1) a dual-core ARM general-purpose processor, and 2) an FPGA.  They are connected via an on-chip fabric based on the AXI standard, and each is connected to some I/O devices.  Thus the ZedBoard <span style="font-style:italic;font-weight:bold">system</span> consists of two <span style="font-style:italic;font-weight:bold">platforms</span> that happen to reside in the same chip, with an AXI <span style="font-style:italic;font-weight:bold">interconnect</span> between them.</p>
    <p class="Standard" dir="ltr">Another common example system is a typical PC, which has a multicore (1-12) Intel or AMD x86 processor on a motherboard.  If cards are plugged into slots on the PC's motherboard, and those cards have processors (e.g. GPP, FPGA, GPU) on them, then those cards can act as additional platforms in that system.</p>
    <p class="Standard" dir="ltr">We consider multi-core GPPs as single “processors” since they generally run a single operating system and act as a single resource that can run multiple threads concurrently.</p>
    <p class="Standard" dir="ltr">The final defined element of an OpenCPI system is <span style="font-style:italic;font-weight:bold">devices</span>, which are locally attached to some platform to allow the source or sink of data flowing between component to enter or exit the system.  Thus devices are distinct from interconnects.</p>
    <p class="Standard" dir="ltr">A <span class="FirstEmphasis">system</span> consists of <span class="FirstEmphasis">platforms</span> connected by <span class="FirstEmphasis">interconnects</span>, and platforms can have locally attached <span class="FirstEmphasis">devices</span>.</p>
    <h2 dir="ltr" id="toc3"><span class="SectionNumber">2.1 </span><a id="RefHeadingToc4319234407367"></a>Inside an OpenCPI Platform</h2>
    <p class="Body" dir="ltr">As mentioned above, a <span style="font-style:italic;font-weight:bold">platform</span> consists of a processor (GPP, FPGA, GPU, etc.) attached to <span style="font-style:italic;font-weight:bold">interconnects</span> allowing it to communicate with other platforms.  The processor may have multiple cores, and may even consist of multiple processor chips (such as a dual-socket motherboard where two Intel X86 processors act together).  There are two other elements that make up a platform:  <span style="font-style:italic;font-weight:bold">devices</span> and <span style="font-style:italic;font-weight:bold">slots</span>.  </p>
    <p class="Body" dir="ltr"><span style="font-style:italic;font-weight:bold">Devices</span> are hardware elements that are locally attached to the processor of the platform.  They are controlled by special workers called <span class="FirstEmphasis">device workers</span> (analogous to “device drivers”), and usually act as sources or sinks for data into or out of the system, and thus can be used for inputs and outputs for a component-based application running on that system.</p>
    <p class="Body" dir="ltr">When a device is hard-wired to the platform, it is defined as part of the platform.  It is also common for platforms to be optionally configured with add-on <span style="font-style:italic;font-weight:bold">cards</span> that provide additional devices for the platform.  To allow for this, platforms can have <span style="font-style:italic;font-weight:bold">slots</span>, which are an intrinsic part of the platform, and enable cards to be plugged in that add devices to the platform.  Such cards may be plugged in to any platforms that have compatible slots.</p>
    <p class="Body" dir="ltr">Thus the devices available on a platform are either a permanent part of the platform, or are optionally configured as being available on defined cards when they are plugged into one of the platform's slots.</p>
    <p class="Body" dir="ltr">Platforms can have any number of devices, and may have multiple devices of the same type.  When cards are plugged into a platform's slots, they make additional devices available on the platform.</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Systems have platforms and interconnects.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Platforms have slots and devices.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Cards plug into slots and have devices.</p>
      </li>
    </ul>
    <h2 dir="ltr" id="toc4"><span class="SectionNumber">2.2 </span><a id="RefHeading10211060509377"></a>Development and Execution</h2>
    <p class="Standard" dir="ltr">Every platform must be enabled for development as well as execution.  <span style="font-style:italic">Development</span> is the process of producing “executable binaries”, and <span style="font-style:italic">execution</span> is the process of running those binaries on the available platforms in a system, as part of the execution of a component-based application.  OpenCPI uses the term “binary artifact” as a technology-neutral term for the binary file that executes on various processing technologies.  On GPPs, they are typically “shared object files” or “dynamic libraries”.  On FPGAs, they are sometimes called “bitstreams”.  On GPUs, they are sometimes called “graphics kernels”.</p>
    <p class="Standard" dir="ltr">Enabling <span style="font-style:italic">development</span> is procuring, installing, configuring and integrating the various tools necessary to enable the developer to design and create binary artifacts from source code, for a given target platform.  Some adaptations, scripts or wrappers are typically required to enable such tools to operate in the OpenCPI development context.  OpenCPI does not contain, preclude or require GUI-based IDEs in the component or application development process.</p>
    <p class="Standard" dir="ltr">For most embedded systems, the development tools do not run on the system itself, but run on a separate “development host”, typically a (possibly virtual) PC.  The unusual, but still possible, case where the tools run on the targeted embedded system itself, is termed “self-hosted development”.  When the target platform is embedded and development tools run on a “development host”, that is termed “cross development”, using “cross-tools” (e.g. cross-compilers).</p>
    <p class="Standard" dir="ltr">All development hosts also act as execution platforms since any host capable of running development tools can act as an OpenCPI execution platform for the GPP/processor of that system.  OpenCPI contains tools that must be compiled on the development host and will always run on the development host.  Thus a development host is established to execute tools used both to create binaries for itself and other target platforms (cross development).  These tools include both OpenCPI's own tools as well as target-specific tools from third parties.</p>
    <h2 dir="ltr" id="toc5"><span class="SectionNumber">2.3 </span><a id="RefHeadingToc4321234407367"></a>Enabling New Systems for OpenCPI</h2>
    <p class="Body" dir="ltr">Enabling systems for OpenCPI implies enabling the platforms and interconnects in the system for OpenCPI, as well as enabling the processors and devices on the platforms and the devices on any cards used in the system.  The first step in the enabling process is to establish the inventory of these elements in the system.</p>
    <p class="Body" dir="ltr">Since interconnects, processors, and common devices are frequently found in many different systems, it is likely that support for some of them is already available in OpenCPI.  So the enabling process is reduced to only dealing with the elements that do not already have OpenCPI support.  Furthermore, there may be devices in the system that do not require OpenCPI in a particular situation, either because they are not going to be used, or their use is outside the scope of what OpenCPI does.</p>
    <p class="Body" dir="ltr">The system inventory for OpenCPI is:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Processors</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Interconnects</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Devices</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">For each, if there is no existing support in OpenCPI, support modules must be developed.  For some, there may be partial support that must be extended for the intended usage.  For new classes of processor (beyond GPP, FPGA, GPU) or new interconnects, the core framework of OpenCPI must be enhanced.  Otherwise individual support modules can be developed without modifying the core infrastructure layers of OpenCPI.  Later sections of this document describe the requirements and process of enabling each type of element in the system.  Processors require development support as well as runtime support.  Devices and interconnects require only runtime support.</p>
    <p class="Body" dir="ltr">Since OpenCPI is open source software, it is very desirable to contribute new or extended support modules back to the community since most such modules will likely be used in other systems.</p>
    <p class="Body" dir="ltr">A key aspect of supporting new system elements is obtaining the necessary technical information and tools, and in some cases performing a variety of experiments to assess feasibility and derive otherwise unavailable information.  When the information is not available from public sources (such as data sheets for device ICs), NDAs or other confidentiality agreements may be required.  Vendors may refuse to supply the necessary information, leaving reverse engineering the only option.</p>
    <p class="Body" dir="ltr">Since OpenCPI, especially on FPGAs, operates directly on the FPGA devices and usually interacts directly with attached devices, either the vendor must supply the required device workers or supply the information required to development them.  Preexisting FPGA drivers for attached devices that were not written with OpenCPI in mind are usually unsuitable as is, and must be either modified or replaced.  In some cases then can be “wrapped”, although this usually results in unnecessary extra overhead.</p>
    <h2 dir="ltr" id="toc6"><span class="SectionNumber">2.4 </span><a id="RefHeadingToc4323234407367"></a>A Process Template for Enabling OpenCPI on a New System.</h2>
    <p class="Body" dir="ltr">Here is a list of steps normally required to enable a new system for OpenCPI.  The first four steps are used to establish a clear base of information to estimate and plan the effort.</p>
    <h3 dir="ltr" id="toc7"><span class="SectionNumber">2.4.1 </span><a id="RefHeadingToc4325234407367"></a>System inventory</h3>
    <p class="Body" dir="ltr">Collect information to determine the rough <span style="font-weight:bold">scope of the effort.</span></p>
    <p class="Standard" dir="ltr" style="font-weight:normal">This is the basic inventory of the relevant parts of the system, each of which needs to be considered in planning to enable the system.</p>
    <p class="Body" dir="ltr">Collect sufficient information to develop the list of processors, interconnects, and devices in the system that are relevant to OpenCPI applications, establishing the system breakdown.  This is usually a “data sheet” exercise.</p>
    <p class="Body" dir="ltr">The result is a list of system elements that need to be assessed, specifically identified as to the devices involved.  This activity should not take more than a week unless information about the target system is unavailable or unduly restricted.</p>
    <h3 dir="ltr" id="toc8"><span class="SectionNumber">2.4.2 </span><a id="RefHeadingToc4327234407367"></a>Processor,  interconnect and device assessment</h3>
    <p class="Standard" dir="ltr">Evaluate the state of support already in OpenCPI and what additional technical efforts are likely to be required.  These assessments establish a rough level of effort, without necessarily establishing feasibility.  A ROM (rough order or magnitude) LOE (level of effort) can be established.</p>
    <p class="Standard" dir="ltr">This effort requires matching technical support requirements with the current state of support in OpenCPI, and thus would require either gaining some familiarity with the OpenCPI supported hardware universe, or engaging with a group that is already familiar with it.</p>
    <h4 dir="ltr" id="toc9"><span class="SectionNumber">2.4.2.1 </span>For each processor, determine whether it is already supported in OpenCPI, needs some incremental/enhanced support, or needs entirely new support.  The categories are:</h4>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Already supported (e.g. Zynq ARM processor, Intel AMD x86 processor)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Variant supported (e.g. Virtex6 vs. Virtex 7 FPGA)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New processor of existing type (e.g. PPC CPU vs. ARM CPU)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New class of processor (e.g. Adapteva Multicore).  This requires new work usually outside the scope of “enabling a new system”.</p>
      </li>
    </ul>
    <h4 dir="ltr" id="toc10"><span class="SectionNumber">2.4.2.2 </span>For each processor, determine whether new tools are required that have not been integrated with OpenCPI before.  Categories are:</h4>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Tools are already supported by OpenCPI</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Tools require a version upgrade/downgrade/variant of what is already supported.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Tools are completely new and not yet supported by OpenCPI.</p>
      </li>
    </ul>
    <h4 dir="ltr" id="toc11"><span class="SectionNumber">2.4.2.3 </span>For each interconnect, determine level of support required for each processor type that is attached to it.  Categories are:</h4>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Interconnect is already supported adequately in OpenCPI</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Interconnect support requires enhancements (e.g. PCI-E gen3x8, vs. PCI-E gen2x4).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Interconnect support missing for processor type (e.g. Ethernet L2 on FPGAs).</p>
      </li>
    </ul>
    <h4 dir="ltr" id="toc12"><span class="SectionNumber">2.4.2.4 </span>For each device, evaluate the state of support already in OpenCPI and what additional technical efforts are likely to be required the each device, as it will be attached to its processor..</h4>
    <p class="Body" dir="ltr">Determine whether it is already supported in OpenCPI, needs some incremental/enhanced support, or entirely new support.  The categories are:</p>
    <p class="Body" dir="ltr">For each device attached to a processor, or on a required card, determine whether existing OpenCPI support is adequate.  Categories are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Device is already supported</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Device support requires updating or enhancement.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Device support not present, but similar devices are supported as a model.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Device is different from any existing supported devices.</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc13"><span class="SectionNumber">2.4.3 </span><a id="RefHeadingToc4329234407367"></a>Assemble Technical Data Package</h3>
    <p class="Body" dir="ltr">For all elements requiring updated or new support, collect information necessary to perform the enabling technical development, and to establish more detailed work estimates.  This effort will establish the availability of appropriate information to perform the technical developments.  It will also find any roadblocks to obtaining the information (vendor unwillingness, legacy unavailability).</p>
    <p class="Body" dir="ltr">In the particular case of device support, some vendors do not expose sufficient information to support their devices in the absence of their own “drivers” that embed their ICD (interface control document) information they consider a trade secret.  Such positioning by vendors of course makes them less desirable for OpenCPI-based systems.</p>
    <p class="Body" dir="ltr">Required information for processors/FPGAs include:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Tool requirements (which tools, which settings, cost)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Connectivity technical details (e.g. how interconnects, devices and slots are connected, including pin-outs etc.)</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">Require information for devices include:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Device data sheets or equivalent functional and interface documentation.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Programming/application guides.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Appropriate/relevant existing support modules in OpenCPI's</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">How the devices are attached to the processors. (e.g. ICD)</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">As part of this effort, any additional required feasibility experiments or reverse engineering tasks are identified.  These are tasks to fill in the information gaps in order to have a high confidence work estimates and plans.</p>
    <h3 dir="ltr" id="toc14"><span class="SectionNumber">2.4.4 </span><a id="RefHeadingToc4331234407367"></a>Experiments to Establish Feasibility and Missing Information</h3>
    <p class="Standard" dir="ltr">There are always uncertainties and gaps in technical documentation, and in some cases the information is unavailable due to proprietary restrictions,  In any case, as a final step to enable accurate work breakdowns and time/cost estimates, there are usually a set of tasks involving hands-on experience with the target system prior to the actual technical developments.  Such tasks are derived from the process of the above tasks (i.e. discovering knowledge gaps), and may include:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Verify and/or establish functional or performance capabilities of the system that are missing or questionable from the information obtained earlier.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Reverse-engineer missing ICD aspects (assuming no legal impediments).</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">These hands-on efforts establish the final information to plan and budget for the effort of  enabling a new system for OpenCPI.  This activity depends on access to a real system.</p>
    <h3 dir="ltr" id="toc15"><span class="SectionNumber">2.4.5 </span><a id="RefHeadingToc4333234407367"></a>Planning and Specification</h3>
    <p class="Standard" dir="ltr">This phase of enabling a system is specifying the technical capabilities to be achieved for OpenCPI on the target system, and planning the tasks to develop and verify each functionality.  The specifications are mostly based on achieving functionality that already exists on other systems, so the specifications are mostly references to other existing documents, with particular options, exceptions, or limitations highlighted.</p>
    <p class="Standard" dir="ltr">Every system element not currently supported requires a development task, while all system elements, including those supposedly already supported, should still have a verification task planned.</p>
    <p class="Standard" dir="ltr">In some cases, supporting a new system may in fact introduce new classes of support for OpenCPI, in which case the specifications will need to define functionality more fully, which will hopefully end up being a template for such support on other systems.  Otherwise the functionality would be described as the existing baseline for similar devices, with any core enhancements clearly specified.</p>
    <p class="Standard" dir="ltr">The tasks defined here will be of types described more fully in other sections of this document, where the various types of platform development are described in detail.</p>
    <h3 dir="ltr" id="toc16"><span class="SectionNumber">2.4.6 </span><a id="RefHeadingToc4335234407367"></a>Technical Development</h3>
    <p class="Standard" dir="ltr">The various technical development tasks are of the types corresponding to specific sections of this document.  Each type in the following list may or may not be required to enable a given system.  Small updates or enhancements to existing modules are common.</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Enabling a new development system (including native development and execution)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New GPP development tools</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New FPGA tools</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New GPP platform</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New interconnect for GPP platforms.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New interconnect for FPGA platforms</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New FPGA platform.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New FPGA cards</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">New FPGA device</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc17"><span class="SectionNumber">2.4.7 </span><a id="RefHeadingToc4337234407367"></a>Verification</h3>
    <p class="Body" dir="ltr">Verification requirements are very project-specific, but for each system element, a baseline verification should be defined, including specific characterization, both manual and automated.</p>
    <h3 dir="ltr" id="toc18"><span class="SectionNumber">2.4.8 </span><a id="RefHeadingToc4339234407367"></a>Contribution</h3>
    <p class="Standard" dir="ltr">To reduce all efforts at system enablement for OpenCPI, it is strongly encouraged (or in some cases required), that enhancements to existing support modules, and new support modules for widely available processors, interconnects and devices be contributed back to the appropriate repositories.</p>
    <h1 dir="ltr" id="toc19"><span class="SectionNumber">3 </span><a id="RefHeading10231060509377"></a>Enabling the Development Host</h1>
    <p class="Standard" dir="ltr">Before any platform-specific tools are installed on the development host, the basic development configuration must be established for OpenCPI.  The <span class="FirstEmphasis">OpenCPI Installation Guide</span> describes the installation process for supported development hosts, but the basic steps are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Installation of the OS with suitable options and packages.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Installation of native development tools to drive OpenCPI's build system on the development host.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Retrieving current source code for OpenCPI</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Establish a build environment with appropriate options</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Building the core OpenCPI software targeting the development host</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Building and testing the OpenCPI component libraries and example applications</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">Building the core software for the development host includes OpenCPI tool executables, as well as runtime libraries that support both tool execution as well as application/component execution on the development host.</p>
    <p class="Standard" dir="ltr">This section addresses issues specific to development hosts, while following sections address issues for any target platform for execution, which also includes development hosts.</p>
    <p class="Standard" dir="ltr">For a new development platform, the following aspects must be defined, documented, and in some cases, new scripts and software will be required:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Operating system installation/configuration</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Retrieval of OpenCPI source distribution.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Installation of required packages that are available as options with the OS distribution.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Installation of other required packages that require specific download/installations.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">The first two steps are generally manual, requiring written instructions.  The latter two are scripted.  Both the instructions and scripts should be submitted back to the OpenCPI source distribution for the benefit of other users of the same development host installation.</p>
    <h2 dir="ltr" id="toc20"><span class="SectionNumber">3.1 </span><a id="RefHeading176462116501284"></a>Operating System Installation</h2>
    <p class="Standard" dir="ltr">While an existing development system with various software installed can certainly be used as a development host, it is valuable to make a clean installation from scratch to avoid configuration conflicts and problems that simply arise from a mis-match or mis-configuration of the environment.  While most OS installations have a number of manual steps, they should still be written down so they can be reliably repeated on new systems.  Scripts should be written when a number of steps can be automated, being careful to avoid dependencies on other software this early in the installation process.</p>
    <p class="Standard" dir="ltr">See the installation guide for instructions on OS installation for the typical development hosts.  Ideally, a new development host should have a new section written about it in the installation guide document so others can benefit, including:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">How to get the OS (DVD, download, etc.).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">How to perform the installation, with options at least appropriate for OpenCPI development.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">How to update the OS to the most recent patch level.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">How to obtain/download the OpenCPI code base.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">This (normally manual) new procedure should be included in the README file in the platform's directory.  Note that the last step is the first point where any OpenCPI support scripts become available.  The last step, retrieving the OpenCPI source distribution, could consist of network download or downloading to another system and burning CDs/DVDs, or even installing additional tools in order to accomplish the download.  Typically, for network attached systems, it is simply accomplished by using:</p>
    <p class="Code" dir="ltr">% git clone https://github.com/opencpi/opencpi.git</p>
    <p class="Standard" dir="ltr">Once the OpenCPI source distribution is present, scripts to finish the installation can be run out of that tree (after they are created and added to the OpenCPI repository).  The remaining instructions assume you are in the directory created by the git clone command, i.e. you must then do:</p>
    <p class="Code" dir="ltr">% cd opencpi</p>
    <p class="Standard" dir="ltr">In summary, the task to enable this first aspect of the installation is to create the README file explaining the initial OS installation, and the retrieval of the OpenCPI distribution.  Create the new directory under <span class="Code">platforms</span>, named after the development platform, and put the README file in that directory.</p>
    <h2 dir="ltr" id="toc21"><span class="SectionNumber">3.2 </span><a id="RefHeading176482116501284"></a>Development Tools Installation for the Development Host.</h2>
    <p class="Standard" dir="ltr">Most of the remaining steps for enabling the development host are the same as those for supporting any runtime platform, and are explained in the <span class="FirstEmphasis">Enable GPP Platforms</span> section below.  Prior to the installation of any target-platform-specific tools, a basic set of tools must be installed on the development host that will support development for all platforms.</p>
    <p class="Standard" dir="ltr">OpenCPI development requires a number of tools to be available.  These required tools fall into two categories:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Tools typically part of a standard OS and development environment installation.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Tools that OpenCPI has specific scripts for downloading and installing.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">The first category should be installed by a new script written for the development host platform, and placed in the platform's subdirectory under the name <span class="Code"><span style="font-style:italic">&lt;platform&gt;</span>-packages.sh</span>.  This script does what is necessary to perform a standard installation (presumably globally on the system for all users) of at least the following software tools:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr" style="text-align:left;font-family:Arial,serif;font-weight:normal;font-size:16.0px">make</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr" style="text-align:left;font-family:Arial,serif;font-weight:normal;font-size:16.0px">git</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr" style="text-align:left;font-family:Arial,serif;font-weight:normal;font-size:16.0px">C/C++ compiler tool chain</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr" style="text-align:left;font-family:Arial,serif;font-weight:normal;font-size:16.0px">python</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr" style="margin-top:4.8px;margin-bottom:4.8px;text-align:left">This script should be written assuming a minimal OS installation has been performed.  I.e. it should not assume the OS is already a typical development system installation.</p>
    <p class="Standard" dir="ltr" style="margin-top:4.8px;margin-bottom:4.8px;text-align:left">For OpenCPI binary distributions using the RPM or similar package management schemes,  this script would be unnecessary since the installation would automatically deal with such dependencies.</p>
    <p class="Standard" dir="ltr" style="margin-top:4.8px;margin-bottom:4.8px;text-align:left">For reference, the contents of this script for CentOS6, with the name:</p>
    <p class="Code" dir="ltr">platforms/centos6/centos6-packages.sh</p>
    <p class="Standard" dir="ltr">is currently:</p>
    <p class="Code" dir="ltr">#!/bin/sh<br /># Install prerequisite packages for CentOS6<br />echo Installing standard extra packages using "yum"<br />sudo yum -y groupinstall "development tools"<br />echo Installing packages required: tcl pax python-devel<br />sudo yum -y install tcl pax python-devel fakeroot redhat-lsb-core<br />echo Installing 32 bit libraries '(really only required for modelsim)'<br />sudo yum -y install glibc.i686 libXft.i686 libXext.i686 ncurses-libs.i686</p>
    <p class="Standard" dir="ltr">Sometimes extra tools here are required for various tools for other target platforms.  In this example above, some 32 bit libraries are included because they were discovered to be needed by the Modelsim FPGA simulation tool.  It was convenient, for users, to put them here for all installations rather than install them as needed for some tools.  The <span class="Code">tcl</span>, <span class="Code">fakeroot</span>, and <span class="Code">redhat-lsb-core</span> packages are not needed by OpenCPI itself, but are required to install some other packages used with OpenCPI.</p>
    <p class="Standard" dir="ltr">This script is run by the higher level script <span class="Code">install-prerequisites.sh</span>.</p>
    <p class="Standard" dir="ltr">After creating this script, the remaining steps for enabling the development host are the same as for any GPP platform.</p>
    <h1 dir="ltr" id="toc22"><span class="SectionNumber">4 </span><a id="RefHeading10251060509377"></a>Enabling GPP Platforms</h1>
    <p class="Standard" dir="ltr">Enabling a GPP (General Purpose Processor) platform requires two different aspects:  enabling development/cross development, and enabling execution.  Enabling for development allows building component and application binaries for the platform and also enables building the OpenCPI core runtime libraries and runtime command line tools for execution on the target platform.</p>
    <p class="Standard" dir="ltr">To actually execute on GPP platforms, new additions or modifications to the OpenCPI core software may be required.  The core software is highly portable and has been supported on a number of platforms and environments.  However, it is common for a new compiler, toolchain, or system libraries to require some adjustments to the OpenCPI core software.  Here are some reasons that require modifications to OpenCPI core software:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">New compilers sometimes have new correct warnings that should be addressed.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">System headers are sometimes more standards conformant, which is good.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Some compilers are “dumber” that others, requiring code be “dumbed down” to avoid language or library features that are not universally supported.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Some compilers are stricter than others, requiring code that was previously accepted to be “tightened up” to be strictly compliant and accepted.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">These reasons may result in modifications to the core OpenCPI software, but they should not and cannot make that software stop working on existing supported platforms.  Any such modifications should be done with care, and whenever possible, the modifications should be retested on existing supported platforms.</p>
    <h2 dir="ltr" id="toc23"><span class="SectionNumber">4.1 </span><a id="RefHeading10271060509377"></a>Enabling Development for New GPP Platforms</h2>
    <p class="Standard" dir="ltr">Whether a GPP platform is the development host itself, or an embedded GPP using cross-development, the tool chain must be established on a development host.  For development hosts, there is typically a default tool chain that is installed globally in the system for any development task on that system.  This is the purpose of the <span class="Code">platforms/<span style="font-style:italic">&lt;platform&gt;</span>-packages.sh</span> script mentioned above.</p>
    <p class="Standard" dir="ltr">When the tool chain desired for OpenCPI execution on the development host is <span style="font-style:italic">not</span> the default tool-chain for the development host, then it is installed separately much like other cross-compiler tool chains for embedded hosts.</p>
    <p class="Standard" dir="ltr">Thus development tools for GPP platforms are established in three ways:</p>
    <ol style="margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left">
      <li>
        <p class="List3" dir="ltr">The development host's globally installed default tools.</p>
      </li>
      <li>
        <p class="List3" dir="ltr">A specific prerequisite installation in OpenCPI's own installation area</p>
      </li>
      <li>
        <p class="List3" dir="ltr">A side effect of another tool installation that it is part of.</p>
      </li>
    </ol>
    <p class="Standard" dir="ltr">The first case is the default for development hosts.  The second is used either:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">on a development host when OpenCPI should not use the default global tool-chain installation, or </p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">for normal cross-tool installation</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">The third is used when such an installation by itself is not desired since the tool-chain is part of a separate package installation.  An example of this third case is the Xilinx FPGA tool set which also includes the compiler tool chain for the ARM CPUs that are inside the Xilinx Zynq SoC (FPGA + dual ARM core).</p>
    <p class="Standard" dir="ltr">OpenCPI has a “prerequisites area” (normally at /<span class="Code">opt/opencpi/prerequisites</span>), where various installations are placed so that they do not interfere with other global software installations.  Both runtime library prerequisites and tool prerequisites are typically installed here.  It is also acceptable to install tools in a global location, but such an installation may not be acceptable for all users.  Hence all the built-in prerequisite installations that are standard for OpenCPI are installed in this sandbox area.</p>
    <p class="Standard" dir="ltr">The primary tasks for enabling GPP cross development are to:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Develop a script for installing the tool-chain package in the prerequisites area (unless the platform is the development host, and the standard tool-chain is used).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Develop an environment setup script for OpenCPI cross development of the OpenCPI core software</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Develop a cross-development script for component development in the tools/include/rcc directory.</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc24"><span class="SectionNumber">4.1.1 </span><a id="RefHeading176502116501284"></a>Developing a Tool-chain Installation Script</h3>
    <p class="Body" dir="ltr">If the tool chain is truly specific to the platform, this script should live in the <span class="Code">platforms</span> directory in the file:</p>
    <p class="Code" dir="ltr">platforms/&lt;platform&gt;/install-&lt;tool&gt;.sh</p>
    <p class="Body" dir="ltr">Otherwise it should be in:</p>
    <p class="Code" dir="ltr">scripts/install-&lt;tool&gt;.sh</p>
    <p class="Body" dir="ltr">This script should follow the pattern of other install scripts in the scripts directory, in particular:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Placing the package in the prerequisites area.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Downloading from a known internet location if at all possible.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">If not possible, then telling the user to get the installation file somehow and where to put it (see the <span class="Code">scripts/install-opensplice.sh</span> for an example of this).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Making the script clean up a previous installation when performing a new one.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">This script should source the installation setup script called <span class="Code">scripts/setup-install.sh</span>, which should be <span style="font-style:italic">sourced</span><span style="font-style:normal"> early in the script.</span></p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">This script should be expected to be called from the root of the OpenCPI tree.</p>
      </li>
    </ul>
    <p class="Textbody" dir="ltr">A simple example of these scripts is in:</p>
    <p class="Code" dir="ltr">scripts/install-gtest.sh</p>
    <p class="Body" dir="ltr">This script can then be called manually or become part of a platform installation script.</p>
    <h3 dir="ltr" id="toc25"><span class="SectionNumber">4.1.2 </span><a id="RefHeadingToc783671944612760"></a>The File to Define the Full Target Specification for the Platform.</h3>
    <p class="Standard" dir="ltr">A target specification file should be placed in the platform's directory with the name <span class="Code">target</span>.  This file is a single line with the target specification consisting of three fields separated by hyphens.  It is used during all compilations in OpenCPI to identify the platform.  The CentOS6 target (in the file: <span class="Code">platforms/centos6/target</span>), is:</p>
    <p class="Code" dir="ltr">linux-c6-x86_64</p>
    <p class="Standard" dir="ltr">The first field is the operating system name (another example is <span class="Code">macos</span>).  The second field is the “OS version”, and the third is the “machine” or “processor” or “architecture” being compiled for, commonly returned from the linux utility <span class="Code">uname -m</span>.</p>
    <p class="Standard" dir="ltr">The OS version field is normally a single letter assigned to the OS distribution (<span class="Code">c</span> for CentOS, <span class="Code">u</span> for Ubuntu, <span class="Code">r</span> for RedHat etc.), followed by a major version number.</p>
    <p class="Body" dir="ltr"><a id="RefHeading176522116501284"></a>The third field is the machine architecture that should be shared across operating systems.  E.g. <span class="Code">x86_64</span> is for the 64 bit version of the Intel x86 architecture, and is used for all Linux and MacOS targets for that architecture.</p>
    <h3 dir="ltr" id="toc26"><span class="SectionNumber">4.1.3 </span><a id="RefHeadingToc783691944612760"></a>Developing the Environment Setup Script</h3>
    <p class="Standard" dir="ltr">For each GPP platform, there must be a script that sets up the environment to build for that target platform.  Any time development is done in the OpenCPI tree, such a script must be sourced before any building takes place.  It is common to run such a script in any new command window for the target platform.</p>
    <p class="Standard" dir="ltr">The script to enable development for a given GPP platform should be in the file:</p>
    <p class="Code" dir="ltr">platforms/&lt;platform&gt;/&lt;platform&gt;-env.sh</p>
    <p class="Body" dir="ltr">This script should set up the environment variables that specify the tool-chain necessary to build for it.  Some typical environment variables that must be setup in this script include:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">OCPI_DYNAMIC:  whether libraries should default to static (0) or dynamic(1)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">OCPI_TARGET_OS:  the OS:  first part of the “target triple”</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">OCPI_TARGET_OS_VERSION:  the OS Version:  second part of “target triple”</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">OCPI_TARGET_ARCH:  the third/last part of the “target triple”</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">OCPI_TARGET_HOST:  the “target triple”</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">OCPI_CFLAGS, OCPI_CXXFLAGS, OCPI_LDFLAGS:  typical usage</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc27"><span class="SectionNumber">4.1.4 </span><a id="RefHeadingToc783711944612760"></a>Files to Provide Settings for Environment Variables for Framework Development</h3>
    <p class="Standard" dir="ltr">The file <span class="Code">&lt;platform&gt;-env.sh</span> must be created and should define default values for environment variables needed during framework development.  The variables specified in this file may be overridden by users when they customize their own environments.  This file is used in environment setup scripts to establish defaults based on the platform.</p>
    <p class="Standard" dir="ltr">These settings are not those explicitly <span style="font-style:italic">required</span> for the platform, but just defaults.  If they are hard requirements, they should be in the <span class="Code"><span style="font-style:italic">&lt;platform&gt;</span>-target.sh</span> and <span class="Code"><span style="font-style:italic">&lt;platform&gt;</span>-target.mk</span> files.  They only should apply to building the OpenCPI framework, and not for component development.</p>
    <p class="Standard" dir="ltr">The most common variable setting in these files is for compiler warning options, e.g.:</p>
    <p class="Code" dir="ltr">export OCPI_CXXFLAGS+=-Wno-sign-conversion</p>
    <p class="Body" dir="ltr">or</p>
    <p class="Code" dir="ltr">export OCPI_CXXFLAGS+=-std=c++0x</p>
    <p class="Standard" dir="ltr">The two files, <span class="Code">&lt;platform&gt;-target.sh</span> and <span class="Code">&lt;platform&gt;-target.mk</span> serve the same purpose for different environments.  The first sets variables used in shell scripts and the second sets variables for make files.  The variable settings should be the same in each.  The settings only apply to building the OpenCPI framework and not to component development.</p>
    <p class="Standard" dir="ltr">For all three of these files, the range of settings is best understood by examining all the existing platforms.</p>
    <h3 dir="ltr" id="toc28"><span class="SectionNumber">4.1.5 </span><a id="RefHeadingToc783731944612760"></a>The Script to Recognize the Currently Running Platform</h3>
    <p class="Standard" dir="ltr">The final step is to modify the file <span class="Code">platforms/getPlatform.sh</span> to recognize when it is running on this new platform and return the new target consistent with the others, with five values: OS, OSVersion, Machine, Target, Platform.</p>
    <p class="Standard" dir="ltr">On a CentOS6 platform, this happens:</p>
    <p class="Code" dir="ltr">% platforms/getPlatform.sh<br />linux c6 x86_64 linux-c6-x86_64 centos6</p>
    <p class="Standard" dir="ltr">On a MacOS platform this happens:</p>
    <p class="Code" dir="ltr">% platforms/getPlatform.sh<br />macos 10_11 x86_64 macos-10_11-x86_64 macos10_11</p>
    <h3 dir="ltr" id="toc29"><span class="SectionNumber">4.1.6 </span><a id="RefHeading176542116501284"></a>Developing a Cross-development Component Build Script</h3>
    <p class="Standard" dir="ltr">While the above environment setup script is used when building the core code of OpenCPI (libraries and executables), a different script is used when building software components.  This allows for building components for multiple targets in a single pass.</p>
    <p class="Standard" dir="ltr">This script is in the file:</p>
    <p class="Code" dir="ltr">tools/cdk/include/rcc/&lt;dev-host&gt;=&lt;target-host&gt;.mk</p>
    <p class="Standard" dir="ltr">Thus the script is specifically describing the tools used when building on a particular development host targeting a particular target GPP host.  An example is the file:</p>
    <p class="Code" dir="ltr">tools/cdk/include/rcc/linux-c6-x86_64=linux-zynq-arm.mk</p>
    <p class="Standard" dir="ltr">which contains the script to compile for the zynq version of linux with an ARM processor, when the development host is CentOS6 linux on an X86_64 (64-bit x86) processor.</p>
    <p class="Standard" dir="ltr">Thus the required “target” file in a platform's directory contains the target triple used here.  E.g. since <span class="Code">platforms/zed/target</span> file contains “l<span class="Code">inux-zynq-arm</span>”, cross-building for the <span class="Code">zed</span> platform on a CentOS6 development host looks for the file named “<span class="Code">linux-c6-x86_64=linux-zynq-arm.mk</span>”</p>
    <p class="Standard" dir="ltr">These scripts are responsible for setting the following environment variables whose names include the target name (in this case <span class="Code">linux-zynq-arm</span>):</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Gc_linux-zynq-arm</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Gc_LINK_linux-zynq-arm</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Gc++_linux-zynq-arm</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Gc++_LINK_linux-zynq-arm</p>
      </li>
    </ul>
    <p class="Textbody" dir="ltr">These variables are the compile and link commands for C and C++ components respectively.</p>
    <h3 dir="ltr" id="toc30"><span class="SectionNumber">4.1.7 </span><a id="RefHeading176562116501284"></a>Summary for Enabling Development for a New GPP Platform</h3>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">An installation script to install the tool-chain on the development host</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Environment scripts (3) to set environment variables for the OpenCPI core.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">An environment script to set up environment variables for building C/C++ components.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Test the installation and build of standard OpenCPI prerequisite software packages.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Build the OpenCPI core and make adjustments to the code for issues that arise.</p>
      </li>
    </ul>
    <h2 dir="ltr" id="toc31"><span class="SectionNumber">4.2 </span><a id="RefHeading10291060509377"></a>Enabling Execution for GPP Platforms</h2>
    <p class="Standard" dir="ltr">Execution on GPP platforms requires some command line tools, libraries, and device drivers.  The core OpenCPI libraries and command-line tools are built using the appropriate compiler as installed above.  Once the development host has been enabled, and the OpenCPI core and example components have been built, a few additional steps are required to enable <span style="font-style:italic">execution</span> on the platform.</p>
    <p class="Standard" dir="ltr">Several OpenCPI runtime libraries have aspects that use conditional compilation depending on the system or CPU being targeted.  The current OpenCPI core libraries have significant Linux dependencies and in several files there is conditional code between Linux and MacOS (such as low level networking details).  There are a few areas that have conditional code depending on the CPU being used, such as realtime high resolution timing registers in the CPU.  These customizations are not well defined.  For new CPU architectures and new operating systems not based on Linux, the code must be examined for these issues, which will typically cause compilation errors.</p>
    <h1 dir="ltr" id="toc32"><span class="SectionNumber">5 </span><a id="RefHeading10331060509377"></a>Enabling FPGA Platforms</h1>
    <p class="Body" dir="ltr">Whereas GPP platforms have operating systems that OpenCPI uses to interface with the hardware surrounding the processor, FPGA platforms do not.  OpenCPI provides an  infrastructure on FPGAs, which requires some FPGA logic that is specific to the platform, analogous to a “board support package” that adapts an embedded operating system to a given hardware “board” and associated devices.</p>
    <p class="Body" dir="ltr">We define an FPGA <span style="font-style:italic;font-weight:bold">platform</span> as a particular, single FPGA on some hardware (board).  If a board has multiple OpenCPI-usable FPGAs, each is a platform and each may host a container in which components (actually: <span style="font-style:italic">worker instances</span>) execute.</p>
    <p class="Body" dir="ltr">An FPGA simulator may also be an FPGA platform, which is also a place where OpenCPI HDL components may execute, with all the same infrastructure as physical FPGA platforms.  </p>
    <p class="Body" dir="ltr">Analogous to preparing the support for a GPP platform, enabling an FPGA platform involves steps to enable the development environment, and steps to enable the runtime/execution environment.</p>
    <p class="Body" dir="ltr">Enabling development for a platform involves:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Installing and integrating a development tool-chain that can target the FPGA device on the platform.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Verifying that the integrated tool chain can process and build all the core OpenCPI FPGA code and portable components when targeting the FPGA platform's part and part family.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">Enabling runtime execution for a platform involves:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Writing specific new VHDL code that supports the particulars of the hardware attached to the FPGA on the platform (except for simulators)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Verifying that the various portable FPGA test applications execute on the platform.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">In the sections below, these two aspects are described in detail.</p>
    <h2 dir="ltr" id="toc33"><span class="SectionNumber">5.1 </span><a id="RefHeadingToc174681235158909"></a>Physical FPGA Platforms</h2>
    <p class="Body" dir="ltr">Physical FPGA platforms are based on a particular type of FPGA chip: e.g., a Xilinx ML605 development board has a Virtex6 FPGA (xc6vlx240t), with a speed grade and a package.  Platforms are specific FPGAs connected locally to devices such as:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Local I/O devices: ADC, DAC, DRAM, Flash, GbE, etc. </p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Interconnects: PCIe, Ethernet, etc. to talk to other OpenCPI platforms </p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Slots: FMC, HSMC, mezzanine card slots. </p>
      </li>
    </ul>
    <p class="Body" dir="ltr">For example, a Xilinx ML605 has PCI Express interconnect, DRAM, and 2 FMC slots (and other minor devices).</p>
    <p class="Body" dir="ltr">For each attached device on a platform, specific development may be required (described in the Device Development section below).  However, in many cases existing device support from other platforms may be reused, since OpenCPI FPGA device support is typically done in a way that is sharable across platforms.</p>
    <p class="Body" dir="ltr">Examples of physical FPGA platforms are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Xilinx ML605 development board with a Virtex6 FPGA-attached</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">ZedBoard platform with a Zynq SoC (with internal ARM and FPGA).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Altera Stratix4 development board.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Xilinx ZC702 development board with Zynq SoC</p>
      </li>
    </ul>
    <h2 dir="ltr" id="toc34"><span class="SectionNumber">5.2 </span><a id="RefHeadingToc174701235158909"></a>Simulator FPGA Platforms</h2>
    <p class="Body" dir="ltr">OpenCPI provides a software server infrastructure to make execution on simulators as similar as possible to execution on physical FPGAs, without simulating any external device-related logic.  The simulation server environment makes execution on different simulators also similar to each other.  Multiple simulator instances may execute simultaneously (subject to any license restrictions).</p>
    <p class="Body" dir="ltr">At the time of this writing, only mixed-language simulators (VHDL and Verilog) may be enabled and used with OpenCPI.</p>
    <p class="Body" dir="ltr">Examples of supported FPGA simulators include:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Xilinx Isim</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Mentor Modelsim</p>
      </li>
    </ul>
    <p class="Textbody" dir="ltr">Other simulators that may be supported include:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Aldec</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Xilinx Vivado xsim</p>
      </li>
    </ul>
    <h2 dir="ltr" id="toc35"><span class="SectionNumber">5.3 </span><a id="RefHeading10351060509377"></a>Enabling Development for FPGA Platforms</h2>
    <h3 dir="ltr" id="toc36"><span class="SectionNumber">5.3.1 </span><a id="RefHeading176582116501284"></a>Installing the Tool Chain</h3>
    <p class="Body" dir="ltr">Document the basic process of obtaining and installing the tools, highlighting any options or configurations that must be specialized, customized, or simply required for using OpenCPI.  Licensing is also an issue for many FPGA tools.</p>
    <p class="Body" dir="ltr">Note that OpenCPI executes FPGA tools in “wrapper scripts” that perform any necessary initialization or setup, including license setup.  Thus, for OpenCPI, there is no need for login-time startup scripts.  In fact, such scripts can actually cause problems in many cases since OpenCPI frequently invokes multiple alternative tool sets under a single build command.  Polluting your environment with settings from multiple tools and vendors is frequently a source of problems.</p>
    <p class="Body" dir="ltr">For OpenCPI development it is recommended to remove any such “automatic setup at login” items that the tools installation process inserts into your login script(s), and put them in an a separate script that is used as needed.</p>
    <h3 dir="ltr" id="toc37"><span class="SectionNumber">5.3.2 </span><a id="RefHeading176602116501284"></a>Integrating the Tool Chain into the OpenCPI HDL Build Process.</h3>
    <p class="Body" dir="ltr">[[This is a large topic that is currently not fully documented].</p>
    <p class="Body" dir="ltr">This process includes enabling the OpenCPI FPGA build process to use the right tools to target the “part family” of the FPGA device on the platform.  For example, on the “Zed” platform, the family of the FPGA part is “zynq”.  On the “ML605” platform, the family of the FPGA part is “virtex6”.  The required tools for a platform's FPGA may already be installed and integrated, and may already support the particular part family of the platform's FPGA.  If not, that support must be added to the integration of those tools.</p>
    <p class="Body" dir="ltr">So the integration process is:</p>
    <ol class="listlevel1Numbering1">
      <li>
        <p class="ListNumber" dir="ltr">If the required tools are not available integrated with OpenCPI, they must be integrated (not a small job).</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">If the required tools are available integrated with OpenCPI, but do not yet support the part family, that support must be added.</p>
      </li>
    </ol>
    <p class="Body" dir="ltr">The database of part families, and their relationships to tools and platforms, is in the file:</p>
    <p class="Code" dir="ltr">tools/cdk/include/hdl/hdl-targets.mk</p>
    <p class="Body" dir="ltr">The scripts that wrap and execute FPGA tools are found in the directory:</p>
    <p class="Code" dir="ltr">tools/cdk/include/hdl</p>
    <h3 dir="ltr" id="toc38"><span class="SectionNumber">5.3.3 </span><a id="RefHeading176622116501284"></a>Building All the Existing Portable HDL Code</h3>
    <p class="Body" dir="ltr">Nearly all HDL code (mostly VHDL) in OpenCPI is portable and can be built (compiled and synthesized) for all part families and vendors and simulators.  This portable HDL code can be built using the “make hdlportable” command in the top level directory of OpenCPI, supplying the targets (part families) required.</p>
    <p class="Body" dir="ltr">Here is a command that builds all the portable code in OpenCPI for currently supported part families (known as “<span class="Code">HdlTargets</span>” in the OpenCPI FPGA build process):</p>
    <p class="Code" dir="ltr">make hdlportable \<br />  HdlTargets='isim modelsim virtex6 virtex5 \<br />              stratix4 stratix5 zynq spartan3adsp'</p>
    <p class="Body" dir="ltr">Some of the code built using the above command is explicitly labeled to <span style="font-style:italic;font-weight:bold">only build</span> for certain targets or to <span style="font-style:italic;font-weight:bold">not build</span> for some targets, but most is truly portable and will build for all targets.  Once this build command succeeds for the target (part family) for the platform, you can proceed with the steps below to write the HDL code necessary to enable execution on the platform.</p>
    <h3 dir="ltr" id="toc39"><span class="SectionNumber">5.3.4 </span><a id="RefHeadingToc221461235158909"></a>Scripts for HDL Platforms</h3>
    <p class="Body" dir="ltr">For physical platforms (not simulation), there are two scripts that must be also placed in the platform's directory:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">A JTAG support script to enable JTAG-based bitstream loading, whose name is:<br /><span class="Code">jtagSupport_<span style="font-style:italic">&lt;platform&gt;</span></span></p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">A boot-flash loading script to enable scripted loading ot bitstreams to the boot flash, whose name is:<br /><span class="Code">loadFlash_<span style="font-style:italic">&lt;platform&gt;</span></span></p>
      </li>
    </ul>
    <p class="Body" dir="ltr">In some cases the appropriate script might be already be written for a different platform, in which case one platform's script can be a symbolic link to the other.  In other cases there might be a vendor script (e.g. for all Xilinx or all Altera) which may live in the <span class="Code">hdl/vendors/<span style="font-style:italic">&lt;vendor&gt;</span></span> directory.</p>
    <p class="Body" dir="ltr">For simulation platforms there must be a script to invoke the simulator underneath the OpenCPI simulator server as invoked by the “<span class="Code">ocpihdl simulate</span>” command.  This script must be called:  <span class="Code">runSimExec.<span style="font-style:italic">&lt;platform&gt;</span></span></p>
    <h2 dir="ltr" id="toc40"><span class="SectionNumber">5.4 </span><a id="RefHeading10371060509377"></a>Enabling Execution for FPGA platforms</h2>
    <p class="Standard" dir="ltr">This section assumes the reader is familiar with component and application development with OpenCPI, including developing HDL application workers and assemblies.</p>
    <p class="Standard" dir="ltr">An OpenCPI HDL hardware platform is an FPGA with associated devices and slots attached to its pins.  The first step to supporting the platform is to determine whether the types of devices and slots attached to the FPGA are already supported by OpenCPI.</p>
    <p class="Standard" dir="ltr">If a platform has slot types that are not yet supported, that support must be added.  Slot types are defined by specific physical connectors, electrical signaling and direction, and pin and signal name assignments.  Common slot types are FMC (FPGA Mezzanine Cards) as defined in the VITA 57 standard, and HSMC (High Speed Mezzanine Card) as defined by Altera.  This slot-type support process is described in the “Defining New HDL Platform Slot Types” section below.  It generally does not involve writing HDL code,  just writing descriptive metadata in XML.</p>
    <p class="Standard" dir="ltr">Similarly, if the devices attached to the FPGA are not yet supported in OpenCPI, that support must also be added.  Device support in OpenCPI is generally portable (i.e. the device support code can be used to support the same device on different platforms), although there are certainly exceptions to this.  The device support process is described in the “Device Support for FPGA Platforms” section below.</p>
    <p class="Standard" dir="ltr">The term “card” is used in OpenCPI to mean a card with additional devices that may be plugged into a slot on the platform.  Thus devices may be directly attached to the pins of the platform FPGA, or they may exist on a plug-in card that, when plugged into a slot, become attached to the platform FPGA.  In this latter case such devices are not considered part of the platform, but part of the card, which might be plugged into a certain type of slot on any platform.</p>
    <p class="Standard" dir="ltr">HDL Platform support starts with deciding on a name for the platform (usually a lower-cased version of the name used by the vendor of the platform), and creating a directory with that name wherever the platform support code and metadata should live.  In that directory in all cases there should be a “Makefile” containing the following line, usually the last line in the file:</p>
    <p class="Code" dir="ltr">include $(OCPI_CDK_DIR)/include/hdl/platform.mk</p>
    <p class="Standard" dir="ltr">Directories for platforms supported in the OpenCPI core repository are in the <span class="Code">hdl/platforms</span> directory, but the directory for any other platform can be anywhere else.  If several platforms are being supported together, it is convenient, but not required, to place all their directories in a single <span class="Code">platforms</span> directory since that name is specially supported in the <span class="Code">OCPI_HDL_PLATFORM_PATH</span> environment variable.  Use of this environment variable is explained in the HDL section of the OpenCPI Component Development Guide.</p>
    <p class="Standard" dir="ltr">Then the “platform worker” (source code and OWD/XML) and other platform-specific files are placed in this directory.  In summary, the steps to enabling an HDL platform for execution are, (assuming the development tools are enabled):</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Determine and identify slot types and devices for the platform.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Define any new slot types and add them to OpenCPI.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Define and establish “skeletons” for all new devices on the platform.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Define the platform worker, with associated hardware-related metadata and files.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Implement the platform worker and perform basic tests, with <span style="font-style:italic">no</span> devices enabled.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Implement any new devices for the platform, and test the platform <span style="font-style:italic">with</span> devices (both pre-existing and new).</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc41"><span class="SectionNumber">5.4.1 </span><a id="RefHeading176642116501284"></a>Creating the XML Metadata Definition of the Platform</h3>
    <p class="Standard" dir="ltr">The XML file that defines an HDL platform is named the same as the platform name  with an “<span class="Code">.xml</span>” suffix.  It describes both the hardware aspects of the platform as well as the OWD for the HDL worker that runs the platform, which is called the “platform worker”.  Thus the platform XML is an OWD for the platform worker, with additional information.  The platform worker is a special type of “device worker” (a worker that touches pins).  Developing device workers in general is the subject of the next major section below, but information specific to platform workers is described here.</p>
    <p class="Standard" dir="ltr">The platform XML is an OWD with these special aspects:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">The top level XML element is “<span class="Code">HdlPlatform”</span></p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The spec being implemented is “<span class="Code">platform-spec.xml</span>”.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The slots present on the platform are indicated by <span class="Code">slot</span> elements</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The devices present on the platform are indicated by <span class="Code">device</span> elements.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The external signals (to pins) required by the platform worker (as for any device worker) are indicated by <span class="Code">signal</span> elements.  Signal elements are described in the device support section below.</p>
      </li>
    </ul>
    <h4 dir="ltr" id="toc42"><span class="SectionNumber">5.4.1.1 </span>Slot Elements in a Platform XML File</h4>
    <p class="Body" dir="ltr">Each slot element of the platform XML file declares the existence of a slot.  The required “<span class="Code">type=</span>” attribute must match the name of a defined slot type.  The slot type definition files are normally in the <span class="Code">hdl/cards/specs</span> directory in the CDK, which is automatically searched whenever a platform XML file is processed.  Examples of slot types are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span class="Code">fmc_lpc</span>:  the “low pin count” variant of the “FPGA Mezzanine Card” from VITA57.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span class="Code">fmc_hpc</span>:  the “high pin count” variant of the FMC cards from VITA57</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span class="Code">hsmc</span>:  the High Speed Mezzanine Card from Altera.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The optional “<span class="Code">name=</span>” attribute of the slot element may assign a name to the slot.  If it is not present, the slot's name becomes the slot type.  If “<span class="Code">name=</span>” is <span style="font-style:italic">unspecified</span> and if more than one slot of the same type is present, a zero-origin ordinal is appended to the slot-type as the name.  E.g. if there were two slots of type “<span class="Code">hsmc</span>” and they were not given names, their names would be “<span class="Code">hsmc0</span>” and “<span class="Code">hsmc1</span>”.  Slot names are needed for two purposes:</p>
    <ol class="listlevel1Numbering1">
      <li>
        <p class="ListNumber" dir="ltr">When a card is plugged into a slot, that slot is identified by its name.  Slot names are case insensitive for this purpose.</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">The default name for signals between the platform FPGA and a slot is the slot name as a prefix, followed by underscore, followed by the signal name as defined in the slot type definition file.</p>
      </li>
    </ol>
    <p class="Body" dir="ltr">These fully prefixed slot signal names do not appear in source code or XML, but they do correspond to the names found in a platform's constraint file, which is normally supplied separately and is not defined nor modified by OpenCPI.</p>
    <p class="Body" dir="ltr">E.g. for a slot signal named “<span class="Code">PRSNT_M2C_L</span>”, the name of the signal from the platform FPGA to the slot, for the second of two <span class="Code">fmc_lpc</span> slots that did not have assigned names, would be “<span class="Code">fmc_lpc1_PRSNT_M2C_L</span>”.  Slot names (and slot type signals) <span style="font-style:italic">are case sensitive</span> for this purpose since there are some tools and systems where the case of such signals matters in the constraints file.</p>
    <p class="Body" dir="ltr">There is one other aspect to slot elements in the platform XML file:  slot signal mapping.  Normally, the slot signal names are based on the specification of the slot types.  E.g., the FMC slot signal names are defined by VITA57.  If a platform's constraints file (and documentation) do not use the standard names from the slot type specification, then extra child elements are added to the slot element, indicating the correspondence between what the standard (e.g. VITA57) says and what this platform's constraints file and documentation use as a signal name for that slot signal.</p>
    <p class="Body" dir="ltr">As an example, the ZedBoard platform has an FMC LPC slot.  It uses the VITA57 signal names for <span style="font-style:italic">almost</span> all these signals.  However, it changes signal names when they are differential and use the “CC” suffix.  Whereas VITA57 always puts the “CC” suffix last, the ZedBoard puts the differential suffix last (i.e. _N and <span style="text-decoration:underline">P).  </span><span style="text-decoration:none">So here is the slot element for the ZedBoard platform XML, that forces the slot name to be upper case </span><span class="Code"><span style="text-decoration:none">FMC</span></span><span style="text-decoration:none">, and remaps the offending signals so OpenCPI knows how to route signals through the slot's connector to cards that </span><span style="font-style:italic;text-decoration:none">do not</span><span style="text-decoration:none"> follow the VITA57 conventions:</span></p>
    <p class="Code" dir="ltr" style="font-size:14.666667px;text-decoration:none">&lt;slot name='FMC' type='fmc_lpc'&gt;<br />  &lt;!-- These signals don't use VITA57 signal names--&gt;→<br />  &lt;signal slot='LA00_P_CC' platform='LA00_CC_P'/&gt;<br />  &lt;signal slot='LA00_N_CC' platform='LA00_CC_N'/&gt;<br />  &lt;signal slot='LA01_P_CC' platform='LA01_CC_P'/&gt;<br />  &lt;signal slot='LA01_N_CC' platform='LA01_CC_N'/&gt;<br />  &lt;signal slot='LA17_P_CC' platform='LA17_CC_P'/&gt;<br />  &lt;signal slot='LA17_N_CC' platform='LA17_CC_N'/&gt;<br />  &lt;signal slot='LA18_P_CC' platform='LA18_CC_P'/&gt;<br />  &lt;signal slot='LA18_N_CC' platform='LA18_CC_N'/&gt;<br />  &lt;signal slot='CLK0_M2C_N' platform='CLK0_N'/&gt;<br />  &lt;signal slot='CLK0_M2C_P' platform='CLK0_P'/&gt;<br />  &lt;signal slot='CLK1_M2C_N' platform='CLK1_N'/&gt;<br />  &lt;signal slot='CLK1_M2C_P' platform='CLK1_P'/&gt;<br />  &lt;signal slot='DP0_C2M_P' platform=''/&gt;<br />  &lt;signal slot='DP0_C2M_N' platform=''/&gt;<br />&lt;/slot&gt;</p>
    <p class="Body" dir="ltr"><span style="text-decoration:none">Finally, some platforms do not connect all possible slot signals to the FPGA.  In this case the slot element maps them to an empty signal name on the platform, indicating that these slot signals cannot be used on this platform.  In the above example, the last two slot signals mentioned (</span><span class="Code"><span style="text-decoration:none">DP0_C2M_P/N</span></span><span style="text-decoration:none">) are not connected to the (Zynq) FPGA  on the ZedBoard platform.</span></p>
    <p class="Body" dir="ltr"><span style="text-decoration:none">Card-based devices are not considered part of the platform, and thus constraints for card-based devices are handled differently and are not in the platform's constraints file.</span></p>
    <h4 dir="ltr" id="toc43"><span class="SectionNumber">5.4.1.2 </span>Device Elements in a Platform XML File</h4>
    <p class="Body" dir="ltr">Device elements indicate devices that are part of the platform and are directly attached to the platform FPGA's pins.  Device elements indicate these things:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic">Required: </span>the HDL device worker supporting this device (like a device driver).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The (optional) name of the device, if not based on the device worker's name.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Which parameter settings should be used for the device worker for this device.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Any mapping between the device worker's external signals and the names that the platform uses for those same device signals (e.g. in its constraints file).</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">In most cases a device element simply indicates that a device exists and which device worker should be used to support it.  E.g.: if a platform had a flash device that was supported by the device worker named “flash.hdl”, this might be the device element:</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">&lt;device worker='flash'/&gt;</p>
    <p class="Body" dir="ltr">Similar to slot names, if there is no “<span class="Code">name=</span>” attribute provided for a device element, the worker name is used, and if there are multiple devices using the same worker, a zero-based ordinal is appended.</p>
    <p class="Body" dir="ltr">Like normal application workers, device workers can have parameter or initial property settings.  To make device workers reusable on multiple platforms, different values may be needed for different platforms.  E.g., if a device worker has several clocking modes depending on how its hardware is configured, these property values can indicate to the device worker how it should operate on this particular platform.  Such property values are supplied using property elements (with “name=” and “value=” attributes), much like the property values for application components in an OpenCPI application.</p>
    <p class="Body" dir="ltr">In the following example, the device element says there is a “<span class="Code">lime_adc</span>” device present, and on this platform, its “<span class="Code">use_ctl_clk</span>” property should be set to <span class="Code">false</span>.:</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">&lt;device worker='lime_adc'&gt;<br />  &lt;property name='use_ctl_clk' value='false'/&gt;<br />&lt;/device&gt;</p>
    <p class="Body" dir="ltr">Like slots, devices can have signal elements to indicate that the standard signal naming should be overridden to match up with the constraints file of the platform (so that the constraints file can remain untouched).  These “<span class="Code">signal</span>” elements use the “<span class="Code">name=</span>” attribute to indicate the signal name as declared by the device worker, and the “<span class="Code">platform=</span>” attribute to indicate the name used for the platform.  If not mapped, the platform signal for this device's signal is the device's name, followed by underscore, followed by the device worker's declared external signal name.</p>
    <p class="Body" dir="ltr">Also like slots, if the “<span class="Code">platform=</span>” attribute is the empty string, it indicates that this device signal is not connected to the device on this platform.  The following example indicates the presence of a “<span class="Code">lime_dac</span>” device, but that on this platform the “<span class="Code">tx_clk</span>” signal is not connected:</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">&lt;device worker='lime_dac'&gt;<br />  &lt;signal name='tx_clk' platform=''/&gt;<br />&lt;/device&gt;</p>
    <h3 dir="ltr" id="toc44"><span class="SectionNumber">5.4.2 </span><a id="RefHeading176662116501284"></a>Creating the Platform Worker</h3>
    <p class="Standard" dir="ltr">While a platform worker's XML (OWD) has extra elements to describe the platform's hardware (devices and slots), it is still an OWD, and thus it describes any implementation-specific properties and ports of the platform worker.  Being a device worker, it can also define external signals that are connected externally to pins.</p>
    <p class="Standard" dir="ltr">Thus to complete the OWD, any such ports and properties must be defined.  The spec (OCS) for all platform workers defines certain ports and properties that all platform workers must support and implement, but platform workers can and typically do have other ports and properties that are platform-specific.</p>
    <p class="Standard" dir="ltr">We first describe the required properties and ports required by the OCS for all platform workers, followed by a number of optional worker port types that are in fact unique to platform workers that no other type of worker can use.</p>
    <h4 dir="ltr" id="toc45"><span class="SectionNumber">5.4.2.1 </span>Properties Required for all Platform Workers.</h4>
    <p class="Standard" dir="ltr">The spec (OCS) for platform workers contains properties that should be supported by all platform workers.  These are listed in <span class="Code">hdl/platforms/specs/platform_spec</span>.xml.</p>
    <p class="Standard" dir="ltr">Supporting the properties falls into these categories:</p>
    <ol class="listlevel1Numbering1">
      <li>
        <p class="ListNumber" dir="ltr">Readable constants that may be specified as parameters in the OWD itself.</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Readable constants whose values may be specified in the worker code.</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Properties directly supported by instantiating existing modules in the worker.</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Properties directly supported by special ports required of the worker</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Properties that require specific code support in the platform worker.</p>
      </li>
    </ol>
    <p class="Body" dir="ltr">Nearly all of them are supported by existing primitive modules that all platform workers must instantiate, and some are simply read-only values that the platform worker code (or OWD) can specify values for.</p>
    <p class="Body" dir="ltr">It is best to look at some of the existing platform workers to see how these properties are supported (e.g. <span class="Code">zed</span>, <span class="Code">ml605</span> or <span class="Code">alst4</span>).</p>
    <p class="Body" dir="ltr">Here is a table with the properties and their category listed.</p>
    <p class="TableCaptionbefore" dir="ltr">Table 2:  Platform Worker Required Properties</p>
    <table cellspacing="0" dir="ltr" id="Table6table" style="margin-top:0;margin-bottom:0;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Name</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Type</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Access</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Cate-gory</p>
          </td>
          <td style="border:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Description</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">UUID</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">ULong*16</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">4</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Unique ID of bitstream file</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">timeNow</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">ULongLong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Current time-of-day (32.32 GPS time)</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">romAddr</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ushort</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Writable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Address for reading bitstream metadata</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">romData</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">ULong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Data when reading bitstream metadata</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">nMemories</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ulong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">1 or 2</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">How many memories the platform has</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">memories</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ulong*4</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">2</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Information about individual memories</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">nLEDs</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ulong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">1 or 2</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">How many LED indicators are present</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">LEDs</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">ULong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">Readable+Writable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">5</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Actual LED settings, up to 32, LSB is LED 0</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">timeStatus</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ulong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">volatile</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Status of the the time service</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">timeControl</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ulong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">writable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Control register for the time serv.ce</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">timeDelta</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">ULongLong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">writable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Perform hardware subtraction via timeNow</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:106.0016px">
            <p class="TableContents" dir="ltr">ticksPerSecond</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:75.464005px">
            <p class="TableContents" dir="ltr">Ulong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:63.1952px">
            <p class="TableContents" dir="ltr">volatile</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:45.8px">
            <p class="TableContents" dir="ltr">3</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:290.8672px">
            <p class="TableContents" dir="ltr">Timekeeping clock rate</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h4 dir="ltr" id="toc46"><span class="SectionNumber">5.4.2.2 </span>Ports of Platform Workers</h4>
    <p class="Standard" dir="ltr">Platform workers have ports that are different than ports of application workers.  They are not used for moving data to and from other workers.  They allow the platform worker to provide required services to the rest of the HDL infrastructure.  The platform worker has three port types:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Control plane access ports, providing off-chip access to the on-chip control plane.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Metadata access ports to provide access to built-in bitstream metadata via properties</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Timebase ports to provide the basis for timekeeping on the platform.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Interconnect ports to allow external interconnect hardware interfaces to support data flow (e.g. PCIe, AXI etc.).</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">To support the (single) control plane access port (called a “<span class="Code">cpmaster</span>” port), the platform worker must provide an addressable path from the controlling processors's software into the FPGA.  This usually involves adapting a window on an addressable bus that the FPGA is connected to, to the protocol and signals of the <span class="Code">cpmaster</span> port.  The adaptation is normally put into its own module and then instanced in the platform worker.  The platform worker must choose an appropriate clock and (asserted high) reset signal to serve as the platform't control clock/reset.</p>
    <p class="Body" dir="ltr">An example from the ZedBoard platform is where an addressable bus port in the Zynq chip, which connects the processor to the FPGA, is called the M_AXI_GP0.  The Zynq CPU is the master, and generates read and write accesses to the FPGA acting as a slave.  In this case an adapter module was written (called <span class="Code">axi2cp</span>) to convert the protocol used by the M_AXI_GP0 port in the hardware, to the OpenCPI control plane protocol.  This module is instanced in the Zed platform worker and connected to the CPU on one side, and the platform worker's <span class="Code">cpmaster</span> port on the other.  In the Zed platform worker this adapter and its connection is shown by this code:</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">-- Adapt the axi master from the PS to be a CP Master<br />cp : axi2cp<br />  port map(<br />    clk     =&gt; clk,<br />    reset   =&gt; reset,<br />    axi_in  =&gt; ps_axi_gp_out,<br />    axi_out =&gt; ps_axi_gp_in,<br />    cp_in   =&gt; cp_in,<br />    cp_out  =&gt; cp_out<br />    );</p>
    <p class="Body" dir="ltr">The <span class="Code">metadata</span> port is supported by connecting properties to elements of the port record, by inserting these lines into the platform worker:</p>
    <p class="Code" dir="ltr">props_out.UUID       &lt;= metadata_in.UUID;<br />props_out.romData    &lt;= metadata_in.romData;<br />metadata_out.clk     &lt;= clk;<br />metadata_out.romAddr &lt;= props_in.romAddr;<br />metadata_out.romEn   &lt;= props_in.romData_read;</p>
    <p class="Standard" dir="ltr">The “clk” signal is the platform's control clock (see above).</p>
    <p class="Standard" dir="ltr">The timebase port is to provide signals that are the basis for timekeeping on the platform.  They are a clock, a PPS input signal and an optionally connected PPS output signal.  The platform worker should use a clock that is best suited for timekeeping, which usually means the one with the least jitter and drift over the short term.  On some platforms this is simply the same as the control clock, but on others there may be a clock with better performance for this purpose and the platform worker should use it.</p>
    <p class="Standard" dir="ltr">The fourth type of port on the platform worker is the one that enables off-chip data streaming (messaging) to and from other FPGA or software workers.  It is called the “<span class="Code">unoc</span>” port (for “micro-network-on-chip”).  [Note this port is becoming obsolete and replaced by the scalable data plane, and thus will not be documented here].  On some platforms (e.g. PCIe-based), both the control plane and data plane use the same off-chip interconnect, and the platform worker simply provides separate access paths to that interconnect for control and data purposes.  The control plane acts as bus slave, whereas the data plane may act as both master and slave.</p>
    <h4 dir="ltr" id="toc47"><span class="SectionNumber">5.4.2.3 </span>Platform Worker Clocks</h4>
    <p class="Standard" dir="ltr">As seen above in the discussion of the control plane adaptation (the <span class="Code">cpmaster</span> port), the platform worker sources the clock (and reset) used for the OpenCPI control plane on the platform.  It also sources any clocks associated with the “data plane” where data/messages are flowing to other workers in other FPGAs or software platforms.  In both these cases the clock and reset signals are part of the interface at these ports.</p>
    <p class="Standard" dir="ltr">A platform worker usually also sources another clock for timekeeping on the platform (in the <span class="Code">timebase</span> port), unless there will never be any need for timekeeping on the platform </p>
    <p class="Standard" dir="ltr">In general these clocks are ones that already exist on the platform and are simply assigned to these additional purposes.  I.e. the control clock may be the clock already associated with the bus between the CPU and FPGA.  In some cases the platform worker may synthesize/generate new clocks for these purposes.</p>
    <h4 dir="ltr" id="toc48"><span class="SectionNumber">5.4.2.4 </span>Building the Platform Worker Using its Makefile.</h4>
    <p class="Standard" dir="ltr">Like any other worker, a platform worker has a worker Makefile that is used for various purposes.  Since the HdlTarget and HdlPlatform are implicit for a platform worker, there is no need to specify either (in the file or on the command line).</p>
    <p class="Standard" dir="ltr">As with other HDL workers, the makefile may reference other local source files or primitive cores and libraries from elsewhere.  The basic contents for a platform worker's Makefile is simply:</p>
    <p class="Code" dir="ltr">include $(OCPI_CDK_DIR)/include/hdl/hdl-platform.mk</p>
    <p class="Standard" dir="ltr">In addition to building the platform worker, you can also build platform configurations here in the platform worker directory.  In fact, when nothing else is specified, a “base” platform configuration (with no device workers) is built whenever the platform worker is built.  To specify more platform configurations to build, specify them in the “Configurations” make variable in this Makefile, and for each one, write an XML file describing which devices (and any parameters for them) that should be included in the platform configuration.</p>
    <p class="Standard" dir="ltr">Running “make” in a platform worker directory builds the platform worker, the “base” configuration, and any other platform configurations as specified in the “Configurations” make variable.</p>
    <h3 dir="ltr" id="toc49"><span class="SectionNumber">5.4.3 </span><a id="RefHeadingToc221481235158909"></a>Specifying Platform Configurations in XML Files.</h3>
    <p class="Standard" dir="ltr">For each platform configuration mentioned in the Configurations variable in the platform worker makefile, there must be a corresponding XML file.  This XML file has these aspecs:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">The top level element is “<span class="Code">HdlConfig</span>”.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">A “device” child element is present for each device in the configuration.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">For devices previously defined as being part of the platform (and thus mentioned in the platform worker's OWD), the device element simply has a “<span class="Code">name=</span>” attribute indicating which of the platform's devices should be included in the platform configuration.</p>
    <p class="Body" dir="ltr">Platform configurations can also specify devices that are on cards plugged into one of the platform's slots.  Specifying the “<span class="Code">card=</span>” attribute indicates which card the device is on, and implies that the card is plugged into one of the platform's slots.  If there are multiple slots of the type that the indicated card is defined for, then a “<span class="Code">slot=</span>” attribute must be used to unambiguously indicate which slot the card is plugged into.</p>
    <p class="Body" dir="ltr">Thus platform configurations can indicate a mix of devices: those that are part of the platform, and others that should be made available assuming a certain type of card is plugged into one of the platform's slots.  The following example, (for the ZedBoard platform), indicates that a configuration should be built that assumes a “lime-zipper-fmc” card should be plugged into a slot on the platform, and that device workers to support the “lime_adc” device on that card should be included.  There is no “<span class="Code">slot=</span>” attribute included or required since the platform has only one slot.</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">&lt;HdlConfig&gt;<br />  &lt;device name='lime_adc' card='lime-zipper-fmc'/&gt;<br />&lt;/HdlConfig&gt;</p>
    <h3 dir="ltr" id="toc50"><span class="SectionNumber">5.4.4 </span><a id="RefHeading176682116501284"></a>Testing the Basic Platform without Devices</h3>
    <p class="Standard" dir="ltr">You can build and run various tests without supporting any of the devices on the platform.  This can be the first chance to test the full bitstream build flow.</p>
    <p class="Standard" dir="ltr">In particular, to test the control plane support, you can test the platform with no interconnect/dataplane support by using applications like “tb_bias” which do not require interconnect support for the data plane.</p>
    <p class="Standard" dir="ltr">Data plane support can then be tested one direction at a time, using simple applications like “patternbias” or “biascapture” that only flow data in one direction between the FPGA platform and the processor.</p>
    <h2 dir="ltr" id="toc51"><span class="SectionNumber">5.5 </span><a id="RefHeading10391060509377"></a>Device Support for FPGA Platforms</h2>
    <p class="Standard" dir="ltr">Device support development involves the creation of specialized workers that enable OpenCPI to use the devices attached to an HDL platform.  <span style="font-style:italic">Device workers</span> are like "device drivers" for specific FPGA-attached hardware devices — workers that interface with devices using device-specific signals and I/O pins.</p>
    <p class="Standard" dir="ltr">Device workers are like normal application workers with one important difference:  they have signal connections with hardware attached to pins of the FPGA.  The control interface and data interfaces to device workers are the same as an application worker.  For example, a device worker for an output device (like a DAC or a printer) would have some signals attached to FPGA pins that are connected to the output device, and would also have a normal worker input data port that would be connected to some application worker producing the data.</p>
    <p class="Standard" dir="ltr">[Diagram showing app worker → device worker → device.]</p>
    <p class="Standard" dir="ltr">When the device is attached to the FPGA via dedicated pins, the device is considered part of the platform.  When the device is on an optional card plugged into a slot (which has pins connected to the FPGA), the device is considered part of the card, not the platform.  In both cases the same device worker is used to access and control the device.</p>
    <p class="Standard" dir="ltr">A simple DAC device worker might have an XML descriptor (OWD) like this:</p>
    <p class="Code" dir="ltr">&lt;HdlDevice Language='vhdl' spec='dac-spec'&gt;<br />  &lt;port name='in' datawidth='8'/&gt;<br />  &lt;signal output='valid'/&gt;<br />  &lt;signal output='data' width='8'/&gt;<br />  &lt;signal input='ready'/&gt;<br />&lt;/HdlDevice&gt;</p>
    <p class="Standard" dir="ltr">The <span class="Code">HdlDevice</span> element is similar to the <span class="Code">HdlWorker</span> element except that it allows some extra features like the “<span class="Code">signal</span>” child elements.</p>
    <p class="Standard" dir="ltr">The “<span class="Code">spec='dac-spec'</span>” attribute indicates that this device worker implements the “spec” common to all DAC devices (properties and ports).  It can add its own properties as required.</p>
    <p class="Standard" dir="ltr">The “<span class="Code">port</span>” element simply sets the physical data width of the input port to 8.</p>
    <p class="Standard" dir="ltr">The “<span class="Code">signal</span>” elements specify the names of device signals (HDL language “ports”) connected to the FPGA pins that are connected to a device supported by this device worker.</p>
    <p class="Standard" dir="ltr">All the details of an HdlDevice XML are mentioned below.  An example of the device worker source code for this (simplistic, single clock domain) device worker would be:</p>
    <p class="Code" dir="ltr">in_out.take &lt;= in_in.ready and (ready or not in_in.valid);<br />valid       &lt;= in_in.ready and in_in.valid;<br />data        &lt;= in_in.data;</p>
    <h3 dir="ltr" id="toc52"><span class="SectionNumber">5.5.1 </span><a id="RefHeadingToc4826234407367"></a>Device Component Specs and Device Worker Modularity</h3>
    <p class="Standard" dir="ltr">In order to ensure that similar devices have common application-visible behavior, OpenCPI has <span style="font-style:italic">device class specs</span> (DCS) that represent commonly used classes of devices.  This is a specialization of the component specifications (OCS ) that are the basis of multiple implementations (application workers) of the same functionality.  In this device case, the “multiple implementations” are for different devices of the same class.  Device workers for devices in the same class implement the same DCS; a device class is represented by its DCS.  There is no difference in syntax between an OCS and a DCS.</p>
    <p class="Standard" dir="ltr">As the integration of functionality on single chips increases, it is common for a “chip” to implement multiple functions of different classes of device (e.g. an ADC and a DAC).  Generally, this should <span style="font-style:italic">not</span> result in a single device worker for the multi-function chip.  Creating such a single device worker would result in the functions not being represented to the system or to users the same as a similar function from a non-integrated single-purpose chip.  Thus, a device worker should be developed for each class that is present on the multifunction chip.</p>
    <p class="Standard" dir="ltr">This avoids exposing the multi-function integration of a single chip to applications and thus enhances the re-use of applications.  Furthermore, when only one function is needed, a multi-function device worker would use FPGA resources for functions that are not being used.  It possible to develop “swiss-army-knife” device workers for multifunction chips that intend to avoid using resources for parts that are unused.  However, the recommended practice of OpenCPI is to be more modular, namely:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Chips that contain multiple functions should generally be treated as multiple devices using multiple device workers of the appropriate classes.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">When a multi-function device has pins or hardware that must be shared among the functional device workers (e.g. a common reset or SPI or clocks), a “subdevice” module can be used for such shared logic.  This is discussed in a later section.</p>
    <p class="Standard" dir="ltr">The first step in developing support for a new device is to identify the device class specs that are relevant, and determine the list of device workers that must be created.  Each device class spec defines common properties, data ports, and implied functionality that all device workers of the class should try to implement.</p>
    <p class="Standard" dir="ltr">Some examples of classes of devices currently defined are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">ADC and DACs which convert between isochronous data and flow-controlled data and may have scheduling and timestamping functionality.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Upconverters and downconverters between IF/Baseband and RF.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Clock generators</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">DRAM</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc53"><span class="SectionNumber">5.5.2 </span><a id="RefHeadingToc4828234407367"></a>Device Proxies — Software Workers that Control HDL Device Workers</h3>
    <p class="Standard" dir="ltr">A device proxy is a software worker (RCC/C++) that is specifically paired with a device worker in order to translate a higher level control interface for a class of devices into the lower level actions required on the actual device.  While it is possible that the HDL device worker itself could support the required generic interface, for many device classes, it is more productive to split the supporting code for the device into a (software) proxy and a HDL device worker.  When a device worker has a proxy, it is termed the “slave” of that proxy.  Using a proxy is not always required.</p>
    <p class="Standard" dir="ltr">The requirements for a class of devices may in fact be split into a low level part that HDL device workers typically implement, and a high level part that would usually be implemented in a proxy.  An example might be where an ADC device worker had a low-latency gain adjustment input port that could probably not be implemented in software, as well as a high level sample rate setting that would be better implemented in a proxy.</p>
    <p class="Standard" dir="ltr">Device proxies are simple C++ (<span style="font-style:italic">not C</span>) RCC workers where the XML (OWD) specifies a “slave” attribute, indicating which worker is the “slave” for that proxy.  That attribute enables convenient access to all the slave worker's properties from the proxy's code.</p>
    <p class="Standard" dir="ltr">Thus there are two patterns for implementing HDL device support in OpenCPI:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic">Device-worker-only</span>, where the device worker implements both the device component spec as well as any required higher level properties.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic">Device-worker-and-proxy,</span> where the device worker implements only the device component spec, and the device proxy implements the higher level properties for the class.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">A common example of higher level properties for a device class is the center/tuning frequency of an RF/IF up/down converter.  The high level property is a convenient floating point number, which typically requires setting a variety of device registers to accomplish.  The proxy code would make the necessary translations and computations before setting the correct register values in the HDL device worker.</p>
    <h3 dir="ltr" id="toc54"><span class="SectionNumber">5.5.3 </span><a id="RefHeadingToc4830234407367"></a>A Device Worker Implements the Data Sheet</h3>
    <p class="Standard" dir="ltr">It is recommended to use the data sheet's signal names and register names in the device worker code (and its OWD) so they are easily correlated to the names in the data sheet.  This allows for easier code maintenance and system level debugging.  E.g., a system engineer may find it especially valuable to probe and examine device-level settings when referring to the data sheet, even though they might not be HDL coders.  When the naming conventions in the data sheet are at odds with “better” naming conventions, it may still be preferable to use them for these reasons.</p>
    <p class="IndentHang" dir="ltr">	<span style="font-style:italic">Implementing all the functionality in a device may not be desirable when it is initially written for a given platform, since that platform may not use all the device's capabilities.  When a device worker is insufficient in this way for a new platform or project, it should be enhanced in such a way that any existing uses of it will still work (backward compatibility) so that the community in fact gets the benefit of a newer more complete device worker implementation.</span></p>
    <p class="Standard" dir="ltr">As mentioned above, multi-function chips should generally be supported by multiple device workers.  But <span style="font-style:italic">within</span> any device worker for a function, if there are features or modes that carry significant overhead, they should be controlled by parameter properties (thus generics in VHDL) so that the resources are not wasted when the feature/mode is not being used.  This will promote re-use of the device worker.</p>
    <p class="Standard" dir="ltr">When devices have internal registers, the most common approach is to define each internal register as a property in the OWD (not in the OCS), and use the “raw property” feature of HDL workers to access those registers.</p>
    <h3 dir="ltr" id="toc55"><span class="SectionNumber">5.5.4 </span><a id="RefHeadingToc4832234407367"></a>Subdevice Workers</h3>
    <p class="Standard" dir="ltr">[Diagrams here, based on existing PPTs etc.]</p>
    <p class="Standard" dir="ltr">Writing a device worker to be reusable across many embedded systems is made more difficult by two facts:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Multifunction devices have aspects that are shared between functions (e.g. common reset)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Controlling different devices sometimes involves sharing control/configuration buses (e.g. SPI and I2C) or other hardware.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">In order to preserve the modularity of distinct classes of devices, as well as the reusability of device workers, OpenCPI supports a further specialization of device workers called subdevice workers.</p>
    <p class="Standard" dir="ltr">A subdevice worker implements the required sharing of low level hardware between device workers.  It is defined to <span style="font-style:italic;font-weight:normal">support</span> some number of device workers, and is thus instantiated whenever any of its <span style="font-style:italic">supported</span> device workers are instantiated in a platform configuration or container.  Subdevice workers may simply support the different device workers used on a single multi-function device, or they may support a variety of different device workers that are found on a platform.  Thus they may be very <span style="font-style:italic">platform-specific</span> or <span style="font-style:italic">card-specific</span>.</p>
    <p class="Standard" dir="ltr">New subdevice workers may be required when a device with an existing device worker is used on a new platform or card, since the sharing of hardware (e.g. an I2C bus) may be different.  That may result in the existing device worker being refactored to share functions that it did not share before.</p>
    <p class="Standard" dir="ltr">Subdevice workers typically have no control interface.  Like device workers they have signals that are attached to FPGA pins.  These pins are usually what is “shared” between the device worker that the subdevice supporting it.  It is possible that subdevices have no external signals and only exist to coordinate between several optionally present device workers.</p>
    <p class="Standard" dir="ltr">Subdevice workers also have connections to the device workers they support.  The XML (a minimal OWD) for a subdevice defines:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">The hardware FPGA pins it is attached to (via the “signals” element like all device workers)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The device workers it supports</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">How it is connected to each of the device workers it supports.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">The example below defines a subdevice with no control interface (no properties or control operations), driving two signals that are an I2C interface, and supporting a si5351 clock generator device worker via a “rawprop” worker port (defined below).  It is declaring that if that device is present, it should also be present and be connected to that device worker via the “rawprop” port.  By including this subdevice in a platform (in the platform OWD), it will be associated on this platform with the si5351 device worker.</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">&lt;HdlDevice language="vhdl"&gt;<br />  &lt;componentspec nocontrol='true'&gt;<br />  &lt;rawprop name='rprops'/&gt;<br />  &lt;supports worker='si5351'&gt;<br />    &lt;connect port="rawprops" to="rawprops"/&gt;<br />  &lt;/supports&gt;<br />  &lt;Signal Inout='sda'/&gt;<br />  &lt;Signal Inout='scl'/&gt;<br />&lt;/HdlDevice&gt;</p>
    <p class="Standard" dir="ltr">The most common connection between a device worker and a subdevice that supports it, is the “rawprop” connection that enables a device worker to delegate some or all of its raw property accesses to the subdevice.  The device worker declares a “rawprop” master port for this delegation, and the subdevice declares an array of one or more a “rawprop” slave ports to support device workers this way.  This type of connection is common when there is a shared control path like SPI or I2C to access the registers of several devices' properties.</p>
    <p class="Standard" dir="ltr">A “rawprop” worker port consists of a VHDL record of signals that allow a device worker to easily delegate all of its raw property accesses to the subdevice, using this VHDL:</p>
    <p class="Code" dir="ltr" style="font-size:14.666667px">rawprops_out.present     &lt;= '1';<br />rawprops_out.reset       &lt;= ctl_in.reset;<br />rawprops_out.raw         &lt;= props_in.raw;<br />props_out.raw            &lt;= rawprops_in.raw;</p>
    <p class="Standard" dir="ltr">The “present” signal tells the subdevice that there is a connection to a worker.  The “reset” signal tells the subdevice that this worker is being reset, and the “raw” subrecord is conveying the raw property signals into the device worker down to the subdevice.  Similarly, the raw output signals from the subdevice are conveyed back as the device worker's raw property output signals.  The raw property signals are defined in the component developer's guide.[ref]</p>
    <p class="Standard" dir="ltr">When the “rawprop” connection is not sufficient for all of the shared functionality in the subdevice, another type of connection is used, which is a customized set of signals.  This is called a “devsignals” connection.</p>
    <p class="Standard" dir="ltr">Since platforms and cards declare which devices the have, including subdevices, they can specify which subdevices are present.  This allows different subdevices to be used for different platforms while leaving the device workers untouched and reused.</p>
    <h3 dir="ltr" id="toc56"><span class="SectionNumber">5.5.5 </span><a id="RefHeadingToc4834234407367"></a>Higher-level Endpoint Proxies Suitable for Applications</h3>
    <p class="Standard" dir="ltr">As discussed above, we use <span style="font-style:italic;font-weight:bold">device proxies </span>to normalize the behavior of a class of devices.  The granularity of such classes is sometimes below the level appropriate for applications, but is optimal for sharing, reuse, and rapid enablement of new platforms.</p>
    <p class="Standard" dir="ltr">An example of fine granularity is a clock generator chip.  There are many such chips, and device workers are written for them.  They should all act the same, in terms of how they are set up and programmed, usually using a device proxy.  When users or applications want access to a clock generator device, they should be able to use it the same way as any other clock generator device.</p>
    <p class="Standard" dir="ltr">However, clock generator chips are also frequently used to drive other devices to a specific clock (e.g. sampling) frequency, and there may be some specific relationship on a given platform or card between specific clock generator chips and the devices they provide clocking too.</p>
    <p class="Standard" dir="ltr">So, in addition to device proxies that are defined for the granularity of individual devices,  that have device workers, OpenCPI also defines specifications for some higher level proxies called <span style="font-style:italic;font-weight:bold">Endpoint Proxies,</span> for presenting a collection of devices to applications as something to connect and configure within the application.  The purpose of higher level Endpoint Proxies is to remove all device specifics from applications, rather than simply normalize the behavior of a device to its class.  Applications and users want to see standard, portable interfaces for endpoints (e.g. sources and sinks of radio data).  Endpoint proxies make that possible.</p>
    <p class="Standard" dir="ltr">Endpoint proxies are simply proxies that typically have multiple slaves, which themselves are probably device proxies, or in some cases device workers.</p>
    <p class="Standard" dir="ltr">As with subdevices at the bottom of the OpenCPI “device support” stack, endpoint proxies are at the top of the “device support” stack, appropriate for use by applications. But both may internally be somewhat platform specific.  Both exist to “leave the device workers alone” so that they are reusable across platforms and cards.</p>
    <p class="Standard" dir="ltr">[Insert diagram for “stack”]</p>
    <p class="Standard" dir="ltr">Applications use endpoint proxies by instantiating a component of an endpoint proxy spec.  A good example of a class of endpoint proxies is a “radio front end” (as defined by the RedHawk system or GNU Radio), or a “transceiver subsystem” as defined in the Wireless Innovation Forum, or the “RF Chain” as defined in the JTRS MHAL specification.  Since OpenCPI is not software radio system as such, an endpoint proxy can represent any application-level source or sink of data.</p>
    <h3 dir="ltr" id="toc57"><span class="SectionNumber">5.5.6 </span><a id="RefHeading176702116501284"></a>XML Metadata for Device Workers/Subdevices/DeviceProxies/EndpointProxies</h3>
    <p class="Standard" dir="ltr">The four types of workers that relate to device support in OpenCPI are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Device Workers</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Device Proxies</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Subdevices</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Endpoint Proxies</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">All these are workers and share the XML structure of workers via the OWD for ports and properties.</p>
    <p class="Standard" dir="ltr">Device workers use the normal top-level “<span class="Code">spec=</span>” attribute to identify the class of the device.  Device workers and subdevice workers use the HdlDevice top level XML tag, have “signal” elements for hardware signals, and may have “rawprop” and “devsignal” ports to connect devices to subdevices.  If a device worker uses a subdevice, it may in fact have no “signal” elements.</p>
    <p class="Standard" dir="ltr">Subdevice workers have “supports” child elements describing which device workers they support and how they are connected to them.</p>
    <p class="Standard" dir="ltr">Device proxies have a top-level “slave” attribute identifying which worker they are a proxy for.  The name should include the authoring model suffix, such as:</p>
    <p class="Standard" dir="ltr">slave='adc-chip123.hdl'</p>
    <p class="Standard" dir="ltr">Endpoint proxies have multiple “slave” child elements indicating which other workers they are using to implement their higher level function for applications.</p>
    <h4 dir="ltr" id="toc58"><span class="SectionNumber">5.5.6.1 </span>Signal XML Elements for Device Workers and Subdevice Workers</h4>
    <p class="Standard" dir="ltr">Signal elements are children of the top level HdlDevice element, and contain the following attributes.  They identify the signals that are attached to the pins of the FPGA.</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Input='name':</span>  identifies a signal as an input and provides its name.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Output='name':</span>  identifies a signal as an output from and provides its name.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Inout='name': </span> identifies a signal as a tristate signal and provides its name.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Bidirectional:='name':</span>  identifies a signal as usable in either direction and provides its name</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Width='nn': </span> specifies that the signal is an array of signals with the width specified.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Differential='true|false':</span>  specifies that the signal is differential</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">All signal names are restricted to legal identifies in VHDL and Verilog.  Inout signals are only really tristate at the top level of the design (in the container).  Inside device workers a signal identified as “inout”, represents three signals, with the suffixes “<span class="Code">_i</span>” for input, “<span class="Code">_o</span>” for output, and “<span class="Code">_oe</span>” for the output enable.  Containers ensure that tristate signals result in a signal tristate IO pin.  Similarly, differential signals represent two signals, one with a “<span class="Code">_p</span>” suffix, and one with a “<span class="Code">_n</span>” suffix.</p>
    <h4 dir="ltr" id="toc59"><span class="SectionNumber">5.5.6.2 </span>RawProp XML Elements for Device Workers and Subdevice Workers</h4>
    <p class="Standard" dir="ltr">The rawprop child element identifies a port of the worker that extends the raw property signals from a device worker to a subdevice worker.  Its attributes are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Name='name':</span>  the name of the port (defaults to “rawprops”)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Optional='true|false':</span>  indicates whether a connection to this port is required.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Count='nn':</span>  indicates this is an array of raw property ports.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-weight:bold">Master='true|false':</span>  indicates who generates addresses for raw accesses</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">Raw property signals are listed in the following two tables.</p>
    <p class="TableCaptionbefore" dir="ltr">Table 3:  Master-to-Slave Raw Property Signals</p>
    <table cellspacing="0" dir="ltr" id="Table4table" style="margin-top:0;margin-bottom:0;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-weight:bold;font-size:14.666667px">Name</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-weight:bold;font-size:14.666667px">Type</p>
          </td>
          <td style="border:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-weight:bold;font-size:14.666667px">Purpose</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">present</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">bool_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to slave whether port is connected</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">reset</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">bool_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to slave whether master is being reset</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">renable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">bool_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to slave that a raw read is in progress</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">wenable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">bool_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to slave that a raw write is in progress.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">addr</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">ushort_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to slave the address of the current read/write access.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">benable</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Slv(3 downto 0)</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicates to slave which bytes are being read/written</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">data</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">word32_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Write data 4 bytes wide.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="TableCaptionbefore" dir="ltr">Table 4:  Slave-to-Master Raw Property Signals</p>
    <table cellspacing="0" dir="ltr" id="Table5table" style="margin-top:0;margin-bottom:0;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-weight:bold;font-size:14.666667px">Name</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-weight:bold;font-size:14.666667px">Type</p>
          </td>
          <td style="border:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-weight:bold;font-size:14.666667px">Purpose</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">done</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">bool_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to master that the access is done</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">data</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">word32_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Read data 4 bytes wide.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:81.531204px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">present</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:118.27042px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">bool_array_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:398.1952px">
            <p class="Standard" dir="ltr" style="font-size:14.666667px">Indicate to master which other masters (device workers) are present.  Range is 0 to raw_max_devices-1</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h4 dir="ltr" id="toc60"><span class="SectionNumber">5.5.6.3 </span>DevSignal XML Elements for Device Workers and Subdevice Workers</h4>
    <p class="Standard" dir="ltr">This XML element represents a custom signal bundle that is connected between device workers and subdevices.  It has two attributes:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Name='name':</span>  the name of the port (the default is “dev”).</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Optional='true|false':</span>  whether this port must be connected or not.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Count='nn':</span>  indicates an array of similar ports with the same signals.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">Signals='sig-file':</span>  indicates a file containing a top level Signals element consisting of “signal” child elements.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">The file indicated by the “Signals” attribute enumerates the signals in the bundle, similar to the “signal” elements in a device worker's OWD.</p>
    <h4 dir="ltr" id="toc61"><span class="SectionNumber">5.5.6.4 </span>Slave XML Element for Endpoint Proxies.</h4>
    <p class="Standard" dir="ltr">When an EndpointProxy requires more than one slave to implement its application-relevant endpoint type, it uses the “slave” child elements to describe them (rather than simply using the “slave” attribute at the top level).  The attributes of the “slave” child elements are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">name='device-worker-name':</span>  The name, including authoring model suffix, of the required slave device worker, e.g. “<span class="Code">lime_adc.hdl</span>”.</p>
      </li>
    </ul>
    <h4 dir="ltr" id="toc62"><span class="SectionNumber">5.5.6.5 </span>The Supports XML Element for Subdevices.</h4>
    <p class="Standard" dir="ltr">Subdevices indicate which device workers they support by using “supports” XML elements, and to indicate how they are connected to a device worker they support, they specify “connect” child elements within the “supports” elements, e.g.:</p>
    <p class="Code" dir="ltr">  &lt;supports worker='lime_dac'&gt;<br />    &lt;connect port="rawprops" to="rprops" index='1'/&gt;<br />    &lt;connect port="dev" to='dev' index='1'/&gt;<br />  &lt;/supports&gt;<br />  &lt;supports worker='lime_adc'&gt;<br />    &lt;connect port="rawprops" to="rprops" index='0'/&gt;<br />    &lt;connect port="dev" to='dev' index='0'/&gt;<br />  &lt;/supports&gt;</p>
    <p class="Standard" dir="ltr">The attributes of the “supports” element are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">worker='worker-name': </span> which names the device worker it supports</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">index='which instance': </span>  which identifies which device of that type is being supported by the subdevice.</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">The attributes of the “connect” child element of the “supports” element are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">port='subdevport': </span> the port on the subdevice that should be connected</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">to='devworkerport':</span>  the port on the supported device worker that should be connected</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">index='index':</span>  index into the subdevice's port array (when its count attribute is &gt; 1).</p>
      </li>
    </ul>
    <p class="Standard" dir="ltr">It is possible that different instances of the same device on a platform or card are supported by entirely different subdevices.</p>
    <h3 dir="ltr" id="toc63"><span class="SectionNumber">5.5.7 </span><a id="RefHeadingToc4836234407367"></a>Associating Device Workers and Subdevice Workers with Platforms and Cards.</h3>
    <p class="Standard" dir="ltr">Both device workers and subdevice workers are enumerated in the XML description of a platform or card using the “device” child element and the “worker” attribute.  This declares the existence of the device on the platform or card as well as the device worker that is used.  The order of these elements defines the ordinals of the devices when multiple instances of the same device are present.</p>
    <p class="Standard" dir="ltr">The presence of subdevice workers in this declared list makes them available to support any devices that are used in a platform configuration or container.  When a device is used (instantiated based on the platform configuration XML or the container XML), any subdevices that exist on the platform that support the device will also be instanced and connected.</p>
    <h1 dir="ltr" id="toc64"><span class="SectionNumber">6 </span><a id="RefHeading10411060509377"></a>Enabling GPU Platforms</h1>
    <p class="Body" dir="ltr"> </p>
    <h2 dir="ltr" id="toc65"><span class="SectionNumber">6.1 </span><a id="RefHeading10431060509377"></a>Enabling Development for GPU Platforms</h2>
    <p class="Body" dir="ltr">Installation script/procedure for tool kit/driver package.</p>
    <p class="Body" dir="ltr">Describe ocpiocl.</p>
    <p class="Body" dir="ltr">Do we ever need to do anything else for real compilation?</p>
    <p class="Body" dir="ltr">Installation of libraries, defining where they are.</p>
    <p class="Body" dir="ltr">Test build of existing opencl components.</p>
    <p class="Body" dir="ltr"> </p>
    <h2 dir="ltr" id="toc66"><span class="SectionNumber">6.2 </span><a id="RefHeading10451060509377"></a>Enabling Execution for GPU Platforms</h2>
    <p class="Standard" dir="ltr">OpenCL should in general do the right thing.</p>
    <p class="Standard" dir="ltr">Testing the existing OCL components and test applications.</p>
    <p class="Standard" dir="ltr"> </p>
    <h2 dir="ltr" id="toc67"><span class="SectionNumber">6.3 </span><a id="RefHeading10471060509377"></a>I/O Device Support for GPU Pßlatforms</h2>
    <p class="Standard" dir="ltr">Perhaps actually video output, openGL integration?</p>
    <p class="Textbody" dir="ltr">None at this time.</p>
    <h1 dir="ltr" id="toc68"><span class="SectionNumber">7 </span><a id="RefHeading10491060509377"></a>Glossary</h1>
    <p class="Body" dir="ltr" style="margin-top:5.328px;margin-bottom:15.984px"><span style="font-weight:bold">Application</span> – In this context of Component-Based Development (CBD), an application is a composition or assembly of components that as a whole perform some useful function.  The term “application” can also be an adjective to distinguish functions or code from “infrastructure” to support the execution of component-based application.  I.e. software/gateware is either “application” or “infrastructure”.</p>
    <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:15.984px"><span style="font-weight:bold">Configuration Properties</span> – Named scalar values of a worker that may be read or written by control software. Their values indicate or control aspects of the worker’s operation. Reading and writing these property values may or may not have side effects on the operation of the worker. Configuration properties with side effects can be used for custom worker control. Each worker may have its own, possibly unique, set of configuration properties. They may include hardware resource such registers, memory, and state.</p>
    <p class="Body" dir="ltr" style="margin-top:5.328px;margin-bottom:15.984px"><span style="font-weight:bold">Control Operations </span>– A fixed set of control operations that every worker has. <span style="color:#000000">The control aspect is a common control model that allows all workers to be managed without having to customize the management infrastructure software for each worker, while the aforementioned configuration properties are used to specialize components.</span></p>
    <p class="Body" dir="ltr" style="margin-top:5.328px;margin-bottom:15.984px"><span style="font-weight:bold">Infrastructure</span> – Software/gateware is either application of or infrastructure.</p>
    <p class="Body" dir="ltr" style="margin-top:5.328px;margin-bottom:15.984px"><span style="font-weight:bold">Worker</span> – <span style="color:#000000">A concrete implementation (and possibly runtime instance) of a component, written according to an authoring model</span>.</p>
    <p class="Body" dir="ltr" style="margin-top:5.328px;margin-bottom:15.984px;text-align:center"><span style="font-weight:bold">Authoring Model</span> – <span style="color:#000000">A set of metadata and language rules and interfaces for writing a worker.</span></p>
    <p class="Body" dir="ltr" style="color:#000000">Tool-chain</p>
    <p class="Body" dir="ltr" style="color:#000000">container</p>
    <p class="Body" dir="ltr" style="color:#000000">artifact</p>
    <p class="Body" dir="ltr" style="color:#000000">build flow</p>
    <p class="Body" dir="ltr" style="color:#000000">cross-build, cross-compile</p>
    <p class="Body" dir="ltr" style="color:#000000">development host</p>
    <p class="Body" dir="ltr" style="color:#000000">platform</p>
    <p class="Body" dir="ltr" style="color:#000000">card</p>
    <p class="Body" dir="ltr" style="color:#000000">slot</p>
    <p class="Body" dir="ltr" style="color:#000000">platform worker</p>
    <p class="Body" dir="ltr" style="color:#000000">device worker</p>
    <p class="Body" dir="ltr" style="color:#000000">platform configuration</p>
    <p class="Body" dir="ltr" style="color:#000000">HDL container</p>
    <p class="Body" dir="ltr" style="color:#000000">default container</p>
    <p class="Body" dir="ltr" style="color:#000000">interconnect</p>
    <p class="Body" dir="ltr" style="color:#000000">control plane</p>
    <p class="Body" dir="ltr" style="color:#000000">data plane</p>
    <h1 dir="ltr" id="toc69"><span class="SectionNumber">8 </span><a id="RefHeading176762116501284"></a>From PPT:</h1>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">OpenCPI Platform Development Briefing </p>
    <p class="Standard" dir="ltr">FPGA Platform Support in OpenCPI </p>
    <p class="Standard" dir="ltr">OpenCPI applications are composed from components. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Components are written and compiled for various platforms: </p>
    <p class="Standard" dir="ltr">GPPs running C/C++-based software components </p>
    <p class="Standard" dir="ltr">GPUs running OpenCL-based components </p>
    <p class="Standard" dir="ltr">FPGAs (or FPGA simulators) running VHDL-based components </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">When applications are executed, each component executes: </p>
    <p class="Standard" dir="ltr">On a platform (e.g. Linux on x86_64, or Xilinx or Altera FPGA) </p>
    <p class="Standard" dir="ltr">In a container (a runtime environment established on that platform) </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Three things must exist for an OpenCPI application to run: </p>
    <p class="Standard" dir="ltr">Components must be written and built/compiled for platforms. </p>
    <p class="Standard" dir="ltr">Applications must be specified as consisting of components </p>
    <p class="Standard" dir="ltr">Platforms must be available and enabled to run containers </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">This briefing describes how FPGA platforms are enabled and used </p>
    <p class="Standard" dir="ltr">FPGA Platform Development in OpenCPI </p>
    <p class="Standard" dir="ltr">We define an FPGA "platform" as a particular, single FPGA on some hardware (board). </p>
    <p class="Standard" dir="ltr">If a board has multiple OpenCPI-usable FPGAs: </p>
    <p class="Standard" dir="ltr">each is a platform. </p>
    <p class="Standard" dir="ltr">each may host a container in which to execute components. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Platforms are based on a particular type of FPGA chip: </p>
    <p class="Standard" dir="ltr">E.g., a Xilinx ML605 development board has a Virtex6 FPGA: </p>
    <p class="Standard" dir="ltr">xc6vlx240t, with a speed grade and a package </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Platforms are specific FPGAs connected locally to: </p>
    <p class="Standard" dir="ltr">Local I/O devices: ADC, DAC, DRAM, Flash, GbE, etc. </p>
    <p class="Standard" dir="ltr">Interconnects: PCIe, Ethernet, etc. to talk to other containers </p>
    <p class="Standard" dir="ltr">Slots: FMC, HSMC, mezzanine card slots. </p>
    <p class="Standard" dir="ltr">E.g., a Xilinx ML605 has PCI Express, DRAM, and 2 FMC slots. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Platform FPGAs host containers in which  components execute. </p>
    <p class="Standard" dir="ltr">FPGA Platforms in OpenCPI </p>
    <p class="Standard" dir="ltr">An FPGA with attached Interconnects, Devices, and Slots </p>
    <p class="Standard" dir="ltr">Platform logic, Device/Interconnect Logic, Application Logic </p>
    <p class="Standard" dir="ltr">ML605 Platform Example </p>
    <p class="Standard" dir="ltr">The FPGA: Vendor: Xilinx, Family: Virtex6, Part: xc6vlx240t </p>
    <p class="Standard" dir="ltr">Interconnect(s): PCI Express (and GbE - not supported yet) </p>
    <p class="Standard" dir="ltr">Devices: DVI video output (not supported yet) </p>
    <p class="Standard" dir="ltr">Slots: ISO/VITA 57.1 Slots: FMC-LPC and FMC-HPC </p>
    <p class="Standard" dir="ltr">ZedBoard Platform Example </p>
    <p class="Standard" dir="ltr">The FPGA: Vendor: Xilinx, Family: Zynq-7000, Part: xc7z020 </p>
    <p class="Standard" dir="ltr">Interconnect(s): AXI (to ARM) (and GbE - not supported yet) </p>
    <p class="Standard" dir="ltr">Devices: HDMI video output (not supported yet) </p>
    <p class="Standard" dir="ltr">Slots: ISO/VITA 57.1 Slot: FMC-LPC </p>
    <p class="Standard" dir="ltr">ALST4 Platform Example </p>
    <p class="Standard" dir="ltr">The FPGA: Vendor: Altera, Family: Stratix4, Part: ep4sgx230 </p>
    <p class="Standard" dir="ltr">Interconnect(s): PCI Express (and GbE - not supported yet) </p>
    <p class="Standard" dir="ltr">Devices: HDMI video output (not supported yet) </p>
    <p class="Standard" dir="ltr">Slots: Altera HSMC card slots (2) </p>
    <p class="Standard" dir="ltr">Slots and Cards </p>
    <p class="Standard" dir="ltr">Many FPGA platforms have slots/connectors for add-in cards. </p>
    <p class="Standard" dir="ltr">E.g. FPGA Mezzanine Cards (ANSI/VITA FMC Standard 57.1) </p>
    <p class="Standard" dir="ltr">E.g. HSMC (Altera's High Speed Mezzanine Card) </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">OpenCPI defines Slot Types. </p>
    <p class="Standard" dir="ltr">A slot type has pins, direction, and default signal names </p>
    <p class="Standard" dir="ltr">Typically documented in the standard specification (e.g. ANSI/VITA 57.1) </p>
    <p class="Standard" dir="ltr">Platforms specify what slots are present, of what types </p>
    <p class="Standard" dir="ltr">Using the &lt;slot&gt; XML element in the HdlPlatform XML file. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Separate from platforms, OpenCPI defines Cards </p>
    <p class="Standard" dir="ltr">Cards have a slot type, and on-board devices </p>
    <p class="Standard" dir="ltr">Cards specify wiring from devices to slot pins/signals. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Cards are like platforms: they have devices </p>
    <p class="Standard" dir="ltr">But no FPGAs, just devices connected to slot pins </p>
    <p class="Standard" dir="ltr">FPGA Platform Development on OpenCPI </p>
    <p class="Standard" dir="ltr">As consistent as possible with FPGA "application" development (OpenCPI sub-assemblies on FPGAs). </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Platform development involves the creation of specialized types of workers that enable the HDL platform. </p>
    <p class="Standard" dir="ltr">Device Workers:  like "device drivers" for specific FPGA-attached hardware devices — workers that talk to devices using ad hoc, device-specific signals and I/O pins. </p>
    <p class="Standard" dir="ltr">Platform Workers:  device workers with special responsibilities for enabling the whole platform. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Two other modules are automatically generated based on XML specifications: </p>
    <p class="Standard" dir="ltr">Platform Configurations </p>
    <p class="Standard" dir="ltr">a pre-linked core combining a platform worker with some device workers </p>
    <p class="Standard" dir="ltr">Containers: top-level bitstream designs </p>
    <p class="Standard" dir="ltr">Deploying an application subassembly on a platform configuration. </p>
    <p class="Standard" dir="ltr">Device Workers </p>
    <p class="Standard" dir="ltr">Device Workers:  like "device drivers" for specific FPGA-attached hardware. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Device Workers are special workers that have ad-hoc signals to some device attached to the FPGA </p>
    <p class="Standard" dir="ltr">Still are controlled by a normal "WCI" control interface. </p>
    <p class="Standard" dir="ltr">Have data-plane interfaces to provide data to/from application workers. </p>
    <p class="Standard" dir="ltr">Have ad-hoc signal connections to hardware </p>
    <p class="Standard" dir="ltr">Designed to be portable </p>
    <p class="Standard" dir="ltr">e.g. same DAC on different FPGAs, or on different cards </p>
    <p class="Standard" dir="ltr">Designed to be replicated </p>
    <p class="Standard" dir="ltr">E.g. multiple ADCs of the same type connected to one FPGA </p>
    <p class="Standard" dir="ltr">Analogous to "device drivers" in software. </p>
    <p class="Standard" dir="ltr">Platform Workers </p>
    <p class="Standard" dir="ltr">Platform Workers are specialized Device Workers </p>
    <p class="Standard" dir="ltr">Have ad-hoc signals to the platform hardware </p>
    <p class="Standard" dir="ltr">Not for any individual device (that's what other device workers do) </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Perform standardized "platform enabling functions" </p>
    <p class="Standard" dir="ltr">Provide control path from outside the FPGA (e.g. "register access") </p>
    <p class="Standard" dir="ltr">Provide timekeeping services and clocks </p>
    <p class="Standard" dir="ltr">Provide external access to bitstream metadata </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Standard control interface and properties </p>
    <p class="Standard" dir="ltr">Platform name, fpga device, chip serial number </p>
    <p class="Standard" dir="ltr">Switch settings (input), LEDs (output) </p>
    <p class="Standard" dir="ltr">Bitstream UUID and metadata </p>
    <p class="Standard" dir="ltr">Time-of-day, timekeeping/PPS status </p>
    <p class="Standard" dir="ltr">Can have platform-specific properties/controls </p>
    <p class="Standard" dir="ltr">E.g. PCI device ID assigned by BIOS for PCI-based platforms </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Platform Worker Ports </p>
    <p class="Standard" dir="ltr">Control Interface (WCI), like any worker </p>
    <p class="Standard" dir="ltr">Control operations and properties </p>
    <p class="Standard" dir="ltr">But platform workers also bootstrap everything, including WCIs… </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Data ports, when data producing/consuming devices cannot be optional (i.e. when they can't have their own device workers) </p>
    <p class="Standard" dir="ltr">Rare, theoretical case </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Special "infrastructure" ports to provide key services </p>
    <p class="Standard" dir="ltr">Time Service (provide platform timekeeping) </p>
    <p class="Standard" dir="ltr">This port is required of all platform workers </p>
    <p class="Standard" dir="ltr">Metadata Master (provide access to metadata via WCI properties) </p>
    <p class="Standard" dir="ltr">This port is required of all platform workers </p>
    <p class="Standard" dir="ltr">Control Plane Master (provide a control path into the device) </p>
    <p class="Standard" dir="ltr">This port is optional, but must be provided by some device if not here </p>
    <p class="Standard" dir="ltr">Data Plane NOC Master (for data connections) </p>
    <p class="Standard" dir="ltr">Optional port, when platform supplies an interconnect path to the chip </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Platform (Worker) Description XML </p>
    <p class="Standard" dir="ltr">The &lt;HdlPlatform&gt; XML file defines a platform and its worker </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">This file is used to define the platform worker </p>
    <p class="Standard" dir="ltr">Uses the "platform_spec" OCS as its "spec" (in hdl/platforms/specs) </p>
    <p class="Standard" dir="ltr">Defines ad-hoc platform signals </p>
    <p class="Standard" dir="ltr">Defines any platform-specific properties </p>
    <p class="Standard" dir="ltr">Defines any optional infrastructure ports (CP Master, NOC Master) </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">This file also lists the available devices and slots on the platform </p>
    <p class="Standard" dir="ltr">Each device is defined by its device worker </p>
    <p class="Standard" dir="ltr">A device (and device worker) can be mentioned more than once </p>
    <p class="Standard" dir="ltr">I.e. there might be multiple instances of a device on a platform </p>
    <p class="Standard" dir="ltr">Each slot is named and has a type </p>
    <p class="Standard" dir="ltr">Platform Configurations </p>
    <p class="Standard" dir="ltr">Specifies one particular "configuration" of a platform </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Builds on the minimum base of support for the platform </p>
    <p class="Standard" dir="ltr">Base support XML is the &lt;HdlPlatform&gt; XML file </p>
    <p class="Standard" dir="ltr">Base support code is the platform worker code. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">The "configuration" of the platform consists of: </p>
    <p class="Standard" dir="ltr">Which devices are supported and instanced in this configuration </p>
    <p class="Standard" dir="ltr">Which device(s) provide control plane (if not the platform worker) </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">A configuration may be constrained or optimized </p>
    <p class="Standard" dir="ltr">Constraints to physically place/constrain device workers </p>
    <p class="Standard" dir="ltr">Creates a platform configuration "core" to use for apps </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Analogous to "an OS kernel with built-in device drivers". </p>
    <p class="Standard" dir="ltr">Does not preclude more devices added in container for the app </p>
    <p class="Standard" dir="ltr">Platform Configuration Description XML </p>
    <p class="Standard" dir="ltr">Is a &lt;HdlConfig&gt; XML document </p>
    <p class="Standard" dir="ltr">Platform is implied when it is in a platform's directory </p>
    <p class="Standard" dir="ltr">Otherwise use the "platform" attribute </p>
    <p class="Standard" dir="ltr">Name is implied by the filename of the XML file </p>
    <p class="Standard" dir="ltr">Otherwise use the "name" attribute </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Child elements under &lt;HdlConfig&gt; are &lt;device&gt; </p>
    <p class="Standard" dir="ltr">Specifies which of the platform's devices are included (&lt;device …/&gt;) </p>
    <p class="Standard" dir="ltr">Device "Name" attribute matches some &lt;device&gt; in platform XML </p>
    <p class="Standard" dir="ltr">"control" boolean attribute says whether a device provides a control path to the platform (when the platform worker doesn't do it). </p>
    <p class="Standard" dir="ltr">Default is no devices at all: the base configuration </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">No source code associated with Platform Configurations </p>
    <p class="Standard" dir="ltr">All is generated </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Future: Specific constraints, Clock specs, Multiple control paths </p>
    <p class="Standard" dir="ltr">Containers </p>
    <p class="Standard" dir="ltr">A container deploys an application subassembly on a specific (FPGA) platform configuration. </p>
    <p class="Standard" dir="ltr">To specify a container you specify: </p>
    <p class="Standard" dir="ltr">The application assembly to be deployed </p>
    <p class="Standard" dir="ltr">If container is specified in an assembly directory, that assembly is implied. </p>
    <p class="Standard" dir="ltr">The platform configuration on which the assembly should run </p>
    <p class="Standard" dir="ltr">If just the platform is specified, its base configuration is implied. </p>
    <p class="Standard" dir="ltr">Top level connections </p>
    <p class="Standard" dir="ltr">Application external ports to devices or interconnects </p>
    <p class="Standard" dir="ltr">Special case: can connect devices to interconnects </p>
    <p class="Standard" dir="ltr">Example XML </p>
    <p class="Standard" dir="ltr">&lt;HdlContainer platform='ml606/ml605_flash_dac' assembly='modem'&gt;#  &lt;connection external='in' interconnect='pcie'/&gt;#  &lt;connection external='out' device='dac'/&gt;#&lt;/HdlContainer&gt; </p>
    <p class="Standard" dir="ltr">I.e. deploy the "modem" assembly on the "ml605+flash+dac" configuration, with input from PCIe and output to DAC </p>
    <p class="Standard" dir="ltr">No source code associated with Containers: all is generated </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Containers in HDL Assembly Makefiles </p>
    <p class="Standard" dir="ltr">A Default Container is defined as: </p>
    <p class="Standard" dir="ltr">All external ports of the assembly are connected to the interconnect </p>
    <p class="Standard" dir="ltr">No device worker connections are made </p>
    <p class="Standard" dir="ltr">E.g. PCI Express, or (future) ethernet </p>
    <p class="Standard" dir="ltr">If no external ports, a standalone container is built (e.g. tb_bias) </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Two "make" variables specify the containers/bitstreams to build </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">DefaultContainers= </p>
    <p class="Standard" dir="ltr">If specified empty, no default containers are built </p>
    <p class="Standard" dir="ltr">If not specified at all, default containers are built for "base" platform configurations for platforms requested in HdlPlatforms </p>
    <p class="Standard" dir="ltr">If specified not empty, only those default containers are built </p>
    <p class="Standard" dir="ltr">Containers=   specific XML-based containers </p>
    <p class="Standard" dir="ltr">The names of HdlContainer xml files to build </p>
    <p class="Standard" dir="ltr">Using specific platform configurations </p>
    <p class="Standard" dir="ltr">Specifying external port connections to devices and interconnects </p>
    <p class="Standard" dir="ltr">Example HDL Assembly Makefiles </p>
    <p class="Standard" dir="ltr">Simplest assembly/bitstream Makefile is: </p>
    <p class="Standard" dir="ltr">      include $(OCPI_CDK_DIR)/include/hdl/hdl-assembly.mk </p>
    <p class="Standard" dir="ltr">The assembly XML is assumed to be in &lt;cwd&gt;.xml </p>
    <p class="Standard" dir="ltr">Implies: build default containers for whatever platforms are requested </p>
    <p class="Standard" dir="ltr">No specific containers are indicated </p>
    <p class="Standard" dir="ltr">More complex example </p>
    <p class="Standard" dir="ltr">      DefaultContainers=isim_pf ml605_flash </p>
    <p class="Standard" dir="ltr">      Containers=ml605_ADC </p>
    <p class="Standard" dir="ltr">      include $(OCPI_CDK_DIR)/include/hdl/hdl-assembly.mk </p>
    <p class="Standard" dir="ltr">Build default container for base config of isim_pf and "flash" config of ml605 </p>
    <p class="Standard" dir="ltr">Build a specific container as described in ml605_ADC.xml </p>
    <p class="Standard" dir="ltr">Another Example </p>
    <p class="Standard" dir="ltr">      DefaultContainers= </p>
    <p class="Standard" dir="ltr">      Containers=ml605_ADC </p>
    <p class="Standard" dir="ltr">      include $(OCPI_CDK_DIR)/include/hdl/hdl-assembly.mk </p>
    <p class="Standard" dir="ltr">Build no default containers, only one in ml6065_ADC.xml </p>
    <p class="Standard" dir="ltr">Clocks </p>
    <p class="Standard" dir="ltr">The platform worker is responsible for producing two clocks, with no particular relationship: </p>
    <p class="Standard" dir="ltr">The control plane clock </p>
    <p class="Standard" dir="ltr">The timekeeping clock </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">The control plane clock is used for: </p>
    <p class="Standard" dir="ltr">All workers' control interfaces </p>
    <p class="Standard" dir="ltr">All control plane infrastructure </p>
    <p class="Standard" dir="ltr">Default clock for all other worker ports (data, time, etc). </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">The timekeeping clock drives the timekeeping system </p>
    <p class="Standard" dir="ltr">Should be the "best" (drift, PPM, etc.) clock available in the HW. </p>
    <p class="Standard" dir="ltr">Is used to keep the notion of time of day, sync'd to PPS input </p>
    <p class="Standard" dir="ltr">Provides "time of day" to any worker that wants it </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">The platform may provide other clocks </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Slots and Cards </p>
    <p class="Standard" dir="ltr">Platforms have slots of certain types. </p>
    <p class="Standard" dir="ltr">E.g. ML605s have one FMC_LPC slot and one FMC_HPC slot. </p>
    <p class="Standard" dir="ltr">E.g. Zedboards have one FMC_LPC slot </p>
    <p class="Standard" dir="ltr">A platform's slots are defined by: </p>
    <p class="Standard" dir="ltr">type </p>
    <p class="Standard" dir="ltr">non-default signal names for slot pins (different than the slot type spec) </p>
    <p class="Standard" dir="ltr">Platform configurations may indicate specific cards in specific slots. </p>
    <p class="Standard" dir="ltr">Containers may indicate or imply specific cards in specific slots </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Cards have devices just like platforms have devices. </p>
    <p class="Standard" dir="ltr">When a device is used, its device worker is instantiated and connected. </p>
    <p class="Standard" dir="ltr">Some devices on a card can remain unused and not instantiated </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Subdevices and sharing I/Os </p>
    <p class="Standard" dir="ltr">Device workers support hardware that performs a logical function. </p>
    <p class="Standard" dir="ltr">I.e. a function an application may request </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Device workers should not control multiple functions </p>
    <p class="Standard" dir="ltr">Which would force logic to be present when functions are not used. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Just because a device might have 2 functions (e.g. ADC+DAC), does not mean one device worker should control both functions. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Modular devices workers are good, but raise problems: </p>
    <p class="Standard" dir="ltr">Some hardware is shared between functions </p>
    <p class="Standard" dir="ltr">E.g. one SPI or I2C to configure multiple functions. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Solution is subdevices: </p>
    <p class="Standard" dir="ltr">They implement a shared module used by multiple device workers. </p>
    <p class="Standard" dir="ltr">Present and needed when any of the device workers are present. </p>
    <p class="Standard" dir="ltr">Instantiated and connected automatically as needed. </p>
    <p class="Standard" dir="ltr">Subdevices </p>
    <p class="Standard" dir="ltr">A subdevice is generally a device worker with no WCI </p>
    <p class="Standard" dir="ltr">It "serves" multiple actual device workers. </p>
    <p class="Standard" dir="ltr">Built like a normal device worker. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">It has the signals for external pins that must be shared between its "client" device workers. </p>
    <p class="Standard" dir="ltr">E.g. it would control SPI pins that its device workers need to share. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">It defines worker ports that are connected to its clients. </p>
    <p class="Standard" dir="ltr">They must be optional since not all clients may be present </p>
    <p class="Standard" dir="ltr">They may be a "devsignals" ports when the signals are custom. </p>
    <p class="Standard" dir="ltr">They may be "rawprop" ports when the subdevice supports sharing of a lower level access path (e.g. SPI or I2C) to hardware-based properties. </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Client device workers declare their requirements for subdevices </p>
    <p class="Standard" dir="ltr">And how they are connected to them </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Subdevices: example </p>
    <p class="Standard" dir="ltr">The shared module for Lime chip SPI and clocking options: </p>
    <p class="Standard" dir="ltr">&lt;HdlDevice language="vhdl"&gt; </p>
    <p class="Standard" dir="ltr">  &lt;ComponentSpec nocontrol='true'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;rawprop name='props' count='2' optional='1'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;devsignals count='2' optional='1' signals='lime-spi-signals'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="reset"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Input="sdo"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="sclk"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="sen"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="sdio"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Input="rx_clk_in"/&gt; &lt;!-- could be rx_clk_out from lime --&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Input="tx_clk_in"/&gt; </p>
    <p class="Standard" dir="ltr">&lt;/HdlDevice&gt; </p>
    <p class="Standard" dir="ltr">Note: no real component spec.  Completely custom w/ no control </p>
    <p class="Standard" dir="ltr">Note: rawprop slave is x2 to be ready for lime_rx and lime_tx </p>
    <p class="Standard" dir="ltr">Note: devsignals slave is x2 to be ready for lime_rx and lime_tx </p>
    <p class="Standard" dir="ltr">Note: both are optional since parts may not be connected </p>
    <p class="Standard" dir="ltr">Note: devsignals port has a custom set of signals for this worker </p>
    <p class="Standard" dir="ltr">Defined in the file lime-spi-signals in the specs directory </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Subdevices: example: the client devices </p>
    <p class="Standard" dir="ltr">The OWD for the lime_tx device worker: </p>
    <p class="Standard" dir="ltr">&lt;HdlDevice language="vhdl" FirstRawProperty="dc_regval" spec='qdac-spec'&gt; </p>
    <p class="Standard" dir="ltr">  &lt;property name='Present' type='uchar' volatile='true'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;property name='ClkMode' type='uchar' parameter='true' default='0'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;xi:include href='lime-properties.xml'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;StreamInterface Name="in" DataWidth="32"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;rawprop name='rawprops' master='true'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;requires worker='lime_spi'&gt; </p>
    <p class="Standard" dir="ltr">    &lt;connect port="rawprops" to="props" index='1'/&gt; </p>
    <p class="Standard" dir="ltr">    &lt;connect port="dev" to='dev' index='1'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;/requires&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="tx_clk"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="txen"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="tx_iq_sel"/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;Signal Output="txd" width="12"/&gt; </p>
    <p class="Standard" dir="ltr">&lt;/HdlDevice&gt; </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Note: rawprop and devsignals ports are for subdevice connection(s) </p>
    <p class="Standard" dir="ltr">Note: explicit declaration that this worker REQUIRES the subdevice </p>
    <p class="Standard" dir="ltr">and connects to "index 1" (for tx) of the subdevice. </p>
    <p class="Standard" dir="ltr">Note: this device worker still has direct signals to the device </p>
    <p class="Standard" dir="ltr">Note: this device worker actually declares the same properties as rx. </p>
    <p class="Standard" dir="ltr">Subdevices: custom signals in worker ports </p>
    <p class="Standard" dir="ltr">What needs to be shared may have custom signals </p>
    <p class="Standard" dir="ltr">&lt;devsignals master='true' signals='lime-spi-signals'/&gt; </p>
    <p class="Standard" dir="ltr">The "devsignals" port type is for this purpose. </p>
    <p class="Standard" dir="ltr">The "signals" attribute is the file full of signal declarations </p>
    <p class="Standard" dir="ltr">Allows different workers and subdevices to use the same list of signals. </p>
    <p class="Standard" dir="ltr">The direction of signals is relative to the "master" </p>
    <p class="Standard" dir="ltr">The "signals" file for the "devsignals" port for lime_spi: </p>
    <p class="Standard" dir="ltr">&lt;signals&gt; </p>
    <p class="Standard" dir="ltr">  &lt;signal input='rx_clk_in'/&gt; &lt;!-– might be used by either side --&gt; </p>
    <p class="Standard" dir="ltr">  &lt;signal input='tx_clk_in'/&gt; &lt;!-– might be used by either side --&gt; </p>
    <p class="Standard" dir="ltr">  &lt;!-- To let each side know whether they are both present --&gt; </p>
    <p class="Standard" dir="ltr">  &lt;signal input='rx_present'/&gt; </p>
    <p class="Standard" dir="ltr">  &lt;signal input='tx_present'/&gt; </p>
    <p class="Standard" dir="ltr">&lt;/signals&gt; </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr">Note: a way to tell each client whether the other is present </p>
    <p class="Standard" dir="ltr">Note: this is separate from the "rawprop" port, which is a standard port type for device workers (not application workers). </p>
    <p class="Standard" dir="ltr">Note: this is just a bundle of signals that fans out to all clients. </p>
    <p class="Standard" dir="ltr">FPGA Architecture </p>
    <p class="Standard" dir="ltr">Devices and Subdevices: Example </p>
    <p class="Standard" dir="ltr">Build flow (bottom to top) </p>
  </body>
</html>
