<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
  <!-- This file was converted to xhtml by Writer2xhtml ver. 1.5.2. See http://writer2latex.sourceforge.net for more info. -->
  <head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <title>OpenCPI RCC Development</title>
    <meta charset="UTF-8" />
    <meta content="" name="description" />
    <meta content="" name="keywords" />
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC" />
    <meta content="OpenCPI RCC Development" name="DC.title" />
    <meta content="" name="DC.subject" />
    <meta content="" name="DC.description" />
    <meta content="James Kulp" name="DC.creator" />
    <meta content="2016-05-20T14:43:21.217275000" name="DC.date" />
    <meta content="en" name="DC.language" />
    <style media="all" type="text/css">
      body {font-family:Calibri,serif;font-size:13.333334px}
      span.Code {font-family:'Courier New',monospace;font-weight:bold;font-size:16.0px;background-color:transparent}
      span.FirstEmphasis {font-family:Arial,serif;font-style:italic;font-weight:bold;font-size:16.0px}
      a:link {font-family:Arial,sans-serif;font-size:16.0px;color:#0000ff;text-decoration:underline}
      a:visited {color:#800000;text-decoration:underline}
      a.Internet20link:link {font-family:Arial,sans-serif;font-size:16.0px;color:#0000ff;text-decoration:underline}
      a.Internet20link:visited {color:#800000;text-decoration:underline}
      p.ListNumber {margin-left:38.4px;margin-right:38.4px;margin-top:4.8px;margin-bottom:4.8px;border:none;padding:0;text-indent:-19.2px;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.Textbodyindent {margin-left:0;margin-right:0;margin-top:0;margin-bottom:9.331201px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.Standard {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.TableCode {margin-left:0;margin-right:0;margin-top:4.0032px;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:'Courier New',monospace;font-weight:bold;font-size:14.666667px}
      p.TableHeading {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-weight:bold;font-size:16.0px}
      p.TableCaptionbefore {margin-left:0;margin-right:0;margin-top:9.6px;margin-bottom:14.400001px;border:none;padding:0;text-align:center;font-family:Arial,serif;font-style:italic;font-size:16.0px}
      p.Code {margin-left:24.0px;margin-right:0;margin-top:4.0032px;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:'Courier New',monospace;font-weight:bold;font-size:14.666667px}
      p.TableContents {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:14.666667px}
      p.Contents3 {margin-left:32.016px;margin-right:0;margin-top:0;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:Calibri,serif;font-size:14.666667px}
      p.ContentsHeading {page-break-before:always;margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:8.016px;border:none;padding:0;text-align:center;font-family:'Liberation Sans',sans-serif;font-weight:bold;font-size:16.0px}
      p.Contents2 {margin-left:15.984px;margin-right:0;margin-top:0;margin-bottom:0;border:none;padding:0;text-indent:0;text-align:left;font-family:Calibri,serif;font-weight:bold;font-size:14.666667px}
      p.ListBullet {margin-left:38.4px;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-indent:-19.2px;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.Contents1 {margin-left:0;margin-right:0;margin-top:8.016px;margin-bottom:0;border:none;padding:0;text-align:left;font-family:Calibri,serif;font-weight:bold;font-size:16.0px}
      p.Body {margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-size:16.0px}
      p.ListBullet2 {margin-left:48.0px;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;border:none;padding:0;text-indent:-24.0px;text-align:left;font-family:Arial,serif;font-style:italic;font-size:16.0px}
      h1 {page-break-before:always;margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-weight:bold;font-size:18.666668px;clear:left}
      h2 {page-break-before:always;margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-style:italic;font-weight:bold;font-size:16.0px;clear:left}
      h3 {margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-style:italic;font-size:16.0px;clear:left}
      h4 {margin-left:0;margin-right:0;margin-top:15.984px;margin-bottom:4.0032px;border:none;padding:0;text-align:left;font-family:Arial,serif;font-style:italic;font-size:16.0px;clear:left}
      .listlevel1Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel2Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel3Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel4Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel5Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel6Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel7Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel8Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel9Numbering1 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel1WWNum32 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel2WWNum32 {margin-top:0;margin-bottom:0;list-style-type:bullet;clear:left}
      .listlevel3WWNum32 {margin-top:0;margin-bottom:0;list-style-type:square;clear:left}
      .listlevel4WWNum32 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel5WWNum32 {margin-top:0;margin-bottom:0;list-style-type:bullet;clear:left}
      .listlevel6WWNum32 {margin-top:0;margin-bottom:0;list-style-type:square;clear:left}
      .listlevel7WWNum32 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel8WWNum32 {margin-top:0;margin-bottom:0;list-style-type:bullet;clear:left}
      .listlevel9WWNum32 {margin-top:0;margin-bottom:0;list-style-type:square;clear:left}
      .listlevel1WWNum18 {margin-top:0;margin-bottom:0;list-style-type:disc;clear:left}
      .listlevel2WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel3WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel4WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel5WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel6WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel7WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel8WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
      .listlevel9WWNum18 {margin-top:0;margin-bottom:0;list-style-type:decimal;clear:left}
    </style>
  </head>
  <body dir="ltr">
    <p class="Standard" dir="ltr" style="text-align:center"><span style="font-weight:bold;font-size:37.333336px">OpenCPI<br />RCC Development<br />Guide</span></p>
    <p class="Standard" dir="ltr" style="text-align:center;font-size:18.666668px"> </p>
    <p class="Standard" dir="ltr" style="font-size:18.666668px"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;font-size:29.333334px;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr" style="font-weight:bold;color:#ff0000"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr"> </p>
    <p class="Standard" dir="ltr" style="page-break-before:always;margin-top:0;margin-bottom:0;text-align:center;font-style:italic">Revision History</p>
    <table cellspacing="0" dir="ltr" id="Table1table" style="margin-top:0;margin-bottom:0;margin-left:-1.7376001px;margin-right:auto;width:623.73114px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:44.003204px">
            <p class="Standard" dir="ltr" style="text-align:center;font-weight:bold;font-size:10.666667px">Revision</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:448.9312px">
            <p class="Standard" dir="ltr" style="text-align:center;font-weight:bold;font-size:10.666667px">Description of Change</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:77.795204px">
            <p class="Standard" dir="ltr" style="text-align:center;font-weight:bold;font-size:10.666667px">Date</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:44.003204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.1</p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:448.9312px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0"><span style="font-size:9.333334px">Initial, from earlier doc sources</span></p>
          </td>
          <td style="border:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:77.795204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0"><span style="font-size:9.333334px">2015-10-31</span></p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:44.003204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.9</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:448.9312px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Add all C++ content slave/proxy content, references to CDG</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:77.795204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2016-01-27</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:44.003204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">0.95</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:448.9312px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Another editing pass with more consistent typography</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:77.795204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2016-02-04</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:44.003204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">1.0</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:448.9312px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">Accommodate additional issues, debug, opcodes, additional C++ container methods, debugging, C++ example</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #00000a;border-left:1.0px solid #00000a;border-right:1.0px solid #00000a;padding-top:0;padding-bottom:0;padding-left:7.9968004px;padding-right:7.6703997px;vertical-align:top;width:77.795204px">
            <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0;font-size:9.333334px">2016-04-13</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Standard" dir="ltr" style="margin-top:0;margin-bottom:0"> </p>
    <p class="Contents1" dir="ltr" style="page-break-before:always;text-align:center">Table of Contents</p>
    <div id="TableofContents1">
      <p class="ContentsHeading" dir="ltr"></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">1 </span><a href="#toc0">Introduction</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">1.1 </span><a href="#toc1">References</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">2 </span><a href="#toc2">Overview</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">3 </span><a href="#toc3">XML Description Files (OWD) for RCC Workers.</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">3.1 </span><a href="#toc4">Attributes of a Top-level RCCWorker Element</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.1 </span><a href="#toc5">Name Attribute — See the CDG</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.2 </span><a href="#toc6">Spec Attribute — See the CDG</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.3 </span><a href="#toc7">ControlOperations Attribute — See the CDG</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.4 </span><a href="#toc8">Language Attribute</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.5 </span><a href="#toc9">Slave Attribute — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.6 </span><a href="#toc10">ExternMethods Attribute — C Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.1.7 </span><a href="#toc11">StaticMethods Attribute — C Language Only</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">3.2 </span><a href="#toc12">Attributes of Port Elements in the OWD</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.2.1 </span><a href="#toc13">Name Attribute</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">3.2.2 </span><a href="#toc14">MinBufferCount Attribute</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">4 </span><a href="#toc15">The RCC Worker Interface</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.1 </span><a href="#toc16">The RCC Execution Model</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.2 </span><a href="#toc17">Worker Methods:  Called by the Container, Implemented by the Worker.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.1 </span><a href="#toc18">RCCWorker Structure Type – C Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.2 </span><a href="#toc19">The Worker Derived Class – C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.3 </span><a href="#toc20">RCCResult Enumeration Type — C and C++ Languages</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.4 </span><a href="#toc21">initialize — Worker Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.5 </span><a href="#toc24">start — Worker Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.6 </span><a href="#toc27">stop — Worker Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.7 </span><a href="#toc30">release — Worker Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.8 </span><a href="#toc33">afterConfigure — Worker Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.9 </span><a href="#toc36">beforeQuery — Worker Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.2.10 </span><a href="#toc39">run — Worker Method</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.3 </span><a href="#toc43">Container Methods, Called by the Worker.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.3.1 </span><a href="#toc44">time/getTime — Container Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.3.2 </span><a href="#toc47">setError — Container Method</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.3.3 </span><a href="#toc50">The RCC::RunCondition C++ Class</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.3.4 </span><a href="#toc51">getRunCondition — Container Method — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.3.5 </span><a href="#toc54">setRunCondition — Container Method — C++ Language Only</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.4 </span><a href="#toc57">Port Management Data Members and Methods</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.1 </span><a href="#toc58">advance — Release Current Buffer, and Request Another</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.2 </span><a href="#toc61">hasBuffer — Query a Port for Whether It Has a Current Buffer-to-release</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.3 </span><a href="#toc64">isConnected — Query a Port for Being Connected</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.4 </span><a href="#toc67">request — Request a New Buffer</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.5 </span><a href="#toc70">send — Send an Input Buffer on an Output Port</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.6 </span><a href="#toc73">setDefaultLength — Set the Default Message Length at an Output Port — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.7 </span><a href="#toc76">setDefaultOpCode — Set Default Opcode at Output Port — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.4.8 </span><a href="#toc79">take — Take a Buffer from an Input Port</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.5 </span><a href="#toc82">Buffer Management Data Members and Methods</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.1 </span><a href="#toc83">checkLength — Check Size of the Buffer — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.2 </span><a href="#toc86">data — Access the Raw Contents of the Buffer</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.3 </span><a href="#toc89">length — Retrieve the Length of the Message in a Buffer – C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.4 </span><a href="#toc92">maxLength — Retrieve the Maximum Available Space in the Buffer.</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.5 </span><a href="#toc95">opCode — Retrieve the OpCode of the Message in a Buffer</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.6 </span><a href="#toc98">release — Release a Buffer</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.7 </span><a href="#toc101">setLength — Set the Length of the Message in a Buffer — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.8 </span><a href="#toc104">setOpCode — Set the OpCode for the Message in a Buffer — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.9 </span><a href="#toc107">setInfo — Set the Metadata Associated with a Buffer — C++ Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.5.10 </span><a href="#toc110">topLength — Retrieve the Size of the Single Sequence in a Message — C++ Language Only</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.6 </span><a href="#toc113">Accessing the Contents of Messages</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.6.1 </span><a href="#toc114">Accessing Messages in C Language Workers</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.6.2 </span><a href="#toc115">Accessing Messages in C++ Language Workers</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.7 </span><a href="#toc116">How a Worker Accesses its Properties</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.7.1 </span><a href="#toc117">The Worker Property Structure</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.7.2 </span><a href="#toc118">The Accessing Worker Properties in C</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.7.3 </span><a href="#toc119">Accessing Worker Properties in C++</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.7.4 </span><a href="#toc120">Property Access Notifications</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.7.5 </span><a href="#toc121">Accessing the Values of Parameter Properties</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.8 </span><a href="#toc122">Controlling Slave Workers from Proxies — C++ Language Only</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">4.9 </span><a href="#toc123">Worker Dispatch Structures — C Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">4.9.1 </span><a href="#toc124">RCCDispatch Structure Type</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">5 </span><a href="#toc125">Code Generation for RCC Workers</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.1 </span><a href="#toc126">Namespace Management</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">5.1 </span><a href="#toc127">Generated Data Types</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.1.1 </span><a href="#toc128">The Enumeration Constants for the Worker’s Ports</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.1.2 </span><a href="#toc129">The Properties Structure Type</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.1.3 </span><a href="#toc130">Structures for Message Payloads — C Language Only</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">5.1.4 </span><a href="#toc131">Worker Base Class — C++ Language Only</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">6 </span><a href="#toc132">RCC Local Services</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">6.1 </span><a href="#toc133">RCC Local Services AEP as a Small Subset of POSIX and ISO-C.</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">7 </span><a href="#toc134">Debugging RCC Workers</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">8 </span><a href="#toc135">Summary of OpenCPI RCC Authoring Model</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">9 </span><a href="#toc136">Worker Code Examples</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">9.1 </span><a href="#toc137">C Language Examples</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">9.1.1 </span><a href="#toc138">Worker Using Input Callback</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">9.1.2 </span><a href="#toc139">Worker Using the State-machine Style</a></p>
      <p class="Contents2" dir="ltr"><span class="SectionNumber">9.2 </span><a href="#toc140">C++ Language Examples</a></p>
      <p class="Contents3" dir="ltr"><span class="SectionNumber">9.2.1 </span><a href="#toc141">Worker Using the State-machine Style</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">10 </span><a href="#toc142">Glossary</a></p>
      <p class="Contents1" dir="ltr"><span class="SectionNumber">11 </span><a href="#toc143">List of Abbreviations and Acronyms</a></p>
    </div>
    <h1 dir="ltr" id="toc0"><span class="SectionNumber">1 </span><a id="Toc57540730"></a><a id="RefHeading10151060509377"></a><a id="Toc57540727"></a><a id="Toc144999751"></a>Introduction</h1>
    <p class="Body" dir="ltr"><span style="font-family:Arial,serif;font-size:16.0px">This document specifies the </span><span class="FirstEmphasis">OpenCPI Resource-Constrained C Language (RCC)</span><span style="font-family:Arial,serif;font-size:16.0px">, authoring model and describes how to write RCC workers, in C or C++.  This model is based on the C language and makes most design choices to minimize resources appropriate for resource-constrained embedded systems.  DSP processors with on-chip memories, micro-controllers, and multi-core processors are natural targets for this authoring model.  The RCC model is also an appropriate model for any general-purpose processor with a C compiler, when the developer is comfortable with the constraints of the C language.</span></p>
    <p class="Body" dir="ltr" style="font-family:Arial,serif;font-size:16.0px">This document also describes a C++ variant of this authoring model that takes advantage of the expressive power of the C++ language.  Both the C and C++ language variants are considered to be based on this one authoring model as so many concepts and details are common.</p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,serif;font-size:16.0px">This specification is based on the authoring model concept as defined in the </span><span class="FirstEmphasis">OpenCPI Component Development Guide</span>, and<span style="font-family:Arial,serif;font-style:normal;font-size:16.0px"> is a prerequisite to this document.  </span><span style="font-family:Arial,serif;font-size:16.0px">That document introduces key concepts for all authoring models, including the configuration and lifecycle model of components, and the software execution model for most authoring models targeting general purpose software platforms.</span></p>
    <p class="Body" dir="ltr">All OpenCPI authoring models are required to coexist and interoperate with the other existing models that are more appropriate for their respective processing technologies.  These include the OCL authoring model for GPUs, and the HDL authoring model for FPGAs.  Other models and any unique aspects to their associated development workflow, are described in their own documents.</p>
    <h2 dir="ltr" id="toc1"><span class="SectionNumber">1.1 </span><a id="RefHeading110681972665394"></a>References</h2>
    <p class="Body" dir="ltr" style="font-family:Arial,serif;font-size:16.0px">This document depends on several others.  Primarily, it depends on the <span class="FirstEmphasis">OpenCPI Component Development Guide</span>, which describes concepts and definitions common to all OpenCPI authoring models.  As the RCC authoring model is based on the C language, specifically C90: ISO/IEC 9899:1990, it also depends on the ISO-C language reference manual and associated libraries.  The exceptions to the C90 basis are the use of <span class="Code">&lt;stdint.h&gt;</span> from C99.  The C++ authoring model is based on the language as defined in <span class="FirstEmphasis">ISO/IEC 14882:2003</span>, prior to Cxx11.</p>
    <p class="TableCaptionbefore" dir="ltr"><a id="Ref58813963"></a>Table <a id="seqrefTable0">1</a>:  Table of Reference Documents</p>
    <table cellspacing="0" dir="ltr" id="Table2table" style="margin-top:0;margin-bottom:0;margin-left:-1.2px;margin-right:auto;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:142.0px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Title</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:99.7984px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Published By</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:376.2016px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Link</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:142.0px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">OpenCPI Component Development Guide</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:99.7984px">
            <p class="TableContents" dir="ltr" style="font-family:Arial,serif;font-size:14.666667px;color:#0000ff;text-decoration:underline">OpenCPI</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:376.2016px">
            <p class="TableContents" dir="ltr"><a class="Internet20link" href="https://github.com/opencpi/opencpi/raw/master/doc/pdf/OpenCPI_Component_Development.pdf"><span style="font-family:Arial,serif;font-size:14.666667px;color:#0000ff;text-decoration:underline">https://github.com/opencpi/opencpi/doc/pdf/OpenCPI_Component_Development.pdf</span></a></p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:142.0px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">ISO C Language Specification</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:99.7984px">
            <p class="TableContents" dir="ltr"><a class="Internet20link" href="http://www.open-std.org/jtc1/sc22/wg14/www/standards.html#9899"><span style="font-family:Arial,serif;font-size:14.666667px;color:#0000ff;text-decoration:underline">C Language</span></a></p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:middle;width:376.2016px">
            <p class="TableContents" dir="ltr" style="font-family:Arial,serif;font-size:14.666667px">ISO/IEC 9899:90</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:middle;width:142.0px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">ISO C++ Language Specification</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:middle;width:99.7984px">
            <p class="TableContents" dir="ltr"><a class="Internet20link" href="http://www.open-std.org/JTC1/SC22/WG21/"><span style="font-size:14.666667px">C++ Language</span></a></p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:middle;width:376.2016px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">ISO/IEC 14882:2003</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h1 dir="ltr" id="toc2"><span class="SectionNumber">2 </span><a id="RefHeadingToc53181067000368"></a><a id="Toc270018416"></a>Overview</h1>
    <p class="Body" dir="ltr">RCC workers are C/C++ language component implementations that do work.  They are hosted in an OpenCPI <span style="font-style:italic;font-weight:bold">container</span>, which is responsible for:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">loading, executing, controlling, and configuring the worker</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">effecting data movement to and from the data ports of the worker</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">providing interfaces for the local services available to RCC workers. </p>
      </li>
    </ul>
    <p class="Body" dir="ltr">RCC workers that are executing and collocated together in the same container can make use of local zero-copy approaches to move data between them.  For connections between workers in <span style="font-style:italic">different</span> containers, the containers move data between each other using a common data transport mechanism.  Containers make use of a default data transport between the two devices unless explicitly configured to do otherwise. </p>
    <p class="Body" dir="ltr">The <span class="FirstEmphasis">OpenCPI Component Development Guide (CDG)</span> contains sections for the general introduction to the control plane functionality of workers and containers, followed by the general execution model of software-based workers.  The specifics of the RCC authoring model are included here, consisting of:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">container-to-worker interfaces:</span>  how the container calls the worker’s entry points</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">worker-to-container interfaces:</span>  how the worker calls the container’s entry points</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-style:italic;font-weight:bold">the local services:</span>  how the worker uses local services and which ones are available.<a id="Toc270018429"></a></p>
      </li>
    </ul>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">Creating a component implementation (a.k.a. </span><span style="font-style:italic;font-size:16.0px">authoring a worker</span><span style="font-size:16.0px">), includes writing source code as well as specifying certain characteristics of the implementation in a separate XML file.  This XML file is called the </span><span class="FirstEmphasis"><span style="text-decoration:underline">O</span>penCPI <span style="text-decoration:underline">W</span>orker <span style="text-decoration:underline">D</span>escription (OWD)</span><span style="font-size:16.0px">.  It describes any non-default constraints or behavior of this particular component implementation.  It also lists attributes and information that are specific to the authoring model.  All OWDs must specify two items:  the </span><span class="FirstEmphasis"><span style="text-decoration:underline">O</span>penCPI <span style="text-decoration:underline">C</span>omponent <span style="text-decoration:underline">S</span>pecification (OCS)</span><span style="font-size:16.0px"> being implemented, and the authoring model being used.  The OWD aspects that are common to all authoring models are described in the </span><span class="FirstEmphasis">OpenCPI Component Development Guide</span><span style="font-size:16.0px">.</span></p>
    <h1 dir="ltr" id="toc3"><span class="SectionNumber">3 </span><a id="RefHeading15951517827571"></a><a id="Toc270018448"></a>XML Description Files (OWD) for RCC Workers.</h1>
    <p class="Body" dir="ltr">This section describes the format and structure of the RCC OWD.  This XML document, at a minimum, refers to a OCS, and specifies the implementation-specific aspects of the worker.</p>
    <p class="Standard" dir="ltr">The top level XML element for a RCC worker is <span style="font-family:&apos;Courier New&apos;,sans-serif;font-weight:bold;font-size:16.0px">RCCWorker</span>.  Using the defaults the simplest OWD for an RCC worker would be:</p>
    <p class="Code" dir="ltr">&lt;RCCWorker spec='myspec'/&gt;</p>
    <p class="Body" dir="ltr">The <span class="Code">RCCWorker</span> XML element contains information provided by someone creating an RCC worker based on a component specification (OCS).  This OWD includes or references an OCS, and then describes implementation information about this particular RCC implementation of that OCS.  The <span class="Code">RCCWorker</span> element must either include as a child element a complete OCS, or include one by reference, using the spec attribute of the top-level element.  For example, the “vsadd” implementation of the “vsadd-spec” OCS would reference the component specification this way:</p>
    <p class="Body" dir="ltr">A more complete example, the vsadd implementation of the vsadd-spec OCS would include a reference this way:</p>
    <p class="Code" dir="ltr">&lt;RCCWorker spec=”vsadd-spec”<br />	---other attributes---<br />	&gt;<br />	---other child elements---<br />&lt;/RCCWorker&gt;</p>
    <p class="Body" dir="ltr">The <span class="Code">RCCWorker</span> follows the specification of OWDs in general as specified elsewhere.  This section only defines the aspects of the RCC OWD that are <span style="font-style:italic">not</span> common to all OWDs.  A more complete example is below:</p>
    <p class="Code" dir="ltr">&lt;RCCWorker language='c++' spec='vsadd-spec'&gt;<br />  &lt;SpecProperty name='control' readable='true'/&gt;<br />  &lt;Property name='debug' type='float' volatile='true'/&gt;<br />  &lt;Port name='in' minBufferCount='2'/&gt;<br />&lt;/RCCWorker&gt;</p>
    <p class="Body" dir="ltr">The <span style="font-family:&apos;Courier New&apos;,monospace;font-weight:bold;font-size:16.0px">RCCWorker</span> element may also include the OCS as an embedded child element in the rare cases when there can never be alternative implementations of that OCS.</p>
    <h2 dir="ltr" id="toc4" style="page-break-before:always"><span class="SectionNumber">3.1 </span><a id="Toc270018449"></a><a id="Toc211781115"></a><a id="Toc211780966"></a><a id="RefHeading15953517827571"></a>Attributes of a Top-level RCCWorker Element</h2>
    <p class="Body" dir="ltr">The <span class="Code">name</span>, <span class="Code">spec</span>, and <span class="Code">controloperations</span> attributes are the same for all authoring models and are described in the CDG.</p>
    <h3 dir="ltr" id="toc5"><span class="SectionNumber">3.1.1 </span><a id="Toc211781120"></a><a id="Toc270018450"></a><a id="RefHeading15955517827571"></a><a id="Toc211781116"></a>Name Attribute — See the CDG</h3>
    <h3 dir="ltr" id="toc6"><span class="SectionNumber">3.1.2 </span><a id="RefHeadingToc35101549088399"></a>Spec Attribute — See the CDG</h3>
    <h3 dir="ltr" id="toc7"><span class="SectionNumber">3.1.3 </span><a id="RefHeading10634140039662"></a><a id="Toc270018452"></a>ControlOperations Attribute — See the CDG</h3>
    <h3 dir="ltr" id="toc8"><span class="SectionNumber">3.1.4 </span><a id="Toc270018451"></a><a id="RefHeading10632140039662"></a>Language Attribute</h3>
    <p class="Body" dir="ltr">The <span class="Code">Language</span> attribute of the component implementation for RCC workers should have the value <span class="Code">c</span> or <span class="Code">c++</span>.  The default is <span class="Code">c</span>.</p>
    <h3 dir="ltr" id="toc9"><span class="SectionNumber">3.1.5 </span><a id="RefHeadingToc80351067000368"></a>Slave Attribute — C++ Language Only</h3>
    <p class="Standard" dir="ltr">This attribute indicates that this worker is a proxy for another worker, and that other worker is named as the string value of this attribute.  This attribute is only supported for C++.  The name of the slave worker may have a package prefix, denoted with periods, if the slave worker is not in the same namespace as this worker.  The slave worker name must include the authoring model suffix.  An example is:</p>
    <p class="Code" dir="ltr">&lt;RCCWorker language='c++' slave='ocpi.devices.xyz_adc.hdl'/&gt;</p>
    <p class="Standard" dir="ltr">This would indicate that this worker is a proxy for the HDL worker named <span class="Code">xyz_adc</span>, in the <span class="Code">ocpi.devices</span> package name scope.</p>
    <h3 dir="ltr" id="toc10"><span class="SectionNumber">3.1.6 </span><a id="RefHeading57792638251233"></a>ExternMethods Attribute — C Language Only</h3>
    <p class="Body" dir="ltr">The default scope and name for RCC worker methods in C is to be declared static, i.e. name-scoped in the file, and have the method name in lower case, e.g.:</p>
    <p class="Code" dir="ltr"><span style="text-decoration:underline">static</span> RCCResult <span style="text-decoration:underline">start</span>(RCCWorker *self);</p>
    <p class="Body" dir="ltr">This attribute is used to change the name scope to external, and provide a pattern string to use when generating the names of methods.  The pattern string value of this attribute is like a <span class="Code">sprintf</span> format string where various letter codes are preceded by <span class="Code">%</span> to insert values into the string.  The letter codes are:  <span class="Code">m</span> (lower case method name), <span class="Code">M</span> (capitalized method name), <span class="Code">w</span> (lower case worker name), and <span class="Code">W</span> (capitalized worker name).  An example is the pattern <span class="Code">%W_%m</span>, which, for the start method of the XYZ worker, would be:</p>
    <p class="Code" dir="ltr"><span style="text-decoration:underline">extern</span> RCCResult <span style="text-decoration:underline">Xyz_start</span>(RCCWorker *self);</p>
    <p class="Body" dir="ltr">The code generator uses this pattern when generating the skeleton file for the worker.</p>
    <h3 dir="ltr" id="toc11"><span class="SectionNumber">3.1.7 </span><a id="RefHeadingToc35103549088399"></a>StaticMethods Attribute — C Language Only</h3>
    <p class="Body" dir="ltr">This attribute provides a pattern like the <span class="Code">ExternMethods</span> attribute, but leaves the worker methods in the file scope, declared <span class="Code">static</span>.</p>
    <h2 dir="ltr" id="toc12" style="page-break-before:always"><span class="SectionNumber">3.2 </span><a id="RefHeading10636140039662"></a><a id="Toc211780968"></a><a id="Toc211781121"></a><a id="Toc270018453"></a>Attributes of Port Elements in the OWD</h2>
    <p class="Body" dir="ltr">The <span class="Code">port</span> child element of the <span class="Code">RCCWorker</span> specifies information about a data port in the OCS.  It references an OCS <span class="Code">port, </span>or <span class="Code">dataInterfaceSpec,</span> element by its <span class="Code">Name</span> attribute.  The <span class="Code">Name</span> attribute of the <span class="Code">Port</span> element must match the <span class="Code">Name</span> attribute of a <span class="Code">Port</span> or <span class="Code">DataInterfaceSpec</span> element of the <span class="Code">ComponentSpec</span>.  The <span class="Code">Port</span> element adds implementation-specific information about the port initially defined in that <span class="Code">ComponentSpec</span>.</p>
    <p class="Body" dir="ltr">A number of attributes available for the <span class="Code">port</span> element are common to all authoring models and are described in the CDG.  These are usually used to override attributes inferred from the protocol associated with the data port.</p>
    <h3 dir="ltr" id="toc13"><span class="SectionNumber">3.2.1 </span><a id="RefHeading10638140039662"></a><a id="Toc270018454"></a>Name Attribute</h3>
    <p class="Body" dir="ltr">This attribute specifies the name used to reference the <span class="Code">Port</span> or <span class="Code">DataInterfaceSpec</span> element in the <span class="Code">ComponentSpec</span>.</p>
    <h3 dir="ltr" id="toc14"><span class="SectionNumber">3.2.2 </span><a id="Toc270018455"></a><a id="RefHeading10640140039662"></a>MinBufferCount Attribute</h3>
    <p class="Body" dir="ltr">This numeric attribute specifies the minimum number of message buffers required by the worker for a port.  The <span class="FirstEmphasis">Worker Interface</span> allows the worker code (typically in the <span class="Code">run</span> method) to <span class="FirstEmphasis"><span style="font-style:normal">take</span></span> a buffer from a port, and ask for a new buffer for that port and retain ownership of the previous buffer from that port.  This behavior requires the infrastructure to provide at least two buffers for that port.</p>
    <p class="Body" dir="ltr">This attribute informs the infrastructure as to the minimum buffering requirements of the worker implementation for that port.  The default value is one.<span style="font-style:italic">  This attribute should not be used to tune the buffer count for performance.  It should only specify the actual minimum requirements for the correct function of the worker.</span></p>
    <h1 dir="ltr" id="toc15"><span class="SectionNumber">4 </span><a id="Toc270018430"></a><a id="RefHeading10574140039662"></a><span style="font-weight:bold">The RCC Worker Interface</span></h1>
    <p class="Body" dir="ltr">This section defines the interface between the worker and its container:  the API for this authoring model.  The term <span class="FirstEmphasis">worker method</span> is used as a shorthand and language-neutral term for what is a member function in C++ or a worker entry point function in C.  The methods in C++ have an implicit <span class="Code">this</span> argument that is hidden by the language.  C language RCC workers have the first argument to all worker methods as an explicit <span class="Code">self</span> argument.  This is a pointer to a structure containing context and state information for the worker.  When discussing a worker's runtime behavior, the term <span class="FirstEmphasis">worker</span> is sometimes used as a runtime <span style="font-style:italic">instance</span> of the worker in contrast to referring to the source code that is written for the worker as a component implementation.</p>
    <p class="Body" dir="ltr">RCC workers must avoid the prefixes <span class="Code">OCPI</span> and <span class="Code">RCC</span> (even without a trailing underscore) for compile-time constants and types as these are used by the authoring model.  The RCC authoring model also specifies that all macros are upper case, and all data types are capitalized and mixed CamelCase.</p>
    <p class="Body" dir="ltr">The worker interface consists of control operation methods whose behavior is defined in the <span style="font-weight:bold">Control Plane Introduction</span> section of the CDG<span class="FirstEmphasis">.</span>  In addition, there is a required <span style="font-family:&apos;Courier New&apos;;font-style:italic;font-weight:bold">run</span> method that supports the event-driven execution model defined in the <span style="font-weight:bold">Software Execution Model</span> section of that same document.  The <span style="font-family:&apos;Courier New&apos;;font-style:italic;font-weight:bold">run</span> method is the only required method and all the other methods are optional.  All processing of the worker occurs in the context of these methods.</p>
    <p class="Body" dir="ltr">The interface uses several basic integer types to provide some compiler independence.  The integer types are defined using the ISO C 99 <span class="Code">&lt;stdint.h&gt;</span> types.  These basic types are:  <span class="Code">uint8_t</span>, <span class="Code">uint16_t,</span> <span class="Code">uint32_t</span>, <span class="Code">RCCBoolean, RCCChar</span> and <span class="Code">RCCOrdinal</span>.  The type <span class="Code">RCCBoolean</span> is aliased to <span class="Code">uint8_t</span>, to be consistent with the defined size in property space and message content layouts.  The <span class="Code">RCCOrdinal</span> type is an alias for <span class="Code">uint16_t</span>, and is used when ordinals are required (ports, operations, exceptions, properties).</p>
    <p class="Body" dir="ltr">There are two categories of methods:</p>
    <ul class="listlevel1WWNum18">
      <li>
        <p class="ListBullet" dir="ltr" style="margin-left:24.0px;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:-24.0px;text-align:left;font-family:Arial,sans-serif"><span style="font-style:italic;font-weight:bold;font-size:16.0px">Worker methods</span><span style="font-style:italic;font-size:16.0px"> that represent functionality of the worker, to be called by the container, and which may have default implementations.  These include the </span><span class="Code"><span style="font-style:italic">run</span></span><span style="font-style:italic;font-size:16.0px"> method, and the lifecycle control operation methods:  </span><span class="Code"><span style="font-style:italic">initialize</span></span><span style="font-style:italic;font-size:16.0px">, </span><span class="Code"><span style="font-style:italic">start</span></span><span style="font-style:italic;font-size:16.0px">, </span><span class="Code"><span style="font-style:italic">stop</span></span><span style="font-style:italic;font-size:16.0px">, and </span><span class="Code"><span style="font-style:italic">release</span></span><span style="font-style:italic;font-size:16.0px">.</span></p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr" style="margin-left:24.0px;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:-24.0px;text-align:left;font-family:Arial,sans-serif"><span style="font-style:italic;font-weight:bold;font-size:16.0px">Container methods</span><span style="font-style:italic;font-size:16.0px"> that represent functionality of the container, to be called by the worker, such as changing run conditions, and accessing ports and buffers.  All C language container methods are dispatched through function pointers in the </span><span class="Code"><span style="font-style:italic">container</span></span><span style="font-style:italic;font-size:16.0px"> member of the </span><span class="Code"><span style="font-style:italic">RCCWorker</span></span><span style="font-style:italic;font-size:16.0px"> structure.  In C++ container methods are accessible member functions inherited from the worker's base class.</span></p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The various data types used in worker and container methods are described in the following sections.  The concept of a “default” method for C-language workers is indicated by <span class="Code">NULL</span> pointers for those methods in the <span class="Code">RCCDispatch</span> structure.  For C++, they are simply the methods in the base class.</p>
    <h2 dir="ltr" id="toc16"><span class="SectionNumber">4.1 </span><a id="RefHeadingToc717211826048042"></a>The RCC Execution Model</h2>
    <p class="Body" dir="ltr">The CDG describes the fundamentals of software execution models for OpenCPI software authoring models.  RCC workers executing in their containers operate according to this model, with the details described in the <a class="Internet20link">RCC Worker Interface</a> section below.</p>
    <p class="Body" dir="ltr">The container executes workers such that all execution threads are supplied by the container.  Thus there is no need or possibility for workers to create threads.  Containers may arrange for workers to run concurrently, each in its own thread, or run one at a time with all workers in the container running in a single thread.</p>
    <p class="Body" dir="ltr" style="font-family:Arial,serif;font-size:16.0px">A simple non-preemptive single-threaded container implementation would have a loop, testing <span class="FirstEmphasis">run conditions</span>, and calling workers' <span class="FirstEmphasis">run</span> methods.  A more complex environment might run workers in different threads for purposes of time preemption, prioritization, etc.  This execution model allows a variety of container execution models while keeping the worker code simple.</p>
    <p class="Body" dir="ltr">On each execution, the worker sees the status of all I/O ports, and can read from current input buffers, and write to current output buffers.  It must return to get new buffers, after specifying whether buffers are consumed or filled during the execution.</p>
    <p class="Body" dir="ltr" style="font-family:Arial,serif;font-size:16.0px">This simple execution environment can be easily implemented in full function GPP environments, providing a test environment and a migration path to more minimal embedded environments such as a single-threaded environment with no real operating system at all.</p>
    <h2 dir="ltr" id="toc17" style="page-break-before:always"><span class="SectionNumber">4.2 </span><a id="RefHeading10576140039662"></a><a id="Toc270018431"></a>Worker Methods:  Called by the Container, Implemented by the Worker.</h2>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This section describes the methods that a worker may implement with only one being mandatory:  </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">run</span><span style="font-size:16.0px">.  All others methods are optional and have default behavior.  These other methods are </span><span class="FirstEmphasis">control operations</span><span style="font-size:16.0px"> that perform lifecycle state transitions.  The transitions are described in the control plane introduction section of the CDG.  All processing of the worker occurs in the context of these worker methods.</span></p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">For C++, the code generation tools create a custom base class that the actual worker class inherits.  The derived class that implements the worker is declared by the worker author directly in their source code.  This derived class inherits the custom base class, but can otherwise contain any other member functions and data members, with the caveat that they do not shadow certain members in the generated custom base class (which are specifically mentioned below).  All worker methods in C++ are member functions and this is where all worker processing takes place.</span></p>
    <h3 dir="ltr" id="toc18"><span class="SectionNumber">4.2.1 </span><a id="RefHeading86921123303156"></a>RCCWorker Structure Type – C Language Only</h3>
    <p class="Body" dir="ltr">This structure type , a <span class="Code">typedef</span> name, represents the visible state of a worker.  The container creates this structure (defined in <span class="Code">RCC_Worker.h</span>) with any content or member ordering as long as the documented members are supported.  The structure members are written by either the container or the worker, but not both.  Members written by the container are declared <span class="Code">const</span> to enhance error checking when compiling worker code.  A pointer to this structure is the first argument to all C language worker methods, called <span class="Code">self</span>.</p>
    <p class="Body" dir="ltr">Workers (code in worker methods) access property values via the <span class="Code">properties</span> member of the <span class="Code">RCCWorker</span> structure, whose type is <span class="Code">void *</span>.  Its usage is described in the <a class="Internet20link">Property Access</a> section below.</p>
    <p class="Body" dir="ltr">The defined members of the <span class="Code">RCCWorker</span> structure are described in the table below.  Some example code that uses these various members of <span class="Code">RCCWorker</span> is:</p>
    <p class="Code" dir="ltr">XyzProperties <span style="font-weight:bold">props = self-&gt;properties; // void * needs no cast<br /></span><br />MyState *state = self-&gt;memory;          // void * needs no cast<br /><br />self-&gt;container.setError(“stuff happened”);<br /><br />if (self-&gt;runCondition == &amp;mySearchCondition) …<br /><br />if (self-&gt;connectedPorts &amp; (1 &lt;&lt; XYZ_IN)) …<br /><br />uint32_t *msgdata = self-&gt;ports[XYZ_IN].current.data;</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a> Members of the RCCWorker Structure for C Workers</p>
    <table cellspacing="0" dir="ltr" id="Table4table" style="margin-top:0;margin-bottom:0;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.3333334px solid #000000;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableHeading" dir="ltr">Member Name</p>
          </td>
          <td style="border-top:1.3333334px solid #000000;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableHeading" dir="ltr">Member<br />Data Type</p>
          </td>
          <td style="border-top:1.3333334px solid #000000;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableHeading" dir="ltr">Written by</p>
          </td>
          <td style="border:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableHeading" dir="ltr">Member<br />Description</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr">properties</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">void *const</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">container</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">A <span class="Code">const</span> pointer to the properties structure for the worker, whose layout is implied by the properties declared in the OCS and OWD.  The value is NULL if there are no such properties.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr" style="font-style:normal">memories</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">void *const<br />*const</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">container</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">An array of <span class="Code">const</span> pointers to the memory resources requested by the worker in the <span class="Code">memSizes</span> member of the <span class="Code">RCCDispatch</span> structure.  Any memories that are not read-only are initialized to zero before a worker executes any method.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr" style="font-style:normal">memory</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">void *const</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">container</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">A pointer to the memory resource as requested in the <span class="Code">memSize</span> member of the <span class="Code">RCCDispatch</span> structure.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr">container</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">const RCCContainer</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">container</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">A dispatch table of container method/function pointers.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr">runCondition</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">RCCRunCondition*</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">worker</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">Initialized from the <span class="Code">RCCDispatch runCondition</span> member.  Checked by container after calling the start method.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr" style="font-style:normal">connectedPorts</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">RCCPortMask</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">container</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">A mask indicating which ports are connected.  A worker can check this to see if an optional port is connected.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:126.93227px">
            <p class="TableCode" dir="ltr">ports</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:132.99945px">
            <p class="TableCode" dir="ltr">RCCPort[]</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:none;padding:4.8px;vertical-align:top;width:61.537064px">
            <p class="TableContents" dir="ltr">varies by<br />member</p>
          </td>
          <td style="border-top:none;border-bottom:1.3333334px solid #000000;border-left:1.3333334px solid #000000;border-right:1.3333334px solid #000000;padding:4.8px;vertical-align:top;width:257.46454px">
            <p class="TableContents" dir="ltr">An array of RCCPort structures, indexed by port ordinals.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h3 dir="ltr" id="toc19"><span class="SectionNumber">4.2.2 </span><a id="RefHeadingToc35105549088399"></a>The Worker Derived Class – C++ Language Only</h3>
    <p class="Body" dir="ltr">All the worker methods are member functions of the worker's derived class.  This class inherits a base class specifically generated for the worker and defined in the <span class="Code">gen/&lt;worker&gt;-worker.hh</span> file.  Worker methods that must exist (based on the OWD), are declared pure virtual in this generated base class.  Container methods are accessible member functions of the base class.  There are several accessible data members of the generated base class that can used in worker method code.  One is <span class="Code">m_properties</span>, which is a structure containing members for property values.  Its usage is described in the <a class="Internet20link">Property Access</a> section below.</p>
    <p class="Body" dir="ltr">There are also data members in the base class for each port.  These are described in the <a class="Internet20link">Port Management Data Members and Methods</a> section below.</p>
    <h3 dir="ltr" id="toc20"><span class="SectionNumber">4.2.3 </span><a id="RefHeading10578140039662"></a>RCC<a id="Toc270018432"></a>Result Enumeration Type — C and C++ Languages</h3>
    <p class="Body" dir="ltr">The <span class="Code">RCCResult</span> type is an enumeration type used as the return value for all worker methods.  It indicates to the container what to do when the worker method returns, as described in the following table:</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a>:  RCCResult Return Values</p>
    <table cellspacing="0" dir="ltr" id="Table5table" style="margin-top:0;margin-bottom:0;margin-left:1.0px;margin-right:auto;width:575.136px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:middle;width:157.87038px">
            <p class="TableHeading" dir="ltr">Enumeration Identifier</p>
          </td>
          <td style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:4.8px;vertical-align:middle;width:395.0656px">
            <p class="TableHeading" dir="ltr">Description</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:top;width:157.87038px">
            <p class="TableContents" dir="ltr"><span class="Code">RCC_OK</span></p>
          </td>
          <td style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:4.8px;vertical-align:top;width:395.0656px">
            <p class="TableContents" dir="ltr">The worker method succeeded without error.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:1.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:top;width:157.87038px">
            <p class="TableContents" dir="ltr"><span class="Code">RCC_ERROR</span></p>
          </td>
          <td style="border:1.0px solid #000001;padding:4.8px;vertical-align:top;width:395.0656px">
            <p class="TableContents" dir="ltr">The worker method did not succeed, but the error is not fatal to worker or container:  the method may be retried if defined to allow this.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:1.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:top;width:157.87038px">
            <p class="TableContents" dir="ltr"><span class="Code">RCC_FATAL</span></p>
          </td>
          <td style="border:1.0px solid #000001;padding:4.8px;vertical-align:top;width:395.0656px">
            <p class="TableContents" dir="ltr">The worker should never run again and is non-functional.  The container or other workers may be damaged.  The worker is in an <span style="font-style:italic;font-weight:bold">unusable</span> state.  The container may know that it, or other workers are protected from damage, but the worker indicates this condition in case there is no such protection.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:1.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:top;width:157.87038px">
            <p class="TableContents" dir="ltr"><span class="Code">RCC_DONE</span></p>
          </td>
          <td style="border:1.0px solid #000001;padding:4.8px;vertical-align:top;width:395.0656px">
            <p class="TableContents" dir="ltr">The worker needs no more execution.  This is a normal completion.  The worker is entering the <span style="font-style:italic;font-weight:bold">finished</span> state.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:1.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:top;width:157.87038px">
            <p class="TableContents" dir="ltr"><span class="Code">RCC_ADVANCE</span></p>
          </td>
          <td style="border:1.0px solid #000001;padding:4.8px;vertical-align:top;width:395.0656px">
            <p class="TableContents" dir="ltr">The worker is requesting that all ports that were ready when the run method was entered be <span style="font-style:italic">advanced</span> (applies only to the run method).</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:1.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:none;padding:4.8px;vertical-align:top;width:157.87038px">
            <p class="TableContents" dir="ltr"><span class="Code">RCC_ADVANCE_DONE</span></p>
          </td>
          <td style="border:1.0px solid #000001;padding:4.8px;vertical-align:top;width:395.0656px">
            <p class="TableContents" dir="ltr">The worker is requesting that all ports be advanced (run method only) and declaring that it is also “done”. The worker is entering the <span style="font-style:italic;font-weight:bold">finished</span> state.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-size:16.0px">These return values apply to each method as defined in their specific behavior.  Some values are not valid results for all methods. </span><span style="font-family:Arial,sans-serif;font-size:16.0px;color:#000000;background-color:transparent"> When the result is </span><span class="Code"><span style="color:#000000">RCC_ERROR</span></span><span style="font-family:Arial,sans-serif;font-size:16.0px;color:#000000;background-color:transparent"> or </span><span class="Code"><span style="color:#000000">RCC_FATAL</span></span><span style="font-family:Arial,sans-serif;font-size:16.0px;color:#000000;background-color:transparent">, the worker may have also set a descriptive error message via the </span><span class="Code"><span style="color:#000000">setError</span></span><span style="font-family:Arial,sans-serif;font-size:16.0px;color:#000000;background-color:transparent"> container method</span> described below.</p>
    <h3 dir="ltr" id="toc21"><span class="SectionNumber">4.2.4 </span><a id="RefHeading10580140039662"></a><span style="font-weight:bold">i</span><a id="Toc211780947"></a><a id="Toc211781070"></a><span style="font-weight:bold">nitialize</span> — Worker Method</h3>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This worker method implements the </span><span class="FirstEmphasis">initialize</span><span style="font-size:16.0px"> control operation as defined in the </span>CDG<span style="font-size:16.0px"> and it is optional.  It cannot depend on any property settings.  A worker should implement this method under these conditions, for one-time initializations that </span><span style="font-style:italic;font-size:16.0px">do not</span><span style="font-size:16.0px"> depend on properties:</span></p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">There are initialization errors that can be reported to the container.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">There is significant processing work involved in the initialization.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">There are significant resource allocations performed during initialization.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">If none of the above conditions are true, this method can be unimplemented and the default implementation will be used.</p>
    <p class="Body" dir="ltr">Using the <span class="Code"><span style="font-style:normal">initialize</span></span> method will allow the <span class="Code"><span style="font-style:normal">run</span></span> or <span class="Code">start</span> methods to be more consistent in execution time.  Without an <span class="Code"><span style="font-style:normal">initialize</span></span>, all one-time initialization must be done on the first invocation of <span class="Code">start</span>, or if <span class="Code">start</span> is unimplemented, the first invocation of <span class="Code"><span style="font-style:normal">run</span></span>.  Sometimes this is unavoidable.</p>
    <h4 dir="ltr" id="toc22"><span class="SectionNumber">4.2.4.1 </span><a id="RefHeading10660140039662"></a><a id="Toc211781071"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult initialize(RCCWorker *self);  // C language<br />RCCResult initialize();                        // C++ language</p>
    <h4 dir="ltr" id="toc23"><span class="SectionNumber">4.2.4.2 </span><a id="Toc211781072"></a><a id="RefHeading10662140039662"></a>Returns</h4>
    <p class="Body" dir="ltr">This method shall return a <span class="Code">RCCResult</span> value.</p>
    <p class="Body" dir="ltr">If the initialization cannot succeed, it shall return <span class="Code">RCC_ERROR</span>.  If the worker detects an error that would disable the implementation or its environment, it shall return <span class="Code">RCC_FATAL</span>.  Otherwise it shall return <span class="Code">RCC_OK</span> if normal worker execution should proceed.</p>
    <h3 dir="ltr" id="toc24"><span class="SectionNumber">4.2.5 </span><a id="RefHeading10582140039662"></a><span style="font-weight:bold">s</span><a id="Toc211780948"></a><a id="Toc211781074"></a><span style="font-weight:bold">tart</span> — Worker Method</h3>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This method implements the </span><span class="FirstEmphasis">start</span><span style="font-size:16.0px"> control operation as defined in the </span>CDG<span style="font-size:16.0px"> and is optional.  Upon successful completion, the worker is in the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">operating</span><span style="font-size:16.0px"> state or the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">finished</span><span style="font-size:16.0px"> state.  This operation is called for the first time after initialization after initial property settings are done.  It may also be called after a successful </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">stop</span><span style="font-size:16.0px"> operation, to </span><span style="font-style:italic;font-size:16.0px">resume</span><span style="font-size:16.0px"> execution.</span></p>
    <h4 dir="ltr" id="toc25"><span class="SectionNumber">4.2.5.1 </span><a id="Toc211781075"></a><a id="RefHeading10664140039662"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult start(RCCWorker *self);  // C language<br />RCCResult start();                        // C++ language</p>
    <h4 dir="ltr" id="toc26"><span class="SectionNumber">4.2.5.2 </span><a id="Toc211781076"></a><a id="RefHeading10666140039662"></a>Returns</h4>
    <p class="Body" dir="ltr">This method shall return a <span class="Code">RCCResult</span> value.</p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">If the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">start</span><span style="font-size:16.0px"> method cannot succeed, it shall return </span><span class="Code">RCC_ERROR</span><span style="font-size:16.0px">.  If the worker detects an error that would disable the implementation or its environment, it shall return </span><span class="Code">RCC_FATAL</span><span style="font-size:16.0px">.  It shall return </span><span class="Code">RCC_DONE</span><span style="font-size:16.0px"> if no worker execution should proceed, to indicate that it is entering the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">finished</span><span style="font-size:16.0px"> state.  Otherwise it shall return </span><span class="Code">RCC_OK</span><span style="font-size:16.0px"> if normal worker execution should proceed.</span></p>
    <p class="Body" dir="ltr">Returning <span class="Code">RCC_DONE</span> indicates to the container that the worker will never require further execution, and provides this advice to the container to allow the container to take advantage of this fact and possibly release resources (such as I/O buffers) prior to the worker instance being destroyed or reused.</p>
    <h3 dir="ltr" id="toc27"><span class="SectionNumber">4.2.6 </span><a id="RefHeading10584140039662"></a><span style="font-weight:bold">s</span><a id="Toc211780949"></a><a id="Toc211781078"></a><span style="font-weight:bold">top</span> — Worker Method</h3>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This method implements the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">stop</span><span style="font-size:16.0px"> control operation as described in the </span>CDG<span style="font-size:16.0px">.  Upon successful completion, the worker is in the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">suspended</span><span style="font-size:16.0px"> state.  It will be also called before the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">release</span><span style="font-size:16.0px"> method, and before destruction, if the worker is in the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">operating</span><span style="font-size:16.0px"> state.</span></p>
    <h4 dir="ltr" id="toc28"><span class="SectionNumber">4.2.6.1 </span><a id="Toc211781079"></a><a id="RefHeading10668140039662"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult stop(RCCWorker *self);  // C language<br />RCCResult stop();                        // C++ language</p>
    <h4 dir="ltr" id="toc29"><span class="SectionNumber">4.2.6.2 </span><a id="Toc211781080"></a><a id="RefHeading10670140039662"></a>Returns</h4>
    <p class="Body" dir="ltr">This method shall return a <span class="Code">RCCResult</span> value.</p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">If the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">stop</span><span style="font-size:16.0px"> method cannot succeed, it shall return </span><span class="Code">RCC_ERROR</span><span style="font-size:16.0px">.  If the worker detects an error that would disable the implementation or its environment, it shall return </span><span class="Code">RCC_FATAL</span><span style="font-size:16.0px">.  Otherwise it shall return </span><span class="Code">RCC_OK</span><span style="font-size:16.0px">.</span></p>
    <h3 dir="ltr" id="toc30"><span class="SectionNumber">4.2.7 </span><a id="RefHeading10586140039662"></a><span style="font-weight:bold">r</span><a id="Toc211780950"></a><a id="Toc211781082"></a><span style="font-weight:bold">elease</span> — Worker Method</h3>
    <p class="Textbodyindent" dir="ltr" style="font-family:Arial,sans-serif"><span style="font-size:16.0px">This method implements the </span><span class="FirstEmphasis">release</span><span style="font-size:16.0px"> control operation as described in the </span>CDG<span style="font-size:16.0px">.  After successful completion, the worker instance is in the </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">exists</span><span style="font-size:16.0px"> state.  This method is needed when there are resources allocated by the worker in any other worker methods, such as heap allocations or file handles.</span></p>
    <h4 dir="ltr" id="toc31"><span class="SectionNumber">4.2.7.1 </span><a id="RefHeading10672140039662"></a><a id="Toc211781083"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult release(RCCWorker *self);  // C language<br />RCCResult release();                        // C++ language</p>
    <h4 dir="ltr" id="toc32"><span class="SectionNumber">4.2.7.2 </span><a id="RefHeading10674140039662"></a><a id="Toc211781084"></a>Returns</h4>
    <p class="Body" dir="ltr">This method shall return a <span class="Code">RCCResult</span> value.</p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">If the </span><span style="font-style:italic;font-size:16.0px">release</span><span style="font-size:16.0px"> method cannot succeed, it shall return </span><span class="Code">RCC_ERROR</span><span style="font-size:16.0px">.  If the worker detects an error that would disable the implementation or its environment, or it is unable to return resources it allocated, it shall return </span><span class="Code">RCC_FATAL</span><span style="font-size:16.0px">.  Otherwise it shall return </span><span class="Code">RCC_OK</span><span style="font-size:16.0px">.</span></p>
    <h3 dir="ltr" id="toc33"><span class="SectionNumber">4.2.8 </span><a id="RefHeading10588140039662"></a><span style="font-weight:bold">a</span><a id="Toc211780951"></a><a id="Toc211781086"></a><span style="font-weight:bold">fterConfigure</span> — Worker Method</h3>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This optional method implements the </span><span class="FirstEmphasis">afterConfigure</span><span style="font-size:16.0px"> control operation.  It may be called by control software after properties have been changed that have been specified in the OWD as requiring synchronization with the worker (using the </span><span class="Code">writeSync</span><span style="font-size:16.0px"> attribute).</span></p>
    <h4 dir="ltr" id="toc34"><span class="SectionNumber">4.2.8.1 </span><a id="Toc211781087"></a><a id="RefHeading10676140039662"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult afterConfigure(RCCWorker* self);  // C language<br />RCCResult afterConfigure();                        // C++ language</p>
    <h4 dir="ltr" id="toc35"><span class="SectionNumber">4.2.8.2 </span><a id="RefHeading10678140039662"></a><a id="Toc211781088"></a>Returns</h4>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This method shall return a </span><span class="Code">RCC<span style="font-style:normal">Result</span></span><span style="font-style:normal;font-size:16.0px"> </span><span style="font-size:16.0px">value.</span></p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">If the </span><span class="FirstEmphasis">afterConfigure</span><span style="font-size:16.0px"> method cannot succeed, it shall return </span><span class="Code">RCC_ERROR</span><span style="font-size:16.0px">.  If the worker detects an error that would disable the implementation or its environment, it shall return </span><span class="Code">RCC_FATAL</span><span style="font-size:16.0px">.  Otherwise it shall return </span><span class="Code">RCC_OK</span><span style="font-size:16.0px">.</span></p>
    <h3 dir="ltr" id="toc36"><span class="SectionNumber">4.2.9 </span><a id="RefHeading10590140039662"></a><span style="font-weight:bold">b</span><a id="Toc211780952"></a><a id="Toc211781090"></a><span style="font-weight:bold">eforeQuery</span> — Worker Method</h3>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">This optional method implements the </span><span class="FirstEmphasis">beforeQuery</span><span style="font-size:16.0px"> control operation.  It may be called by control software before properties have been accessed that have been specified in the OWD as requiring synchronization with the worker (using the </span><span class="Code">readSync</span><span style="font-size:16.0px"> attribute).</span></p>
    <h4 dir="ltr" id="toc37"><span class="SectionNumber">4.2.9.1 </span><a id="Toc211781091"></a><a id="RefHeading10680140039662"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult beforeQuery(RCCWorker *self);  // C language<br />RCCResult beforeQuery();                        // C++ language</p>
    <h4 dir="ltr" id="toc38"><span class="SectionNumber">4.2.9.2 </span><a id="Toc211781092"></a><a id="RefHeading10682140039662"></a>Returns</h4>
    <p class="Body" dir="ltr">This method shall return a <span class="Code">RCCResult</span> value.</p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">If the </span><span class="FirstEmphasis">beforeQuery</span><span style="font-size:16.0px"> method cannot succeed, it shall return </span><span class="Code">RCC_ERROR</span><span style="font-size:16.0px">.  If the worker detects an error that would disable the implementation or its environment, it shall return </span><span class="Code">RCC_FATAL</span><span style="font-size:16.0px">.  Otherwise it shall return </span><span class="Code">RCC_OK</span><span style="font-size:16.0px">.</span></p>
    <h3 dir="ltr" id="toc39"><span class="SectionNumber">4.2.10 </span><a id="RefHeadingToc723921944612760"></a><span style="font-weight:bold">r</span><a id="Toc211780953"></a><a id="Toc211781094"></a><span style="font-weight:bold">un</span><a id="RefHeading10684140039662"></a> — Worker Method</h3>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">The </span><span style="font-style:italic;font-weight:bold;font-size:16.0px">run</span><span style="font-size:16.0px"> method requests that the worker perform its normal computation.  The container only calls this method when the worker’s </span><span style="font-style:italic;font-size:16.0px">run condition</span><span style="font-size:16.0px"> is satisfied.</span></p>
    <h4 dir="ltr" id="toc40"><span class="SectionNumber">4.2.10.1 </span><a id="RefHeading10686140039662"></a><a id="Toc211781096"></a>Synopsis</h4>
    <p class="Code" dir="ltr">static RCCResult run(RCCWorker *self,<br />                     RCCBoolean timedOut,<br />                     RCCBoolean *newRunCondition);  // C language<br />RCCResult run(bool timedOut);                       // C++ langauge</p>
    <h4 dir="ltr" id="toc41"><span class="SectionNumber">4.2.10.2 </span><a id="RefHeading10688140039662"></a><a id="Toc211781097"></a>Behavior</h4>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">The </span><span class="FirstEmphasis">run</span><span style="font-size:16.0px"> method shall perform the worker's computational function and return a result.  Th</span><span style="font-style:normal;font-size:16.0px">is</span><span style="font-size:16.0px"> method may use information in its property structure, the state of its ports, and its requested local and global/persistent member data to decide what to do.  When there are data ports, this typically involves using messages in buffers at input ports to produce messages in buffers at output ports.</span></p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">The </span><span class="Code"><span style="font-style:normal">timedOut</span></span><span style="font-size:16.0px"> input argument indicates whether the </span><span class="FirstEmphasis">run</span><span style="font-size:16.0px"> method is being invoked due to time passing (the </span><span class="Code"><span style="font-style:normal">usecs</span></span><span style="font-size:16.0px"> value of the run condition).  This indication is independent of port readiness other than indicating that the run condition was </span><span style="font-style:italic;font-size:16.0px">not</span><span style="font-size:16.0px"> met.</span></p>
    <p class="Body" dir="ltr"><span style="font-style:italic;font-weight:bold;font-size:16.0px">C Language:</span><span style="font-size:16.0px">  Each port's </span><span class="Code">current.data</span><span style="font-size:16.0px"> member</span><span style="font-style:italic;font-size:16.0px"> </span><span style="font-size:16.0px">may be tested to indicate port readiness if that port is </span><span style="font-style:italic;font-size:16.0px">not</span><span style="font-size:16.0px"> included in the run condition.</span></p>
    <p class="Body" dir="ltr"><span style="font-style:italic;font-weight:bold;font-size:16.0px">C++ Language:</span><span style="font-size:16.0px">  Each port is a member data object whose name is the name of the port.  The </span><span class="Code">hasBuffer()</span><span style="font-size:16.0px"> method on that port object (e.g. </span><span class="Code">indata.hasBuffer()</span><span style="font-size:16.0px">), returns whether the port is ready.</span></p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">Normally this test is unnecessary since the container only calls this </span><span class="Code">run</span><span style="font-size:16.0px"> method when the run condition is satisfied, and that implies that all ports included in the run condition have buffers and are </span><span style="font-style:italic;font-size:16.0px">ready</span><span style="font-size:16.0px">.</span></p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">The </span><span class="FirstEmphasis">run</span><span style="font-size:16.0px"> method can indicate that all ports should be advanced by the special return value </span><span class="Code">RCC_ADVANCE.</span><span style="font-size:16.0px">  It can also indicate disposition of buffers and ports by using the </span><span style="font-weight:bold;font-size:16.0px">release</span><span style="font-size:16.0px">, </span><span style="font-weight:bold;font-size:16.0px">send</span><span style="font-size:16.0px">, </span><span style="font-weight:bold;font-size:16.0px">request</span><span style="font-size:16.0px">, </span><span style="font-weight:bold;font-size:16.0px">take</span><span style="font-size:16.0px">, or </span><span style="font-weight:bold;font-size:16.0px">advance</span><span style="font-size:16.0px"> container methods.</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-style:italic;font-weight:bold;font-size:16.0px">C Language:</span><span style="font-family:Arial,sans-serif;font-size:16.0px">  The </span><span style="font-family:Arial,sans-serif;font-style:italic;font-weight:bold;font-size:16.0px">run</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> method may change the run condition by setting a TRUE value to the location indicated by the </span><span class="Code">newRunCondition</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> output argument, and setting a pointer to a new run condition in the </span><span class="Code">runCondition</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> member of </span><span class="Code">RCCWorker</span><span style="font-family:Arial,sans-serif;font-size:16.0px">.  The </span><span class="Code">runCondition</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> member of </span><span class="Code">RCCWorker</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is initially set to the value in the </span><span class="Code">RCCDispatch</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> structure (including </span><span class="Code">NULL</span> to indicate the default run condition<span style="font-family:Arial,sans-serif;font-size:16.0px">).</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-style:italic;font-weight:bold;font-size:16.0px">C++ Language:</span><span style="font-family:Arial,sans-serif;font-size:16.0px">  The </span><span style="font-family:Arial,sans-serif;font-style:italic;font-weight:bold;font-size:16.0px">run</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> method may change the run condition using the </span><span class="Code">setRunCondition</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> container method passing a pointer to a (not </span><span style="font-family:Arial,sans-serif;font-style:italic;font-size:16.0px">const</span><span style="font-family:Arial,sans-serif;font-size:16.0px">) new run condition object.  The current run condition (pointer) is retrieved using the </span><span class="Code">getRunCondition()</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> method.  The run condition for a worker is initially set to the default, which is retrieved as </span><span class="Code">NULL</span><span style="font-family:Arial,sans-serif;font-size:16.0px">.</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-size:16.0px">If the </span><span class="Code">runCondition</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is set to </span><span class="Code">NULL</span><span style="font-family:Arial,sans-serif;font-size:16.0px">, the default run condition is restored.  The run condition for a worker is initially set to the default.  Since the worker code is managing the run conditions (passed by pointer), it can use it as a convenient “state variable” when its execution modes each have a different run condition.</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-size:16.0px">Code in the </span><span class="FirstEmphasis">run</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> method accesses information about ports and current buffers by accessing objects/structures that are ports in the Worker object.</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-style:italic;font-weight:bold;font-size:16.0px">C Language:  </span><span style="font-family:Arial,sans-serif;font-size:16.0px">The </span><span class="FirstEmphasis">run</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> method accesses information about current buffers through members of each port's </span><span class="Code">RCCPort</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> structure member in the </span><span class="Code">ports</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> array in the </span><span class="Code">RCCWorker</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> structure (e.g. </span><span class="Code">self-&gt;ports[n]</span><span style="font-family:Arial,sans-serif;font-size:16.0px">, where </span><span class="Code">n</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is the ordinal for the port).  The </span><span class="Code">current.data</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> member is the pointer to the message data for both input and output ports.  For input ports, the </span><span class="Code">input.length</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> structure member of the </span><span class="Code">RCCPort</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is the length of bytes of the message in the current buffer, and </span><span class="Code">input.u.operation</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is the opcode for the current input message.  For output ports, the </span><span class="Code">output.length</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is the length of bytes of the message in the current buffer, and </span><span class="Code">output.u.operation</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> is the opcode for the current output message.</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-style:italic;font-weight:bold;font-size:16.0px">C++ Language:</span><span style="font-family:Arial,sans-serif;font-size:16.0px">  The </span><span class="FirstEmphasis">run</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> method accesses port status and buffer contents using the worker's object port data member methods.</span></p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,sans-serif;font-size:16.0px">If a port is in the worker’s run condition, then it can assume a current buffer is present at that port when the run method is entered.  If not, the worker can test whether there is a current buffer; in C, the port's </span><span class="Code">current.data</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> member is non-</span><span class="Code">NULL</span><span style="font-family:Arial,sans-serif;font-size:16.0px">, in C++, the port's </span><span class="Code">hasBuffer()</span><span style="font-family:Arial,sans-serif;font-size:16.0px"> returns true.</span></p>
    <p class="Body" dir="ltr" style="font-family:Arial,sans-serif;font-size:16.0px">See the <a class="Internet20link"><span style="font-weight:bold">port management</span></a> and <a class="Internet20link"><span style="font-weight:bold">buffer management</span></a> sections below for container methods and port data members used to process input messages and create output messages.</p>
    <h4 dir="ltr" id="toc42"><span class="SectionNumber">4.2.10.3 </span><a id="Toc211781098"></a><a id="RefHeading10690140039662"></a>Returns</h4>
    <p class="Body" dir="ltr">This method shall return a <span class="Code">RCCResult</span> value.</p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">The value </span><span class="Code">RCC_ADVANCE</span><span style="font-size:16.0px"> indicates that all ports should be advanced that were ready on entry to the </span><span class="FirstEmphasis">run</span><span style="font-size:16.0px"> method and were not subject to container methods called since then (e.g. advance, request etc. described below).</span></p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">If the </span><span class="FirstEmphasis">run</span><span style="font-size:16.0px"> method cannot succeed, it should return </span><span class="Code">RCC_ERROR</span><span style="font-size:16.0px">, indicating that it should not be called again (regardless of run condition).  If the worker detects an error that would disable the implementation or its environment, it should return </span><span class="Code">RCC_FATAL</span><span style="font-size:16.0px">.  Otherwise it should return </span><span class="Code">RCC_OK</span><span style="font-size:16.0px"> or </span><span class="Code">RCC_ADVANCE</span><span style="font-size:16.0px"> if normal worker execution should proceed (the </span><span style="font-style:italic;font-size:16.0px">run</span><span style="font-size:16.0px"> method will be called again when the run condition is true).</span></p>
    <p class="Body" dir="ltr">The run method should return <span class="Code">RCC_DONE</span> if no further worker execution should happen.  Returning <span class="Code">RCC_DONE</span> indicates to the container that the worker will never require further execution.  Providing this advice to the container allows it to take advantage of this fact and possibly release resources (such as I/O buffers) prior to the worker instance being destroyed or reused.  Any messages remaining in input buffers will not be processed and may be discarded.</p>
    <p class="Body" dir="ltr">Returning <span class="Code">RCC_ADVANCE_DONE</span> combines the meaning of <span class="Code">RCC_ADVANCE</span> and <span class="Code">RCC_DONE</span>.</p>
    <h2 dir="ltr" id="toc43" style="page-break-before:always;font-style:italic;font-weight:bold"><span class="SectionNumber">4.3 </span><a id="RefHeading10596140039662"></a><a id="Toc270018433"></a>Container Methods, Called by the Worker.</h2>
    <p class="Body" dir="ltr">These methods are what a worker calls to invoke functionality provided by the container.   The container methods are in three categories:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">container scope (this section), </p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">port scope (next section) </p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">buffer scope (following section).</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The use of all container methods is optional, and typically unneeded for simple workers that only use run conditions and the <span class="FirstEmphasis">run</span> method.  When used these provide additional flexibility and functionality in message handling.</p>
    <p class="Body" dir="ltr" style="font-weight:normal"><span style="font-style:italic">All container methods are non-blocking</span>.</p>
    <p class="Body" dir="ltr"><span style="font-style:italic;font-weight:bold">C Language:</span>  container methods are accessed using function pointer members in the container structure member of the <span class="Code">RCCWorker</span> structure, e.g.:</p>
    <p class="Code" dir="ltr">self-&gt;container.setError(...)</p>
    <p class="Body" dir="ltr"><span style="font-style:italic;font-weight:bold">C++ Language:</span>  container methods exist in an accessible base class for the worker and are called directly.  Container methods relating to ports and buffers are methods of the worker's member data objects for ports, rather than on the worker (or container) objects.</p>
    <h3 dir="ltr" id="toc44"><span class="SectionNumber">4.3.1 </span><a id="RefHeadingToc53201067000368"></a><span style="font-weight:bold">t</span><a id="Toc270018435"></a><span style="font-weight:bold">ime/getTime</span> — Container Method</h3>
    <p class="Body" dir="ltr">This method is used by the worker to retrieve the time of day as a 64 bit unsigned number that represents GPS time in units of 2^-32 seconds (~233 ps).  The most significant 32 bits represent GPS time in seconds.  The accuracy of this time is dependent on the container implementation.</p>
    <p class="Body" dir="ltr">Note that GPS time is monotonic, as opposed to UTC time (the POSIX standard), which is subject to leap seconds etc.</p>
    <h4 dir="ltr" id="toc45"><span class="SectionNumber">4.3.1.1 </span><a id="RefHeading10700140039662"></a>Synopsis</h4>
    <p class="Code" dir="ltr">RCCTime (*time)();  // C Language<br />RCCTime getTime();  // C++ Language</p>
    <h4 dir="ltr" id="toc46"><span class="SectionNumber">4.3.1.2 </span><a id="RefHeading10702140039662"></a>Returns</h4>
    <p class="Textbodyindent" dir="ltr">This function returns GPS time in units of 2^-32 seconds.</p>
    <h3 dir="ltr" id="toc47"><span class="SectionNumber">4.3.2 </span><a id="RefHeadingToc53221067000368"></a><a id="Toc270018434"></a><span style="font-weight:bold">setError</span> — Container Method</h3>
    <p class="Body" dir="ltr">This method is used by the worker to convey an error message associated with returning <span class="Code">RCC_ERROR</span> or <span class="Code">RCC_FATAL</span>.  It has semantics similar to printf.</p>
    <h4 dir="ltr" id="toc48"><span class="SectionNumber">4.3.2.1 </span><a id="RefHeading10696140039662"></a>Synopsis</h4>
    <p class="Code" dir="ltr">RCCResult (*setError)(const char *fmt, …);  // C Language<br />RCCResult setError(const char *fmt, …);     // C++ Language</p>
    <h4 dir="ltr" id="toc49"><span class="SectionNumber">4.3.2.2 </span><a id="RefHeading10698140039662"></a>Returns</h4>
    <p class="Body" dir="ltr">This function returns <span class="Code">RCC_ERROR</span>, which allows a worker to simultaneously set the error and return the error indication.  For example, a worker method could have (in C):</p>
    <p class="Code" dir="ltr">if (some error condition)<br />  return self-&gt;container.setError(“Failure due to %d”, arg);</p>
    <p class="Body" dir="ltr">Or, in C++:</p>
    <p class="Code" dir="ltr">if (some error condition)<br />  return setError(“Failure due to %d”, arg);</p>
    <p class="Body" dir="ltr">If the worker must be return <span class="Code">RCC_FATAL</span>, it must call this function separate from returning that value.</p>
    <h3 dir="ltr" id="toc50"><span class="SectionNumber">4.3.3 </span><a id="RefHeadingToc53281067000368"></a>The <span style="font-weight:bold">RCC::RunCondition</span> C++ Class</h3>
    <p class="Body" dir="ltr">The <span class="Code">RCC::RunCondition</span> type represents the run conditions described above, and holds the information used by the container to determine when it is appropriate to invoke the <span class="Code">run</span> operation of a worker.  It is a C++ Struct, with convenience constructors.  The defined members are always written by the worker, and never by the container.  The following table describes the accessible members of the RunCondition structure.</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a>:  RunCondition Members</p>
    <table cellspacing="0" dir="ltr" id="Table3table" style="margin-top:0;margin-bottom:0;margin-left:0;margin-right:auto;width:631.6704px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:79.6px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Member Name</p>
          </td>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:91.8016px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px"><span style="font-weight:bold">Member</span><br /><span style="font-weight:bold">Data Type</span></p>
          </td>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:411.0688px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px"><span style="font-weight:bold">Member</span><br /><span style="font-weight:bold">Description</span></p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:79.6px">
            <p class="TableCode" dir="ltr">portMasks</p>
          </td>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:91.8016px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">RCCPortMask *</p>
          </td>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:411.0688px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">A pointer to a zero-terminated array of port masks, each of which indicates a bit-mask of port readiness.  The run condition is considered <span style="font-style:italic">true</span> when any of the masks is true.  A mask is <span style="font-style:italic">true</span> when all indicated ports are ready (logical AND of port readiness).  A port is indicated by its bit being set (1 &lt;&lt; port_ordinal).  If the pointer itself is <span class="Code">NULL</span>, the run condition is always true.  A bit set for an unconnected port is ignored, the default run condition can be used with unconnected ports.</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:79.6px">
            <p class="TableCode" dir="ltr">timeout</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:91.8016px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">bool</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:411.0688px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Indicates that the <span style="font-style:italic;font-weight:bold">usecs</span> member determines when enough time has passed to make the run condition true.  This value is used to enable or disable the timeout, without changing <span style="font-style:italic">usecs</span>.</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:79.6px">
            <p class="TableCode" dir="ltr">usecs</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:91.8016px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">uint32_t</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:411.0688px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">If this amount of time has passed (in microseconds) since the run method was last <span style="font-style:italic">entered</span>, the run condition is true.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Body" dir="ltr">The overall run condition is the logical OR of the <span class="Code">portMasks</span> and the timeout.  If the worker offers no <span class="Code">run</span> method in its RCCDispatch structure (see below), run conditions are ignored.  If the <span class="Code">portMasks</span> member is <span class="Code">NULL</span>, it indicates that no port readiness check is performed and the run condition is always true.  Typical combinations are:</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a>:  Run Condition Combinations</p>
    <table cellspacing="0" dir="ltr" id="Table6table" style="margin-top:0;margin-bottom:0;margin-left:0;margin-right:auto;width:629.73114px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:79.6px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Shorthand</p>
          </td>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:139.80157px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Port mask</p>
          </td>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:55.1968px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Timeout</p>
          </td>
          <td dir="ltr" style="border-top:1.0px solid #000001;border-bottom:4.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:289.5328px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">RunCondition Description</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:79.6px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Always run</p>
          </td>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:139.80157px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">portMasks == NULL</p>
          </td>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:55.1968px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">ignored</p>
          </td>
          <td dir="ltr" style="border-top:4.0px solid #000001;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:289.5328px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">the worker is always ready, no timeout</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:79.6px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Run when data ports are ready</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:139.80157px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">portMasks != NULL</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:55.1968px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">False</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:289.5328px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Run condition is TRUE when any mask is true.  If there are no masks (portMasks[0] == 0), then the run condition is always false.</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:79.6px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Run when data ports are ready or timeout.</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:139.80157px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">portMasks != NULL<br />and portMasks[0] != 0 </p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:55.1968px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">True</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:289.5328px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Run condition is TRUE when any mask is true OR if the timeout expires.  The timeout will take effect if time passes without the masks being satisfied.</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:79.6px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-weight:bold;font-size:14.666667px">Periodic execution</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:139.80157px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">portMasks != NULL<br />and portMasks[0] == 0</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:55.1968px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">True</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;background-color:transparent;vertical-align:top;width:289.5328px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Since portMasks[0] == 0, port masks can never be true, thus this establishes period execution independent of port readiness.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Body" dir="ltr">The RunCondition structure is defined with public members as defined above, and several convenience constructors:</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a>:  RunCondition Constructors</p>
    <table cellspacing="0" dir="ltr" id="Table8table" style="margin-top:0;margin-bottom:0;margin-left:0;margin-right:auto;width:583.6704px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:223.6px">
            <p class="TableCode" dir="ltr">RunCondition()</p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:327.2704px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Specify the default run condition, no timeout, all connected ports must be ready</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:223.6px">
            <p class="TableCode" dir="ltr"><span style="font-family:&apos;Courier New&apos;,serif;font-weight:bold">RunCondition</span><br /><span style="font-family:&apos;Courier New&apos;,serif;font-weight:bold"> (RCC::PortMask first, …)</span></p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:327.2704px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Specify a list of port masks as variable arguments that are a zero terminated list of masks</p>
          </td>
        </tr>
        <tr>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:223.6px">
            <p class="TableCode" dir="ltr"><span style="font-family:&apos;Courier New&apos;,serif;font-weight:bold">RunCondition</span><br /><span style="font-family:&apos;Courier New&apos;,serif;font-weight:bold"> (RCC::PortMask *masks,</span><br /><span style="font-family:&apos;Courier New&apos;,serif;font-weight:bold">  uint32_t usecs = 0,</span><br /><span style="font-family:&apos;Courier New&apos;,serif;font-weight:bold">  bool timeout = false)</span></p>
          </td>
          <td dir="ltr" style="border:1.0px solid #000001;padding-top:0;padding-bottom:0;padding-left:7.2000003px;padding-right:7.2000003px;vertical-align:top;width:327.2704px">
            <p class="Standard" dir="ltr" style="margin-left:0;margin-right:0;margin-top:6.6528006px;margin-bottom:5.328px;text-indent:0;text-align:left;font-size:14.666667px">Specify all fields, with defaults for timeout.  RunCondition(<span class="Code">NULL</span>) indicates: <span style="font-style:italic">always run</span>.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Body" dir="ltr">A C++ worker that uses these <span class="Code">RunCondition</span> objects typically declares them as member data objects that can be conveniently configured in member initializers in the worker's constructor.  For example:</p>
    <p class="Code" dir="ltr">class XyzWorker : public XyzWorkerBase {<br />  RunCondition m_aRunCondition;<br />  XyzWorker() : m_aRunCondition(1 &lt;&lt; Xyz_Inport, 0) {<br />  }<br />  RCCResult run(bool timedOut) {<br />    if (need_to_change_run_condition)<br />      setRunCondition(&amp;m_aRunCondition);<br />    else if (need_default_run_condition)<br />      setRunCondition(NULL);<br />  }<br />}</p>
    <h3 dir="ltr" id="toc51"><span class="SectionNumber">4.3.4 </span><a id="RefHeadingToc53241067000368"></a><span style="font-weight:bold">getRunCondition</span> — Container Method — C++ Language Only</h3>
    <p class="Body" dir="ltr">This method is used by the worker to retrieve its current run condition.  If the current run condition is specified to be the default, <span class="Code">NULL</span> is returned.  Otherwise the pointer returned is the most recent one passed from the worker to the container in the setRunCondition method.</p>
    <h4 dir="ltr" id="toc52"><span class="SectionNumber">4.3.4.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">RCC::RunCondition *getRunCondition(); </p>
    <h4 dir="ltr" id="toc53"><span class="SectionNumber">4.3.4.2 </span>Returns</h4>
    <p class="Body" dir="ltr">This function returns a pointer to the run condition most recently set by the worker using the setRunCondition call, or NULL.</p>
    <h3 dir="ltr" id="toc54"><span class="SectionNumber">4.3.5 </span><a id="RefHeadingToc53261067000368"></a><span style="font-weight:bold">setRunCondition</span> — Container Method — C++ Language Only</h3>
    <p class="Body" dir="ltr">This container method is used by the worker to set a new run condition.  If the run condition supplied is <span class="Code">NULL</span>, the default run condition becomes active, which is to wait for all ports to be ready, with no timeout. If the worker needs to start execution with a non-default run condition, it can call this container method in its constructor, or in its <span class="Code">initialize</span> or <span class="Code">start</span> methods.</p>
    <h4 dir="ltr" id="toc55"><span class="SectionNumber">4.3.5.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void setRunCondition(RCC::RunCondition *rc);</p>
    <h4 dir="ltr" id="toc56"><span class="SectionNumber">4.3.5.2 </span>Returns</h4>
    <p class="Body" dir="ltr">No return value. </p>
    <h2 dir="ltr" id="toc57"><span class="SectionNumber">4.4 </span><a id="RefHeadingToc53301067000368"></a>Port Management Data Members and Methods</h2>
    <p class="Body" dir="ltr">This section describes port management methods.  The <span class="FirstEmphasis">current</span> buffer at a port is in fact part of the port object.  This means methods on the <span class="FirstEmphasis">current</span> buffer are in fact methods on the port itself.  Otherwise buffer methods are used on specific buffer objects.  Those are described in the next section.</p>
    <p class="Body" dir="ltr">In the C language, port management methods are directly accessed function pointer members in the <span class="Code">RCCWorker</span> data structure, like all container methods.  Each has a <span class="Code">RCCPort</span> pointer as an argument.</p>
    <p class="Body" dir="ltr">In C++, each port is a member data object (of the worker object) whose name is the name of port (from the OCS).  Where port management methods are methods on that object.</p>
    <p class="Body" dir="ltr">As an example, to <span style="font-style:italic">advance</span> a port in C, and optionally access the data of the now-current buffer, is below:</p>
    <p class="Code" dir="ltr">RCCPort *inport = &amp;self-&gt;ports[MY_IN_PORT];<br /><br />if (self-&gt;container.advance(inport)) {<br />  void *p = inport-&gt;current.data;<br />  ...<br />}</p>
    <p class="Body" dir="ltr">In C++ this would be:</p>
    <p class="Code" dir="ltr">if (inport.advance()) {<br />  void *p = inport.data();<br />  ...<br />}</p>
    <p class="Body" dir="ltr">Note that in C++, the current buffer object is <span style="font-style:italic">inherited</span> by the port object, so the port data member is the object used to access the current buffer's <span class="Code">data()</span> method.</p>
    <h3 dir="ltr" id="toc58"><span class="SectionNumber">4.4.1 </span><a id="RefHeadingToc53321067000368"></a><span style="font-weight:bold">advance</span> — Release Current Buffer, and Request Another</h3>
    <p class="Body" dir="ltr">This method releases the current buffer at a port, <span style="font-style:italic">and</span> requests that a new buffer be made available as the current buffer on the port.  This is a convenience/efficiency combination of the <span style="font-style:italic;font-weight:bold">release </span><span style="font-style:normal;font-weight:normal">(the current buffer)</span> and <span style="font-style:italic;font-weight:bold">request</span> (a new current buffer) methods described below.</p>
    <p class="Body" dir="ltr">An optional minimum size in bytes may be requested (0 is the default in C++, 0 can be supplied in C for no minimum size).</p>
    <h4 dir="ltr" id="toc59"><span class="SectionNumber">4.4.1.1 </span><a id="Toc2117810961111"></a>Synopsis</h4>
    <p class="Code" dir="ltr">RCCBoolean (*advance)(RCCPort *port, size_t minSize);  // C language<br />bool Port::advance(size_t minSize = 0);                // C++</p>
    <h4 dir="ltr" id="toc60"><span class="SectionNumber">4.4.1.2 </span>Returns</h4>
    <p class="Body" dir="ltr">A boolean value is returned indicating whether the <span style="font-style:italic;font-weight:bold">request</span> was immediately satisfied.</p>
    <h3 dir="ltr" id="toc61"><span class="SectionNumber">4.4.2 </span><a id="RefHeadingToc53421067000368"></a><span style="font-weight:bold">hasBuffer</span> — Query a Port for Whether It Has a Current Buffer-to-release</h3>
    <p class="Body" dir="ltr">This method returns whether a port has a current buffer.  If a port is already part of a workers's run condition, and it is in every port mask of the run condition, it can be assumed to have a current buffer whenever the worker is run.  This is the case for 90% of all workers.  This method is only needed and used when a port is not in the run condition, as might be the case for a port that received some exceptional condition message.</p>
    <p class="Body" dir="ltr">In C, this is a port structure member access.  In C++ it is a port method.</p>
    <h4 dir="ltr" id="toc62"><span class="SectionNumber">4.4.2.1 </span><a id="Toc2117810961147149150"></a>Synopsis</h4>
    <p class="Code" dir="ltr">Port-&gt;current.data != NULL        // C Language<br />bool RCCUserPort::hasBuffer();    // C++ Language</p>
    <h4 dir="ltr" id="toc63"><span class="SectionNumber">4.4.2.2 </span>Returns</h4>
    <p class="Body" dir="ltr">For C++, a <span class="Code">bool</span> value is returned indicating whether the port has a current buffer.</p>
    <h3 dir="ltr" id="toc64"><span class="SectionNumber">4.4.3 </span><a id="RefHeadingToc80371067000368"></a><span style="font-weight:bold">isConnected</span> — Query a Port for Being Connected</h3>
    <p class="Body" dir="ltr">This method returns whether a port is currently connected or not.  Component specifications (OCS) indicate whether each port of a component (and thus all workers) must be connected before workers are started or run.  A port is considered “optional” for a worker if the worker can tolerate the port <span style="font-style:italic">not</span> being connected.  If a port is <span style="font-style:italic">not</span> optional, the worker code can assume it is connected, and this method would not be needed or used.</p>
    <p class="Body" dir="ltr">In C, this is a Worker (self) structure member access.  In C++ it is a port method.</p>
    <h4 dir="ltr" id="toc65"><span class="SectionNumber">4.4.3.1 </span><a id="Toc2117810961147149"></a>Synopsis</h4>
    <p class="Code" dir="ltr">self-&gt;connectedPorts &amp; (1 &lt;&lt; PortOrdinal);  // C Language<br />bool RCCUserPort::isConnected();           // C++ Language</p>
    <h4 dir="ltr" id="toc66"><span class="SectionNumber">4.4.3.2 </span>Returns</h4>
    <p class="Body" dir="ltr">For C++, a bool value is returned indicating whether the port is connected.</p>
    <h3 dir="ltr" id="toc67"><span class="SectionNumber">4.4.4 </span><a id="RefHeadingToc53341067000368"></a><span style="font-weight:bold">request</span> — Request a New Buffer</h3>
    <p class="Body" dir="ltr">This method <span style="font-style:italic">requests</span> that a new buffer be made available as the current buffer on a port.  If the port already has a current buffer, the request is considered satisfied.  This request indicates to the container that it should make a buffer available when possible.  Without an explicit request, the container may not make a buffer available since that would dedicate resources when they may not be needed.  An implicit <span style="font-style:normal;font-weight:normal">request</span> is made for all ports that are part of the current run condition.</p>
    <p class="Body" dir="ltr">An optional minimum size may be requested.</p>
    <p class="Body" dir="ltr">Note that this method is not used or needed when ports are <span class="FirstEmphasis">advanced</span>, only when buffers are being explicitly managed (e.g. released, etc.).</p>
    <h4 dir="ltr" id="toc68"><span class="SectionNumber">4.4.4.1 </span><a id="Toc211781096111"></a>Synopsis</h4>
    <p class="Code" dir="ltr">RCCBoolean (*request)(RCCPort *port, size_t minSize); // C Language<br />bool <span style="font-style:italic">Port</span>(size_t minSize = 0);                        //C++ language</p>
    <h4 dir="ltr" id="toc69"><span class="SectionNumber">4.4.4.2 </span>Returns</h4>
    <p class="Body" dir="ltr">A boolean value is returned indicating whether the request was immediately satisfied.</p>
    <h3 dir="ltr" id="toc70"><span class="SectionNumber">4.4.5 </span><a id="RefHeadingToc53361067000368"></a><span style="font-weight:bold">send</span> — Send an Input Buffer on an Output Port</h3>
    <p class="Body" dir="ltr">This method sends an input buffer on an <span style="font-style:italic">output</span> port.  If the buffer is a current buffer for a port, this buffer will no longer be that port’s current buffer.  Buffer ownership passes back to the container.  This method is used to effect zero-copy transfer of a message from an input port to an output port.</p>
    <p class="Body" dir="ltr">C Language:  The operation and message length are supplied as arguments.</p>
    <p class="Body" dir="ltr">C++ Language:  The operation and message length are attributes of the buffer object and can be changed before it is sent using the <span class="Code">setOpCode</span> and/or <span class="Code">setLengt</span>h methods.</p>
    <p class="Body" dir="ltr">The sent buffer is either a current buffer of an input port or a buffer taken from an input port.</p>
    <h4 dir="ltr" id="toc71"><span class="SectionNumber">4.4.5.1 </span><a id="Toc21178109611"></a>Synopsis</h4>
    <p class="Code" dir="ltr">void (*send)(RCCPort* port,<br />             RCCBuffer* buffer,<br />             RCCOrdinal op,<br />             uint32_t length);           // C Language<br />void RCCPort::send(RCC::Buffer &amp;buffer); // C++ Language</p>
    <h4 dir="ltr" id="toc72"><span class="SectionNumber">4.4.5.2 </span>Returns</h4>
    <p class="Body" dir="ltr">Nothing is returned.</p>
    <h3 dir="ltr" id="toc73"><span class="SectionNumber">4.4.6 </span><a id="RefHeadingToc53481067000368"></a><span style="font-weight:bold">setDefaultLength</span> — Set the Default Message Length at an Output Port — C++ Language Only</h3>
    <p class="Body" dir="ltr">This method sets the default message length in bytes for a port.  It is useful when messages produced at a port will always be the same size.</p>
    <p class="Body" dir="ltr">This method is used only when the message content is manipulated as a raw untyped buffer, rather than using the message content access methods described below.</p>
    <p class="Body" dir="ltr">The initial setting of the default message length is the length of the buffer.</p>
    <p class="Body" dir="ltr">This method is only available in C++.</p>
    <h4 dir="ltr" id="toc74"><span class="SectionNumber">4.4.6.1 </span><a id="Toc2117810961147149150151152153"></a>Synopsis</h4>
    <p class="Code" dir="ltr">void RCCUserPort::setdefaultLength(size_t length);  // C++ Language</p>
    <h4 dir="ltr" id="toc75"><span class="SectionNumber">4.4.6.2 </span>Returns</h4>
    <p class="Body" dir="ltr">Nothing.</p>
    <h3 dir="ltr" id="toc76"><span class="SectionNumber">4.4.7 </span><a id="RefHeadingToc53501067000368"></a><span style="font-weight:bold">setDefaultOpCode</span> — Set Default Opcode at Output Port — C++ Language Only</h3>
    <p class="Body" dir="ltr">This method sets the default <span class="FirstEmphasis">opCode</span> for an output port.  It is useful when messages produced at a port will typically have the same opcode, among those defined in the protocol.</p>
    <p class="Body" dir="ltr">The initial setting of the default opcode is zero (indicating the first operation specified in the associated protocol).  Setting the default opCode does not prevent setting the opCode on a per-message basis at any time during execution.</p>
    <p class="Body" dir="ltr">This method is only available in C++.</p>
    <h4 dir="ltr" id="toc77"><span class="SectionNumber">4.4.7.1 </span><a id="Toc2117810961147149150151152153154"></a>Synopsis</h4>
    <p class="Code" dir="ltr">void RCCUserPort::setDefaultOpCode(RCCOpCode opcode); // C++ only</p>
    <h4 dir="ltr" id="toc78"><span class="SectionNumber">4.4.7.2 </span>Returns</h4>
    <p class="Body" dir="ltr">Nothing.</p>
    <h3 dir="ltr" id="toc79"><span class="SectionNumber">4.4.8 </span><a id="RefHeading87121123303156"></a><span style="font-weight:bold">take</span> — Take a Buffer from an Input Port</h3>
    <p class="Body" dir="ltr">This method <span style="font-style:italic">takes</span> the current buffer from a port, and optionally releases a previously taken buffer.  This method is used when workers need to maintain a history of one or more previous buffers while still requesting new buffers, e.g. for <span style="font-style:italic">sliding window</span> algorithms.</p>
    <p class="Body" dir="ltr">The optional buffer to be released is provided by a possibly <span class="Code">NULL</span> pointer to a buffer.  This buffer-to-release argument is a convenience feature of the API to allow cycling of buffers in a single call, e.g.:</p>
    <p class="Code" dir="ltr">class XyzWorker {<br />  RCCUserBuffer *m_prev;        // remember buff from previous run<br />  XyzWorker() : m_prev(NULL) {}<br />  void process_curr_and_prev(RCCUserBuffer *curr,<br />                             RCCUserBuffer *prev) {}<br />  run() {<br />    process_curr_and_prev(&amp;in, m_prev);<br />    m_prev = &amp;in.take(m_prev);<br />  }</p>
    <p class="Code" dir="ltr">}</p>
    <p class="Body" dir="ltr">In C, while we logically consider this a port method, it is actually a container method with three arguments:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">an <span class="Code">RCCPort</span> <span style="font-style:normal">pointer indicating the port from which the buffer is taken</span></p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">an <span class="Code">RCCBuffer</span> pointer indicating, if not NULL, a buffer to release</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">an <span class="Code">RCCBuffer</span> pointer as an output argument where the taken buffer structure will be copied (not the data, just the structure).</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">In C++, <span style="font-style:italic;font-weight:bold">take</span> is a port method with a single buffer-to-release argument and the taken buffer is simply returned via a reference.</p>
    <p class="Body" dir="ltr">Ownership of the taken buffer is passed to the worker.  The current buffer now taken is no longer the current buffer.  This method is used when the worker needs access to more than one buffer at a time from an input port.  <span style="font-style:italic;font-weight:bold">Take</span> implies a <span style="font-style:italic;font-weight:bold">request</span> (to get another current buffer).</p>
    <p class="Body" dir="ltr">It is an error to call this method when the port does not have a current buffer.</p>
    <h4 dir="ltr" id="toc80"><span class="SectionNumber">4.4.8.1 </span><a id="Toc21178109611111"></a>Synopsis</h4>
    <p class="Code" dir="ltr">void (*take)<br />  (RCCPort* port, RCCBuffer* releaseBuffer,<br />   RCCBuffer* takenBuffer);                // C language<br />RCCUserBuffer &amp;Port::take<br />  (RCCBuffer *release = NULL);             // C++ Language</p>
    <h4 dir="ltr" id="toc81"><span class="SectionNumber">4.4.8.2 </span>Returns</h4>
    <p class="Body" dir="ltr">Nothing is returned in C, since the taken buffer object is copied to the location supplied by the <span class="Code">takenBuffer</span> argument.  In C++, a reference to the taken buffer is returned.</p>
    <h2 dir="ltr" id="toc82"><span class="SectionNumber">4.5 </span><a id="RefHeadingToc53521067000368"></a>Buffer Management Data Members and Methods</h2>
    <p class="Standard" dir="ltr">This section describes methods that apply to buffers separate from ports.  As mentioned above, when a buffer is the current buffer at a port, the port object itself is normally used with these buffer methods.  In C++, the port object inherits the buffer object that is the current buffer.  In C, the current buffer is the <span class="Code">current</span> member of the RCCPort structure.</p>
    <p class="Standard" dir="ltr">When methods deal with <span style="font-style:italic;font-weight:bold">opCodes</span>, they are dealing with an ordinal for the message in a buffer.  The <span class="FirstEmphasis">opCode</span> identifies which type of message is in the buffer, among those defined by the protocol.  OpCode values are zero-origin in the order of how the operations are defined in the protocol (OPS) XML file.  Enumeration constants for the messages in a protocol are generated and are described in the <a class="Internet20link"><span style="font-weight:bold">code generation</span></a> section.</p>
    <p class="Standard" dir="ltr">In C++ buffer management is via buffer methods — member functions of buffer objects.  In C, buffer management is either via container methods or direct access to structure members.</p>
    <h3 dir="ltr" id="toc83"><span class="SectionNumber">4.5.1 </span><a id="RefHeadingToc80391067000368"></a><span style="font-weight:bold">checkLength</span> — Check Size of the Buffer — C++ Language Only</h3>
    <p class="Body" dir="ltr">Check that a message of a given size in bytes will fit into the buffer, usually associated with an output port.  An exception is thrown if the message will not fit.  This is useful when the worker is creating a variable length message and wants to ensure it will fit into the available buffer.  This check results in an error that the worker cannot check, and is intended to avoid unexpected buffer size mismatches, similar to the “assert” standard library function.</p>
    <p class="Body" dir="ltr"><a id="RefHeadingToc53461067000368"></a>This method is used only when the message content is manipulated as a raw untyped buffer, rather than using the message content access methods described below.</p>
    <p class="Body" dir="ltr">This method is only available in C++.</p>
    <h4 dir="ltr" id="toc84"><span class="SectionNumber">4.5.1.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void RCCUserPort::checkLength(size_t neededSize);  // C++ Language</p>
    <h4 dir="ltr" id="toc85"><span class="SectionNumber">4.5.1.2 </span><a id="Toc2117810961147149150151152"></a>Returns</h4>
    <p class="Standard" dir="ltr">Nothing.</p>
    <h3 dir="ltr" id="toc86"><span class="SectionNumber">4.5.2 </span><a id="RefHeadingToc80411067000368"></a><span style="font-weight:bold">data</span> — Access the Raw Contents of the Buffer</h3>
    <p class="Body" dir="ltr">This method returns a pointer to the raw data in a buffer.  It is analogous to the <span class="Code">data</span> method in C++ STL container classes, although it has no type.</p>
    <h4 dir="ltr" id="toc87"><span class="SectionNumber">4.5.2.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void *p = buffer-&gt;data;          // C Language<br />void *RCCUserBuffer::data();     // C++ Language</p>
    <h4 dir="ltr" id="toc88"><span class="SectionNumber">4.5.2.2 </span>Returns</h4>
    <p class="Standard" dir="ltr">The value returned is a void pointer to the contents of the buffer.</p>
    <h3 dir="ltr" id="toc89"><span class="SectionNumber">4.5.3 </span><a id="RefHeadingToc80431067000368"></a><span style="font-weight:bold">length</span> — Retrieve the Length of the Message in a Buffer – C++ Language Only</h3>
    <p class="Body" dir="ltr">This method returns the number of bytes of the message in the buffer, which is typically an input buffer.  This is C++ only.  When using C, access to the length is via the current buffer at a port, e.g. <span class="Code">port-&gt;input.length</span>.</p>
    <h4 dir="ltr" id="toc90"><span class="SectionNumber">4.5.3.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">size_t RCCUserBuffer::length() const;   // C++ Language</p>
    <h4 dir="ltr" id="toc91"><span class="SectionNumber">4.5.3.2 </span>Returns</h4>
    <p class="Standard" dir="ltr">The method returns the length in bytes of the message in the buffer.</p>
    <h3 dir="ltr" id="toc92"><span class="SectionNumber">4.5.4 </span><a id="RefHeadingToc80451067000368"></a><span style="font-weight:bold">maxLength</span> — Retrieve the Maximum Available Space in the Buffer.</h3>
    <p class="Body" dir="ltr">This method allows the worker to retrieve the actual size of the buffer, typically used on output buffers.</p>
    <h4 dir="ltr" id="toc93"><span class="SectionNumber">4.5.4.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">size_t len = buffer-&gt;maxLength;           // C language<br />size_t RCCUserBuffer::maxLength() const;  // C++ language</p>
    <h4 dir="ltr" id="toc94"><span class="SectionNumber">4.5.4.2 </span>Returns</h4>
    <p class="Standard" dir="ltr"><a id="Toc21178109611472"></a>The size of the buffer in bytes is returned.</p>
    <h3 dir="ltr" id="toc95"><span class="SectionNumber">4.5.5 </span><a id="RefHeadingToc80471067000368"></a><span style="font-weight:bold">opCode</span> — Retrieve the OpCode of the Message in a Buffer</h3>
    <p class="Body" dir="ltr">This method retrieves the <span style="font-style:italic">opCode</span> of the message in the buffer, typically an input buffer.    This is C++ only.  When using C, access to the opCode is via the current buffer at a port, e.g. <span class="Code">port-&gt;input.u.operation</span></p>
    <h4 dir="ltr" id="toc96"><span class="SectionNumber">4.5.5.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">RCCOpcode op = port-&gt;input.u.operation;       // C language<br />RCCOpCode RCCUserBuffer::opCode() const;     // C++ Language</p>
    <h4 dir="ltr" id="toc97"><span class="SectionNumber">4.5.5.2 </span>Returns</h4>
    <p class="Standard" dir="ltr"><a id="Toc21178109611474"></a>This method returns the opCode of the message in the buffer.</p>
    <h3 dir="ltr" id="toc98"><span class="SectionNumber">4.5.6 </span><a id="RefHeadingToc80491067000368"></a><span style="font-weight:bold">release</span> — Release a Buffer</h3>
    <p class="Body" dir="ltr">This method releases a buffer for reuse.  If the buffer is the current buffer for a port, it will no longer be the current buffer.  Buffer ownership passes back to the container.  Buffers for a port <span style="font-style:italic;font-weight:bold">must be released in the order obtained</span>, per port.  Note that this method is not used or needed when ports are “advanced”, only when buffers are obtained from a port using other port management functions such as <span class="FirstEmphasis">take</span>.</p>
    <p class="Body" dir="ltr">Releasing a current buffer does not imply requesting a new current buffer:  that request must be explicit.  A release without a request might be useful if a worker is entering a mode where it no longer needs any more data from an input port or it no longer needs to send any more buffers on an output port.</p>
    <p class="Body" dir="ltr">In C, this is a function with the buffer pointer as an argument, e.g. called using:</p>
    <p class="Code" dir="ltr">self-&gt;container.release(buffer);</p>
    <p class="Body" dir="ltr">  In C++ it is a buffer method invoked on the buffer object itself.</p>
    <h4 dir="ltr" id="toc99"><span class="SectionNumber">4.5.6.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void (*release)(RCCBuffer* buffer);  // C Language<br />void RCCUserBuffer::release();       // C++ Language</p>
    <h4 dir="ltr" id="toc100"><span class="SectionNumber">4.5.6.2 </span>Returns</h4>
    <p class="Standard" dir="ltr"><a id="Toc2117810961147"></a>Nothing.</p>
    <h3 dir="ltr" id="toc101"><span class="SectionNumber">4.5.7 </span><a id="RefHeadingToc80531067000368"></a><span style="font-weight:bold">setLength</span> — Set the Length of the Message in a Buffer — C++ Language Only</h3>
    <p class="Body" dir="ltr">This method sets the length in bytes of the message in a buffer.</p>
    <p class="Body" dir="ltr">This is C++ only.  When using C, access to the length of an output buffer is via the current buffer at a port, e.g. <span class="Code">port-&gt;output.u.length</span>, or via the <span class="Code">send</span> port method.</p>
    <h4 dir="ltr" id="toc102"><span class="SectionNumber">4.5.7.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void RCCUserBuffer::setLength(size_t length);       // C++ Language</p>
    <h4 dir="ltr" id="toc103"><span class="SectionNumber">4.5.7.2 </span>Returns</h4>
    <p class="Standard" dir="ltr">Nothing.</p>
    <h3 dir="ltr" id="toc104"><span class="SectionNumber">4.5.8 </span><a id="RefHeadingToc80551067000368"></a><span style="font-weight:bold">setOpCode</span> — Set the OpCode for the Message in a Buffer — C++ Language Only</h3>
    <p class="Body" dir="ltr">This method sets the opCode of the message in a buffer.</p>
    <p class="Body" dir="ltr">This is C++ only.  When using C, access to the opCode of an output buffer is via the current buffer at a port, e.g. <span class="Code">port-&gt;output.u.operation</span>, or via the <span class="Code">send</span> port method.</p>
    <h4 dir="ltr" id="toc105"><span class="SectionNumber">4.5.8.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void RCCUserBuffer::setOpCode(RCCOpCode op);      // C++ Language</p>
    <h4 dir="ltr" id="toc106"><span class="SectionNumber">4.5.8.2 </span>Returns</h4>
    <p class="Standard" dir="ltr">Nothing.</p>
    <h3 dir="ltr" id="toc107"><span class="SectionNumber">4.5.9 </span><a id="RefHeadingToc80511067000368"></a><span style="font-weight:bold">setInfo</span> — Set the Metadata Associated with a Buffer — C++ Language Only</h3>
    <p class="Body" dir="ltr">This method is a convenient combination of setting both the <span style="font-style:italic;font-weight:bold">opCode</span> and the <span style="font-style:italic;font-weight:bold">length</span> of the message in a buffer.  It is typically used on output buffers, when both opCode and length are being set at the same time.</p>
    <h4 dir="ltr" id="toc108"><span class="SectionNumber">4.5.9.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">void RCCUserBuffer::setInfo(RCCOpCode op, size_t length);  // C++</p>
    <h4 dir="ltr" id="toc109"><span class="SectionNumber">4.5.9.2 </span>Returns</h4>
    <p class="Standard" dir="ltr">Nothing.</p>
    <h3 dir="ltr" id="toc110"><span class="SectionNumber">4.5.10 </span><a id="RefHeadingToc80571067000368"></a><span style="font-weight:bold">topLength</span> — Retrieve the Size of the Single Sequence in a Message — C++ Language Only</h3>
    <p class="Body" dir="ltr" style="margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;background-color:transparent;text-indent:0;text-align:left">This method only applies to input buffers that contain messages consisting of a single sequence argument (as defined in the protocol).  It retrieves the length, <span style="font-style:italic">in elements</span>, of that sequence.  The <span class="Code">elemSize</span> argument to <span class="Code">topLength</span> is the size in bytes of the elements of the sequence in the buffer.  An error check is made to ensure that the size of the message in bytes is divisible by the <span class="Code">elemSize</span> value provided.</p>
    <p class="Body" dir="ltr" style="margin-left:0;margin-right:0;margin-top:7.6703997px;margin-bottom:5.7408px;background-color:transparent;text-indent:0;text-align:left">Normally, sequence lengths are retrieved using the message/operation access methods described below in the “accessing the contents of messages” section.  However, when message contents are accessed as an untyped raw buffer, this method allows the worker to retrieve the number of elements of a given size in the message without the container knowing the data type of the message.  It performs the size conversion and error check in one API.</p>
    <p class="Body" dir="ltr"><a id="RefHeadingToc53441067000368"></a>The message must consist of exactly one sequence for this method to be valid.  Sequences can have zero elements.</p>
    <p class="Body" dir="ltr">This method is only available in C++.</p>
    <h4 dir="ltr" id="toc111"><span class="SectionNumber">4.5.10.1 </span>Synopsis</h4>
    <p class="Code" dir="ltr">size_t RCCUserBuffer::topLength(size_t elemSize);  // C++ Language</p>
    <h4 dir="ltr" id="toc112"><span class="SectionNumber">4.5.10.2 </span><a id="Toc2117810961147149150151"></a>Returns</h4>
    <p class="Body" dir="ltr">For C++, this method returns a size_t value indicating the number of sequence elements in the message, given the size of elements known by the worker.</p>
    <h2 dir="ltr" id="toc113"><span class="SectionNumber">4.6 </span><a id="RefHeadingToc80591067000368"></a>Accessing the Contents of Messages</h2>
    <p class="Body" dir="ltr">The sections above described methods used to access the raw content and metadata (length and opCode) of messages in buffers.  Those methods operate independent of the actual types of the data in the messages, and put the burden of accessing typed data on the worker code.  I.e. the worker code would have to cast the pointer types and manually deal with the multiple data types for the arguments in a message.</p>
    <p class="Body" dir="ltr">Accessing the individual arguments (fields) in the payload for an input message (or setting the fields of an output message) is facilitated differently in C vs. C++.</p>
    <h3 dir="ltr" id="toc114"><span class="SectionNumber">4.6.1 </span><a id="RefHeadingToc36173549088399"></a>Accessing Messages in C Language Workers</h3>
    <p class="Body" dir="ltr">In C, data structures are generated that can be overlaid on buffers to access fields of a message up to and including the first variable length field (sequence or string).  Each port has a set of data structures defined for the messages that may be in its buffers.  These structures are described in the <a class="Internet20link"><span style="font-weight:bold">code generation</span></a> section, but the basic pattern, for worker WXY, port PXY, with protocol PRXY, with operations Op1 and Op2, is:</p>
    <p class="Code" dir="ltr">typedef struct {<br />  ... fields in the message for Op1 messages ...<br />} WxyPxyOp1;<br />typeded struct {<br />  ... fields in the message for Op2 messages ...<br />} WxyPxyOp2;</p>
    <p class="Body" dir="ltr">Note that the structure typedefs are CamelCase, the opcode enumeration values are upper case, and the structure members are the case of the argument names in the protocol.  In C, messages are accessed based on opCode like this:</p>
    <p class="Code" dir="ltr">switch (port-&gt;input.u.operation) {<br />case PRXY_OP1:<br />  {<br />    WxyPxyOp1 *p = port-&gt;current.data;<br />    // use p-&gt; to access the message structure<br />    break;<br />  }<br />case PRXY_OP2:<br />  {<br />    WxyPxyOp2 *p = port-&gt;current.data;<br />    // use p-&gt; to access the message structure<br />    break;<br />  }<br />}</p>
    <p class="Body" dir="ltr">If the messages are simply a sequence or array of one basic type (e.g. float), directly assigning the buffer pointer to that pointer type is sensible, e.g.:</p>
    <p class="Code" dir="ltr">switch (port-&gt;input.u.operation) {<br />case PRXY_OP1:<br />  {<br />    float *p = port-&gt;current.data;<br />    // use p-&gt; to access the message data<br />    break;<br />  }<br />...</p>
    <p class="Body" dir="ltr">The major limitation of this scheme is that the structures only cover the fields of messages up to and including the first variable length field.  After that, the worker must manually access the remaining fields using pointer arithmetic and casting.  This covers most protocols used in simple systems, but is painful when the limitation is exceeded.</p>
    <p class="Body" dir="ltr">A second limitation for C language workers is that there is no error checking that the correct message structure is being used with its corresponding opCode.</p>
    <h3 dir="ltr" id="toc115"><span class="SectionNumber">4.6.2 </span><a id="RefHeadingToc36175549088399"></a>Accessing Messages in C++ Language Workers</h3>
    <p class="Body" dir="ltr">C++ workers have data members for each port whose name is the port's name in the OCS.  Each such port data member has an accessor for the information for each possible message in the port's protocol.  Each field of the payload for each operation also has an accessor.  Accessing the <span class="Code">arg1</span> field of the <span class="Code">op1</span> operation message on the protocol for port <span class="Code">in</span>, would simply be:</p>
    <p class="Code" dir="ltr">in.op1().arg1()</p>
    <p class="Body" dir="ltr">These C++ message argument access methods return a <span class="Code">const</span> reference to the field for input ports, and return a non-<span class="Code">const</span> reference for output ports.  They will generate an exception if used when the message in the buffer has the wrong opCode for the operation accessor used.  E.g., if <span class="Code">in.op1()</span> is used when the current opcode is not <span class="Code">op1</span>, an exception occurs..  If the argument type was <span class="Code">float</span>, then the accessors defined for <span class="Code">in.op1()</span> would be:</p>
    <p class="Code" dir="ltr">const float &amp;arg1() const;  // for arguments in an input buffer<br />float &amp;arg1();              // for arguments in an output buffer</p>
    <p class="Body" dir="ltr">When the argument type is a sequence or array, the field accessor returns a reference to an <span style="font-style:italic">object</span> that has the following methods, which act like the same-named methods defined in the ISO C++ STL container types (assuming the data type is <span class="Code">float</span>):</p>
    <p class="Code" dir="ltr">const float *data() const; // pointer to access the floats on input<br />size_t size() const;       // number of floats available on input<br />float *data();             // pointer to access the floats on output<br />size_t resize(size_t n);   // to set the number of floats on output<br />size_t capacity() const;   // to get the available space on output</p>
    <p class="Body" dir="ltr">For arrays or sequences in output buffers, the <span class="Code">resize</span> method must be called for each message.</p>
    <p class="Body" dir="ltr">If <span class="Code">arg1</span> in the above example was a sequence of unsigned shorts, access to this field is:</p>
    <p class="Code" dir="ltr">uint16_t *vals = in.op1().arg1().data(); // pointer to data<br />size_t nvals = in.op1().arg1().size();   // number of elements</p>
    <h2 dir="ltr" id="toc116"><span class="SectionNumber">4.7 </span><a id="RefHeadingToc80611067000368"></a>How a Worker Accesses its Properties</h2>
    <h3 dir="ltr" id="toc117"><span class="SectionNumber">4.7.1 </span><a id="RefHeadingToc717231826048042"></a>The Worker Property Structure</h3>
    <p class="Standard" dir="ltr">A structure type (e.g. <span class="Code">XyzProperties</span>) is generated for the worker, and placed in the <span class="Code">gen/XYZ_Worker.h</span> (for C) or <span class="Code">gen/xyz-worker.hh</span> (for C++) file, and contains members for each property that is not a parameter.  Unless a property is defined as being <span class="Code">volatile</span>, its corresponding structure member is <span class="Code">const</span>.  Thus setting the value corresponding to a property <span style="font-style:italic">not</span> declared <span class="Code">volatile</span> will result in a compilation error.</p>
    <p class="Body" dir="ltr">The name of the structure type (<span class="Code">typedef</span> name in C) is <span class="Code">XyzProperties</span> where “Xyz” is the <span style="font-style:italic">capitalized</span> worker name.</p>
    <p class="Standard" dir="ltr">Properties that are scalar values (not sequences, arrays, structures or strings), are simple scalar structure members with the property's name.  Properties that are arrays are declared as such in this structure, including multi-dimensional arrays.  The structure member for properties that are sequences are themselves structures, with two members:  a <span class="Code">ulong length</span> member indicating the number of valid elements present, and a <span class="Code">data</span> member which is an array of the maximum number of elements declared for the property in the <span class="Code">sequenceLength</span> attribute that defines the property (its maximum number of elements).  Similarly, structure members for properties that are of type <span class="Code">string</span>, are arrays of type <span class="Code">char</span> of dimension <span class="Code">stringLength+1</span>, with the <span class="Code">+1</span> to leave room for the terminating zero.</p>
    <p class="Body" dir="ltr">Remember that for properties (as opposed to protocols), sequences and strings always have a maximum size (i.e. are bounded).</p>
    <h3 dir="ltr" id="toc118"><span class="SectionNumber">4.7.2 </span><a id="RefHeadingToc717251826048042"></a>The Accessing Worker Properties in C</h3>
    <p class="Standard" dir="ltr">The <span class="Code">properties</span> member of the <span class="Code">RCCWorker</span> structure (which is supplied as the *<span class="Code">self</span> argument to all worker methods), points to the memory that holds the worker's properties, with type <span class="Code">void *</span>.  When needed by the worker to access property values, it is first converted to the structure pointer type that defines the layout of the worker's properties, and then used to access individual properties, e.g.:</p>
    <p class="Code" dir="ltr">XyzProperties <span style="font-weight:bold">p = self-&gt;properties;  // implicit cast from void*</span><br />p-&gt;myprop1;          // scalar property<br />p-&gt;myprop2.length;   // number of elements in sequence for myprop2<br />p-&gt;myprop2.data[n];  // the nth element of the myprop2 sequence<br />p-&gt;myprop2.data;     // the address of the elements in myprop2<br />p-&gt;myprop3[a][b][c]; // an element of a 3d array property<br />p-&gt;myprop4[0];       // the first character of the myprop4 string<br />strlen(p-&gt;myprop4)   // the length of the myprop4 string.</p>
    <h3 dir="ltr" id="toc119"><span class="SectionNumber">4.7.3 </span><a id="RefHeadingToc717271826048042"></a>Accessing Worker Properties in C++</h3>
    <p class="Standard" dir="ltr">The worker object has a member function, <span class="Code">properties()</span>, that returns a reference to the XyzProperty structure.  Worker code accesses properties that are not parameters by simply using this member function.  The accesses similar to the C example above is:</p>
    <p class="Code" dir="ltr">XyzProperties &amp;p = properties();<br />p.myprop1;          // scalar property<br />p.myprop2.length;   // number of elements in sequence for myprop2<br />p.myprop2.data[n];  // the nth element of the myprop2 sequence<br />p.myprop2.data;     // the address of the elements in myprop2<br />p.myprop3[a][b][c]; // an element of a 3d array property<br />p.myprop4[0];       // the first character of the myprop4 string<br />strlen(p.myprop4)   // the length of the myprop4 string.</p>
    <h3 dir="ltr" id="toc120"><span class="SectionNumber">4.7.4 </span><a id="RefHeadingToc717291826048042"></a>Property Access Notifications</h3>
    <p class="Body" dir="ltr">Workers sometimes need dynamic notifications when properties are written or read by control software.  I.e. the worker would like to run some code just before a property read returns to potentially create the correct value to read, or run some code after a property write to cause some other side affect of the new written value.  For written values, this eliminates the need for polling by the worker to determine when the value has changed.</p>
    <p class="Body" dir="ltr">These capabilities are enabled when the property in the OWD has the <span class="Code">readSync</span> or <span class="Code">writeSync</span> attributes set to true.  The <span class="Code">readSync</span> attribute being true indicates that the worker would like to run some code <span style="font-style:italic">before</span> the value of the property is passed back to the control software reading the property.  The <span class="Code">writeSync</span> attribute being true indicates that the worker would like to run some code <span style="font-style:italic">after</span> a new value is written, in order to implement some side effect when the property value is changed.</p>
    <p class="Body" dir="ltr">An example of using <span class="Code">readSync</span> is when the value should be computed based on some other dynamic condition, e.g. reading a real-time or physical sensor value.  An example of <span class="Code">writeSync</span> is when writing a new value should atomically affect some other state of the worker.</p>
    <p class="Body" dir="ltr">Using the C language, the notifications are made via the calls to the beforeQuery (for any <span class="Code">readSync</span> property) and afterConfigure (for any <span class="Code">writeSync</span> property) control methods.  The worker cannot know which properties were written or read, but at least knows that only <span class="Code">readSync</span> or <span class="Code">writeSync</span> properties could have caused these notifications.</p>
    <p class="Body" dir="ltr">In C++, when these attributes are set, the skeleton includes empty implementations of notification methods for each such property that the worker author can fill out.  For <span class="Code">readSync</span> properties, a worker member function called <span class="Code">&lt;property&gt;_written</span> must be present.  For <span class="Code">writeSync</span> properties, a member function named <span class="Code">&lt;property&gt;_read</span> must be present.  Both notification member functions take no arguments and return <span class="Code">RCCResult</span>, which allows these functions to indicate errors.  A <span class="Code">readSync</span> notification function can set the property value locally and then return, and that value will then be conveyed back to control software.  A <span class="Code">writeSync</span> notification is called after the new value has been written, so the function can locally access the new value when it is called.</p>
    <h3 dir="ltr" id="toc121"><span class="SectionNumber">4.7.5 </span><a id="RefHeadingToc717311826048042"></a>Accessing the Values of Parameter Properties</h3>
    <p class="Body" dir="ltr">Properties which are indicated as parameters by setting the <span class="Code">parameter</span> attribute to <span class="Code">true</span> in the OCS or OWD, are accessed differently than other properties.  They are defined as <span class="Code">static const</span> values whose name is a fully capitalized <span class="Code"><span style="font-style:italic">&lt;WORKERNAME&gt;</span>_<span style="font-style:italic">&lt;PROPERTYNAME&gt;</span></span>.  Thus for worker <span class="Code">wxyz</span> and parameter property <span class="Code">pqr</span>, of type <span class="Code">float</span>, the value is:</p>
    <p class="Code" dir="ltr">static const float WXYZ_PQR;</p>
    <p class="Body" dir="ltr">These values are initialized at compile time and can be used accordingly.</p>
    <h2 dir="ltr" id="toc122"><span class="SectionNumber">4.8 </span><a id="RefHeadingToc80631067000368"></a>Controlling Slave Workers from Proxies — C++ Language Only</h2>
    <p class="Body" dir="ltr">When the RCC OWD indicates that a worker is a <span class="FirstEmphasis">proxy</span> for another worker as its slave, it gives the proxy worker convenient access to the slave's control operations and property accesses.  This allows proxy workers to standardize and/or simplify the control of the  slave worker. The slave worker is usually device-specific, with device-level properties or configuration requirements that applications should not be concerned with.</p>
    <p class="Body" dir="ltr">An example would be a device worker that controls an RF front-end device.  This device  typically exposes the native functionality of the device in a high performance and/or resource-conservative fashion.  However, most applications would only want a subset of those options that are uniform across all RF front-ends they might use.</p>
    <p class="Body" dir="ltr">Delegating normalization of the control/configuration interface to the RCC proxy worker provides users with a higher level standardized configuration interface.  This relieves this burden from the embedded device worker which may be in an environment (e.g. on a small FPGA) that makes this normalization difficult or expensive.  This also enables the device worker to faithfully and simply implement the device's native control interface.  This enables applications to exploit lower level device-specific features.  Such a low level device worker might be controlled in different ways using different proxies.</p>
    <p class="Body" dir="ltr">A proxy worker, acting as the software module that encapsulates specialized configuration and control sequencing of the device, can eliminate the need for control applications to use special non-component APIs:  the proxy is just another component in the application's XML.</p>
    <p class="Body" dir="ltr">In a proxy, the slave is accessed using the <span class="Code">slave</span> data member of the worker's class object.  This data member has functions for control operations on the slave (except <span class="Code">initialize</span> and <span class="Code">release</span>).  For each readable property of the slave, a <span class="Code">get_<span style="font-style:italic">&lt;property-name&gt;</span></span> member function retrieves the current value of the slave's property, and for each writable property of the slave worker a <span class="Code">set_<span style="font-style:italic">&lt;property-name&gt;</span></span> is available.  If the property is an array, both of these <span class="Code">get</span> and <span class="Code">set</span> member functions have arguments specifying the index in each dimension.  The <span class="Code">set</span> functions then have a value argument for the new value.  Here are some proxy code examples:</p>
    <p class="Code" dir="ltr">uint8_t x = slave.get_byteregA();<br />slave.set_byteregA(3);<br />x = slave.get_arrayprop(2);<br />slave.set_arrayprop(3, x);<br />x = slave.get_array2d(1, 2);<br />slave.set_array2d(1, 2, x);<br />slave.stop();<br />slave.start();</p>
    <p class="Standard" dir="ltr">There is currently no way to get or set whole array values, only individual elements.  Proxy workers typically have no data ports and no code in their <span class="Code">run</span> method.</p>
    <h2 dir="ltr" id="toc123"><span class="SectionNumber">4.9 </span><a id="RefHeading159862129872468"></a>Worker Dispatch Structures — C Language Only</h2>
    <p class="Body" dir="ltr">When workers are loaded for execution by the container, the container finds the worker by getting access to its <span class="Code">RCCDispatch</span> structure.  The only external symbol the worker code needs to define is the symbol that holds this structure.</p>
    <p class="Body" dir="ltr">The code generator generates this initialization in the skeleton file, and it can be further customized by the worker author.</p>
    <h3 dir="ltr" id="toc124"><span class="SectionNumber">4.9.1 </span><a id="RefHeading159882129872468"></a>RCCDispatch Structure Type</h3>
    <p class="Body" dir="ltr">This type is the dispatch table for the operations of the C-language worker interface.  It represents the functionality a worker provides to a container when it is loaded.  The container must gain access to this structure when the worker is loaded and executed.  All members are statically initialized by the worker source code.  This structure also contains other descriptive information required by the container to use the worker.</p>
    <p class="Body" dir="ltr">The RCC C-language skeleton will contain a default initialization for this structure based on what is in the OWD, which looks like (for worker <span class="Code">xyz.rcc</span>):</p>
    <p class="Code" dir="ltr">XYZ_METHOD_DECLARATIONS;<br />RCCDispatch bias = {<br />  /* insert any custom initializations here */<br />  XYZ_DISPATCH<br />};</p>
    <p class="Body" dir="ltr">Any non-default member initializations must be placed after the XYZ_DISPATCH line, and be specified using the named member syntax, e.g.:</p>
    <p class="Code" dir="ltr">RCCDispatch bias = {<br />  /* insert any custom initializations here */<br />  XYZ_DISPATCH<br />  .memSize = 16*sizeof(MyData),<br />  .runCondition = &amp;myRunCondition<br />};</p>
    <p class="Body" dir="ltr">The members of this structure that may be set this way are defined in the following table:</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a>:  Members of the RCCDispatch Structure — C Language Only</p>
    <table cellspacing="0" dir="ltr" id="Table7table" style="margin-top:0;margin-bottom:0;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:123.531204px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">RCCDispatch Member </p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:142.00162px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Member Data Type</p>
          </td>
          <td style="border:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:332.464px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Member Description</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:123.531204px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">memSizes</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:142.00162px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">uint32_t*</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:332.464px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">This zero-terminated array of memory sizes indicates allocations required by the worker. Multiple allocations allow the worker to avoid aggregating its requirements in a single allocation. May be NULL, when no allocations are required.  Use <span class="Code"><span style="font-size:14.666667px">memSize</span></span> below when there is only one allocation required.</p>
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">Result will be in <span class="Code"><span style="font-size:14.666667px">self-&gt;memories</span></span>.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:123.531204px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">runCondition</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:142.00162px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">RCCRunCondition*</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:332.464px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">The initial run condition used.  If this pointer is NULL it implies a run condition of all connected ports being ready and no timeout.  If there are no ports, the default is no port masks to check, indicating always ready to run.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:123.531204px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">optionalPorts</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:142.00162px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">RCCPortMask</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:332.464px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">A mask indicating ports that may be unconnected.  The default, 0, means all ports must be connected before the worker is started.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:123.531204px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">memSize</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding:3.6671999px;vertical-align:top;width:142.00162px">
            <p class="TableCode" dir="ltr" style="font-size:14.666667px">size_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding:3.6671999px;vertical-align:top;width:332.464px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">This size indicates a required static memory allocation.  May be zero, indicating no allocation is required.  Result will be in <span class="Code"><span style="font-size:14.666667px">self-&gt;memory</span></span>.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Body" dir="ltr"> </p>
    <h1 dir="ltr" id="toc125"><span class="SectionNumber">5 </span><a id="RefHeading10618140039662"></a><a id="Toc270018444"></a>Code Generation for RCC Workers</h1>
    <p class="Body" dir="ltr">In the descriptions below, italicized names in angle brackets are names specific to the worker, as found in the worker’s OCS and OWD XML files.</p>
    <p class="Body" dir="ltr">The worker's OCS and OWD are used to generate two code files, the <span class="FirstEmphasis">header</span> and the <span class="FirstEmphasis">skeleton</span>.  The header file, which should not be edited, and is deleted by “<span class="Code">make clean</span>”, contains type definitions and declarations customized for the worker.  This file is named <span class="Code"><span style="font-style:italic">&lt;workername&gt;</span>_Worker.h</span> in the C language or <span class="Code"><span style="font-style:italic">&lt;workername&gt;</span>-worker.hh</span> in the C++ language, with the worker name is its original case from the OWD.  It is placed in the <span class="Code">gen</span> subdirectory of the worker's directory.</p>
    <p class="Body" dir="ltr">The skeleton file is a small file that is generated as the basis for writing the worker's execution code (e.g. the <span class="Code">run</span> method implementation).  It relies heavily on the generated header file and is as small as possible to avoid requiring code changes when the OCS or OWD is changed.  The skeleton is generated in the <span class="Code">gen</span> subdirectory also, with the name <span class="Code"><span style="font-style:italic">&lt;workername&gt;</span>-skel.c</span> (C language) or <span class="Code"><span style="font-style:italic">&lt;workername&gt;</span>-skel.cc</span> (C++ language).  It is also copied into the worker's directory as the worker's primary source file: <span class="Code"><span style="font-style:italic">&lt;workername&gt;</span>.c</span> or <span class="Code"><span style="font-style:italic">&lt;workername&gt;</span>.cc.</span>  This copy is what should be edited to add the worker's functional code.  This copy is <span style="font-style:italic">only made if the worker's code file does not exist</span>.</p>
    <p class="Body" dir="ltr">When the OCS, OPS or OWD XML files are changed, the header and skeleton are regenerated, <span style="font-style:italic;font-weight:normal">but this does not affect the primary source file</span>.  Because most of the code is generated in the header, and only a little in the skeleton, it is rare that significant code changes are required in the primary source file based on XML changes.</p>
    <p class="Body" dir="ltr">The <span class="Code">gen/<span style="font-style:italic">&lt;workername&gt;</span>-skel.{c,cc} </span>skeleton file should not be edited, but left for reference to see exactly what the code generator produced.</p>
    <h2 dir="ltr" id="toc126"><span class="SectionNumber">5.1 </span><a id="RefHeadingToc80651067000368"></a>Namespace Management</h2>
    <p class="Body" dir="ltr">To avoid name space collisions, some rules are used by the code generator when creating the header and skeleton files.</p>
    <p class="Body" dir="ltr">In the C++ language, generated data types in the header are placed in a namespace whose name is: <span class="Code"><span style="font-style:italic">&lt;Worker&gt;</span>WorkerTypes</span>.  In the actual worker source file, this namespace is normally imported, via the “<span class="Code">using namespace</span>” directive.  The actual worker derived class is a class in the global namespace whose name is <span class="Code"><span style="font-style:italic">&lt;Worker&gt;</span>Worker</span>.  In both cases, <span class="Code"><span style="font-style:italic">&lt;Worker&gt;</span></span> is a capitalized version of the worker's name.  The dispatch entry point, which is necessarily a C external symbol, has the worker's name as its external symbol, with the prefix <span class="Code">ocpi_</span>.</p>
    <p class="Body" dir="ltr">In the C language, the worker's dispatch table is given the external symbol name of the worker, and all methods are declared <span class="Code">static</span>.  All data types use the capitalized worker name as a prefix and all constants and macros use the upper cased worker name followed by an underscore as a prefix.</p>
    <p class="Body" dir="ltr">A summary of the RCC authoring model name space management is:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">The C++ namespace <span class="Code">OCPI</span> is reserved.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The prefix <span class="Code">ocpi_</span> is reserved in the C external linkage namespace.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">C workers use their name as an external symbol.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">C++ workers use two global namespaces that use the <span class="Code"><span style="font-style:italic">&lt;Worker&gt;</span></span> prefix.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">C and C++ workers use the PARAM_ and OCPI_ prefixes for preprocessor symbols.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">C workers use the <span class="Code"><span style="font-style:italic">&lt;Worker&gt;</span></span> prefix for type names and <span class="Code"><span style="font-style:italic">&lt;WORKER&gt;</span>_</span> for constants.</p>
      </li>
    </ul>
    <h2 dir="ltr" id="toc127"><span class="SectionNumber">5.1 </span><a id="RefHeadingToc80671067000368"></a>Generated Data Types</h2>
    <p class="Body" dir="ltr">Various data types are generated in the header file for the worker.  They are :</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Port name enumeration</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Property data structure</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Opcode enumeration for each protocol used</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Opcode enumeration for each port (C only)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Message structures (C only)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">Worker base class (C++ only)</p>
      </li>
    </ul>
    <h3 dir="ltr" id="toc128"><span class="SectionNumber">5.1.1 </span><a id="Toc270018445"></a><a id="RefHeading10620140039662"></a>The Enumeration Constants for the Worker’s Ports</h3>
    <p class="Body" dir="ltr">An enumeration type is generated in the header file defining constants for the ordinal of each port, in the form <span class="Code"><span style="font-style:italic">&lt;WORKER&gt;</span>_<span style="font-style:italic">&lt;PORT&gt;</span></span>, in all upper case.  These ordinals can be used when creating port masks for run conditions, or, for C workers, indexing into the port array in the <span class="Code">RCCWorker</span> structure.</p>
    <h3 dir="ltr" id="toc129"><span class="SectionNumber">5.1.2 </span><a id="RefHeading10622140039662"></a><a id="Toc270018446"></a>The Properties Structure Type</h3>
    <p class="Body" dir="ltr">This is the generated structure definition that reflects the properties declared for the worker in its OCS and OWD XML files.  Each member of this structure has the data type corresponding to the property’s description in the OWD and OCS XML files.  Members for properties that are <span style="font-style:italic">not</span> declared <span class="Code">volatile</span> in XML are <span class="Code">const</span> in this structure, indicating that the worker is not expected to change their values.</p>
    <p class="Body" dir="ltr">The standard name of the struct type (typedef name in C) is <span class="Code">XyzProperties</span> where “Xyz” is the <span style="font-style:italic">capitalized</span> worker implementation name.</p>
    <p class="Body" dir="ltr">Properties which are sequences are generated as a structure containing a <span class="Code">uint32_t</span> member whose name is <span class="Code">length</span>, holding the number of elements in the sequence.  Padding may be added before and after the length member to achieve the required alignment of this length field as well as the sequence data following it.  The member name of the structure is the property name.  The members of the structure are <span class="Code">length</span> and <span class="Code">data</span>.  The data member is a C array whose length is the <span class="Code">SequenceLength</span> attribute from the <span class="Code">Property</span> element in the XML.  Remember that for properties (as opposed to protocols), sequences and strings always have a maximum size (i.e. be bounded).</p>
    <p class="Body" dir="ltr">Struct properties have structure tags the same name as the property name, preceded by the worker name.</p>
    <p class="Body" dir="ltr">The correspondence between property types in OCS and OWD files and the C/C++ language data types are in the following table:</p>
    <p class="TableCaptionbefore" dir="ltr">Table <a href="#seqrefTable0">1</a>:  Property Data Types in C and C++</p>
    <table cellspacing="0" dir="ltr" id="Table9table" style="margin-top:0;margin-bottom:0;width:624.0px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">OCS/OWD<br />Property Type</p>
          </td>
          <td style="border-top:1.0px solid #000000;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">C/C++<br />Data Type</p>
          </td>
          <td style="border:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p class="TableHeading" dir="ltr" style="font-size:14.666667px">Comments</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">bool</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">RCCBool</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">Must be 8 bits, consistent across languages.</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">char</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">RCCChar</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">Must be signed type, and basis for <span class="Code"><span style="font-size:14.666667px">string</span></span></p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">uchar</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">uint8_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">short</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">int16_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">ushort</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">uint16_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">long</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">int32_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">ulong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">uint32_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">longlong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">int64_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">ulonglong</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">uint64_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">string</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">RCCChar[]</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">Null terminated string</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">enum</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">uint32_t</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p style="margin:0;font-size:1px"> </p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">float</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">RCCFloat</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">Must be IEEE 32 bit float</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:122.66399px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">double</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:none;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:153.47038px">
            <p class="TableCode" dir="ltr" style="text-align:left;font-size:14.666667px">RCCDouble</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000000;border-left:1.0px solid #000000;border-right:1.0px solid #000000;padding-top:0;padding-bottom:0;padding-left:1.0px;padding-right:1.0px;vertical-align:top;width:337.86557px">
            <p class="TableContents" dir="ltr" style="font-size:14.666667px">Must be IEEE 64 bit double</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Body" dir="ltr">The names of the non-integer types for scalar properties are the OCS-defined type names capitalized and prefixed with <span class="Code">RCC</span>:  e.g. <span class="Code">RCCBoolean</span>, <span class="Code">RCCChar</span>, <span class="Code">RCCFloat</span>, <span class="Code">RCCDouble</span>.  Properties that are string properties are <span class="Code">RCCChar </span>arrays whose size is one more than the declared <span class="Code">StringLength</span> attribute of that string property in the <span class="Code">Property</span> element, and the values are null terminated strings.</p>
    <h3 dir="ltr" id="toc130"><span class="SectionNumber">5.1.3 </span><a id="RefHeading87141123303156"></a>Structures for Message Payloads — C Language Only</h3>
    <p class="Body" dir="ltr">For each port a union type is defined for all possible messages at that port.  Members of the union type are generated structures for each possible message in that protocol.  The name of the union type is <span class="Code">&lt;Port&gt;Operations</span>, with port name capitalized.</p>
    <p class="Body" dir="ltr">For each of the message types specified in the protocol, a structure is defined.  The structure's type name is the capitalized name of the operation in the protocol, and whose member name is the lower cased name.  Arguments to the operation in the protocol are structure members of that per-operation structure.  The structure layout is as defined above for the property structure, with the exception that variable size elements (strings and sequences) are allowed, and are sized as <span class="Code">[1]</span>, with no further members generated after the first variable sized member.</p>
    <p class="Body" dir="ltr">The structure generated is padded and packed, such that padding members are explicitly inserted to ensure all types are aligned on their own boundaries.  As part of the packing, the compiler is told to pack the structure,  Given the insertion of padding, the packing simply means that there is no padding at the end of the structure to achieve any alignment.  The struct definition should not be used in any other context where this lack of overall size alignment is required (e.g. an array of such structures).</p>
    <p class="Body" dir="ltr"><span style="font-size:16.0px">There is one special exception for messages that consist entirely of one sequence of fixed length elements:  the length of the sequence is implied by the overall message length as specified by the length value of buffers at input and output ports, and </span><span style="font-style:italic;font-size:16.0px">not</span><span style="font-size:16.0px"> represented by inserting a </span><span class="Code">uint32_t</span><span style="font-size:16.0px"> value in the message buffer/structure.  In all other cases (not-fixed sequence elements, or more than one top level data argument in the message), sequences in messages are represented by a struct containing </span><span class="Code">length</span><span style="font-size:16.0px"> and </span><span class="Code">data</span><span style="font-size:16.0px"> members.</span></p>
    <p class="Body" dir="ltr">For example, for a port named <span class="Code">in</span>, with a protocol whose first operation was <span class="Code">sampledata</span>, and whose first argument was <span class="Code">sample</span> - a sequence of <span class="Code">Ulonglong</span> values, the worker’s custom port union would look like:</p>
    <p class="Code" dir="ltr"><span style="font-weight:bold;font-size:14.666667px">union InOperations {</span><br /><span style="font-weight:bold;font-size:14.666667px">  // Structure for the 'sampledata' operation on port 'in'</span><br /><span style="font-weight:bold;font-size:14.666667px">  struct __attribute__ ((__packed__)) Sampledata {</span><br /><span style="font-weight:bold;font-size:14.666667px">    uint64_t sample[1];</span><br /><span style="font-weight:bold;font-size:14.666667px">  } sampledata;<br />};</span></p>
    <h3 dir="ltr" id="toc131"><span class="SectionNumber">5.1.4 </span><a id="RefHeadingToc16848576511445"></a>Worker Base Class — C++ Language Only</h3>
    <p class="Body" dir="ltr">For C++ workers, a base class is generated in the header file that is inherited by a derived class in the skeleton.  The base class is generated to maximize the code generated in the header file and minimize the code generated in the skeleton.</p>
    <p class="Body" dir="ltr">The worker base class is generated to support all the documented features described above, including access to properties, and contain pure virtual member function declarations for all the member functions required to be implemented in the derived class.  The details of the code generation are implementation defined and subject to change.</p>
    <h1 dir="ltr" id="toc132" style="page-break-before:always"><span class="SectionNumber">6 </span><a id="Toc211781789"></a><a id="Toc211781109"></a><a id="Toc211780989"></a><a id="Toc211780960"></a><a id="RefHeading10774474132946"></a><a id="Toc211783575"></a>RCC Local Services</h1>
    <p class="Body" dir="ltr">Local services APIs are standard library functions available to RCC workers running in a container.  Containers are required to supply them, and portable workers are constrained to use only them, in addition to the worker-to-container methods defined above.  The RCC local services are defined as a small subset of the POSIX and ISO-C runtime libraries.</p>
    <p class="Body" dir="ltr">The subset avoids functions that require significant operating system support while providing the author with common, convenient and standard library functions.  All I/O is excluded since portable RCC workers should be performing all I/O via the OpenCPI data plane ports.</p>
    <p class="Body" dir="ltr">These local services APIs represent a minimal environment required of embedded systems.  If other APIs are used, there is no guarantee they will be available in all containers.  Some containers in fact allow many more functions to be called from a worker, but that makes such workers non-portable.</p>
    <p class="Body" dir="ltr">In other standards documents, a list of available, standard, functions is sometimes called an Application Environment Profile (AEP).</p>
    <p class="Body" dir="ltr">The actual list of standard functions and global variables available to portable RCC workers is, in alphabetical order:</p>
    <p class="Code" dir="ltr">abs(), asctime(), asctime_r(), atof(), atoi(), atol(), atoll(), bsearch(), calloc(), confstr(), ctime(), ctime_r(), difftime(), div(), environ, errno, feclearexcept(), fegetenv(), fegetexceptflag(), fegetround(), feholdexcept(), feraiseexcept(), fesetenv(), fesetexceptflag(), fesetround(), fetestexcept(), feupdateenv(), free(), getenv(), gmtime(), gmtime_r(), imaxabs(), imaxdiv(), isalnum(), isalpha(), isblank(), iscntrl(), isdigit(), isgraph(), islower(), isprint(), ispunct(), isspace(), isupper(), isxdigit(), labs(), ldiv(), llabs(), lldiv(), localeconv(), localtime(), localtime_r(), longjmp(), malloc(), memchr(), memcmp(), memcpy(), memmove(), memset(), mktime(), qsort(), rand(), rand_r(), realloc(), setenv(), setjmp(), setlocale(), snprintf(), sprintf(), srand(), sscanf(), strcat(), strchr(), strcmp(), strcoll(), strcpy(), strcspn(), strerror(), strerror_r(), strftime(), strlen(), strncat(), strncmp(), strncpy(), strpbrk(), strrchr(), strspn(), strstr(), strtod(), strtof(), strtoimax(), strtok(), strtok_r(), strtol(), strtold(), strtoll(), strtoul(), strtoull(), strtoumax(), strxfrm(), sysconf(), time(), tolower(), toupper(), tzname, tzset(), uname(), unsetenv(), va_arg(), va_copy(), va_end(), va_start(), vsnprintf(), vsprintf(), vsscanf()</p>
    <h2 dir="ltr" id="toc133"><span class="SectionNumber">6.1 </span><a id="Toc211781791"></a><a id="Toc211781111"></a><a id="Toc211780991"></a><a id="Toc211780962"></a><a id="RefHeading10778474132946"></a><a id="Toc211783577"></a>RCC Local Services AEP as a Small Subset of POSIX and ISO-C.</h2>
    <p class="Body" dir="ltr">This section explains the rationale for the RCC AEP and its connection to POSIX standards.  The POSIX Minimal Realtime System Profile (PSE51) from the <span class="FirstEmphasis">IEEE Std 1003.13™‑2003</span> standard is used as the superset of functionality that is reduced (with subtractions) to the RCC local services available functions.  It can be found at <a class="Internet20link" href="https://standards.ieee.org/findstds/standard/1003.13-2003.html">https://standards.ieee.org/findstds/standard/1003.13-2003.html</a>.</p>
    <p class="Body" dir="ltr">This subset is defined to require setting the <span class="Code">_POSIX_AEP_RT_MINIMAL_C_SOURCE</span> feature test macro to the value <span class="Code">200312L</span>, before including any standard header files.  This is not necessary in RCC workers.  The PSE51 profile defines POSIX.1 units of functionality in table 6-1 of the <span class="FirstEmphasis"><span style="font-style:normal;font-weight:normal">IEEE Std 1003.13™‑2003</span></span><span style="font-style:normal;font-weight:normal"> </span>document.  The RCC Local Services AEP removes these units of functionality from that table:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">POSIX_DEVICE_IO</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">POSIX_FILE_LOCKING</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">POSIX_SIGNALS</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">XSI_THREAD_MUTEX_EXT</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">XSI_THREADS_EXT</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">POSIX_THREADS_BASE</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The retained units of functionality, and their defined symbols and functions are:</p>
    <p class="Code" dir="ltr">POSIX_C_LANG_JUMP: longjmp(), setjmp();</p>
    <p class="Code" dir="ltr">POSIX_C_LANG_SUPPORT: abs(), asctime(), asctime_r(), atof(), atoi(), atol(), atoll(), bsearch(), calloc(), ctime(), ctime_r(), difftime(), div(), feclearexcept(), fegetenv(), fegetexceptflag(), fegetround(), feholdexcept(), feraiseexcept(), fesetenv(), fesetexceptflag(), fesetround(), fetestexcept(), feupdateenv(), free(), gmtime(), gmtime_r(), imaxabs(), imaxdiv(), isalnum(), isalpha(), isblank(), iscntrl(), isdigit(), isgraph(), islower(), isprint(), ispunct(), isspace(), isupper(), isxdigit(), labs(), ldiv(), llabs(), lldiv(), localeconv(), localtime(), localtime_r(), malloc(), memchr(), memcmp(), memcpy(), memmove(), memset(), mktime(), qsort(), rand(), rand_r(), realloc(), setlocale(), snprintf(), sprintf(), srand(), sscanf(), strcat(), strchr(), strcmp(), strcoll(), strcpy(), strcspn(), strerror(), strerror_r(), strftime(), strlen(), strncat(), strncmp(), strncpy(), strpbrk(), strrchr(), strspn(), strstr(), strtod(), strtof(), strtoimax(), strtok(), strtok_r(), strtol(), strtold(), strtoll(), strtoul(), strtoull(), strtoumax(), strxfrm(), time(), tolower(), toupper(), tzname, tzset(), va_arg(), va_copy(), va_end(), va_start(), vsnprintf(), vsprintf(), vsscanf();</p>
    <p class="Code" dir="ltr">POSIX_SINGLE_PROCESS: confstr(), environ, errno, getenv(), setenv(), sysconf(), uname(), unsetenv();</p>
    <p class="Body" dir="ltr">The philosophy of the base RCC profile AEP subset is to allow functions that are simply libraries (rather than OS services), but remove services that could conflict with the lean container execution model in that profile.  This basically leaves the typical ANSI-C (or ISO C99) runtime library (without I/O) – most DSPs have this available, even those environments without multithreading.</p>
    <h1 dir="ltr" id="toc134"><span class="SectionNumber">7 </span><a id="RefHeadingToc717331826048042"></a>Debugging RCC Workers</h1>
    <p class="Body" dir="ltr">RCC workers are built as dynamically loadable “shared object” files, with the <span class="Code">.so</span> suffix (at least on Linux systems).  When an application uses a worker, it will be loaded on demand, even when the executable is statically linked itself.  To debug a worker, it is necessary to first start the debugger on the executable, which is usually the <span class="Code">ocpirun</span> utility program that runs OpenCPI applications based on a top-level XML file specifying which components are needed.  It may also be a custom main program that uses the OpenCPI Application Control Interface to internally launch an application.</p>
    <p class="Body" dir="ltr">In either case the first step is to run the executable under the debugger, establishing a generic breakpoint to enter the debugger at a point after workers are loaded, but before they are actually run.  Then breakpoints can be placed in the worker code itself.</p>
    <p class="Body" dir="ltr">The two pieces of “internal” information needed to do this are:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">A breakpoint that happens just before any RCC worker is initialized</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">A way of knowing when the worker that hits the breakpoint is the worker you want.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The initial breakpoint should be placed on the <span class="Code">OCPI::RCC::Worker::Worker</span> member function (an internal constructor).  This breakpoint will be hit for every worker in the application, after it is loaded, but before it ever is initialized (C) or constructed (C++). Note that although this initial breakpoint is at a constructor, it is not the actual constructor of the C++ worker, and not even in its inheritance hierarchy.</p>
    <p class="Body" dir="ltr">To determine whether the worker about to be constructed is the worker of interest, simply examine the “name” argument at this breakpoint  This is the instance name for the worker within the application.  If the name indicates a worker of interest you can now establish a breakpoint in the worker, either based on a source line number, or symbols in the worker.</p>
    <p class="Body" dir="ltr">Assuming the use of the <span class="Code">gdb</span> debugger, and running the application with the <span class="Code">ocpirun</span> utility, here are the steps:</p>
    <ol class="listlevel1Numbering1">
      <li>
        <p class="ListNumber" dir="ltr">Start gdb on ocpirun:<br /><span class="Code">% gdb ocpirun</span></p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Set the generic breakpoint:<br /><span class="Code">(gdb)  b OCPI::RCC::Worker::Worker<br /></span>At this point gdb may not find it and say:<br /><span class="Code">Make breakpoint pending on future ... load? (y or [n])</span><br />Say yes (y).</p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Run ocpirun with appropriate arguments:<br />(<span class="Code">gdb)  run -v myapp</span></p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">When the generic breakpoint is hit, see which worker is being initialized by printing the <span class="Code">name</span> argument.  If not a worker of interest, continue.<br /><span class="Code">(gdb)  p name<br />(gdb)  c</span></p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">When a worker of interest is about to be initialized/constructed, set a breakpoint in your worker, e.g.:<br /><span class="Code">(gdb)  b myfft.c:run</span> (e.g. for C, set breakpoint on run method)<br /><span class="Code">(gdb)  b myfft.cc:135 </span>(e.g. for a C++ worker, by line number)<br /><span class="Code">(gdb)  b MyfftWorker::MyfftWorker</span> (e.g. break on C++ constructor)<span class="Code"><br />(gdb)  c</span></p>
      </li>
      <li>
        <p class="ListNumber" dir="ltr">Continue past any other worker initializations (or disable the first breakpoint).</p>
      </li>
    </ol>
    <p class="Body" dir="ltr">At this point the breakpoint in the worker will be hit and debugging can proceed.</p>
    <h1 dir="ltr" id="toc135"><span class="SectionNumber">8 </span><a id="RefHeading119011972665394"></a>Summary of OpenCPI RCC Authoring Model</h1>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr"><span style="font-size:16.0px;background-color:transparent">RCC workers are written to implement worker methods, called by the container, and optionally use the container methods, called by the worker.</span></p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">RCC workers may call the local services functions defined in section 6 above.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">RCC workers use symbols, data types and ordinals defined in the generated header file, which is based on the OCS, OPS, and OWD files, including</p>
      </li>
    </ul>
    <ul style="margin-top:0;margin-bottom:0;list-style-type:disc;clear:left">
      <li>
        <p class="ListBullet2" dir="ltr">Implementation name</p>
      </li>
      <li>
        <p class="ListBullet2" dir="ltr">Which control operations are implemented</p>
      </li>
      <li>
        <p class="ListBullet2" dir="ltr">Which properties require notification </p>
      </li>
      <li>
        <p class="ListBullet2" dir="ltr">Static memory allocation requirements of the implementation code</p>
      </li>
      <li>
        <p class="ListBullet2" dir="ltr">Minimum number of buffers required at each port</p>
      </li>
    </ul>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">The information in the OCS/OPS/OWD files is used to drive the code generation and build process.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">The worker uses the software execution model as described in the CDG.</p>
      </li>
    </ul>
    <h1 dir="ltr" id="toc136"><span class="SectionNumber">9 </span><a id="Toc211780971"></a><a id="Toc211780997"></a><a id="Toc211781125"></a><a id="Toc211781797"></a><a id="Toc211783583"></a><a id="Toc211783582"></a><a id="Toc211780970"></a><a id="Toc211780996"></a><a id="Toc211781124"></a><a id="Toc211781796"></a><a id="RefHeading10780474132946"></a>Worker Code Examples</h1>
    <h2 dir="ltr" id="toc137"><span class="SectionNumber">9.1 </span><a id="RefHeadingToc717351826048042"></a>C Language Examples</h2>
    <p class="Body" dir="ltr">Here is a simple example of a C-language “Xyz” worker whose:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Initial run condition was the default (condition == NULL, usecs == 0, run when all ports are ready, no timeout),</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span class="FirstEmphasis">start</span> and <span class="FirstEmphasis">release</span> methods are not needed or implemented.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One input port (0) with interface XyzIn,  and one output port (1) XyzOut</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One interface operation Op1 on input (i.e. can ignore “operation”), which is an array of 100 “shorts”.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One interface operation Op2 on output</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One simple property, called center_frequency, of type float.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The worker would have automatically generated types and structures like this (based on OCS and OWD), and put in a file called “xyz_Worker.h”:</p>
    <p class="Code" dir="ltr"><span style="font-family:Courier,serif;font-size:13.333334px">#include “RCC_Worker.h”</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">typedef struct {	/* structure for defined properties /</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCCFloat center_frequency;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">} XyzProperties;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">typedef struct {	// structure for message for operation</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	int16_t ishorts[100];</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">} XyzInOp1;</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">typedef struct {	// structure for message for operation</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	int16_t oshorts[100];</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">} XyzOutOp2;</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">typedef enum { // port ordinals</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XYZ_IN,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XYZ_OUT</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">} XyzPort;</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">typedef enum { // operation ordinals</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XYZ_OUT_OP2</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">} XyzOutOperation;</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">typedef enum { // operation ordinals</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XYZ_IN_OP1</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">} XyzInOperation;</span></p>
    <p class="Body" dir="ltr">The actual code for the worker would look like this:</p>
    <p class="Code" dir="ltr"><span style="font-family:Courier,serif;font-size:13.333334px">#include “Xyz_Worker.h”</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Define the initialize method, setting output operation to be a */</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* constant, since it is the only one.*/</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static RCCResult</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">initialize(RCCWorker *w) {</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	w-&gt;ports[XYZ_OUT].output.u.operation = XYZ_OUT_OP2;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	return RCC_OK;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">}</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Define run method to call the “compute” function, reading from */</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* input buffer, writing to output, applying current value of the */</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* “center frequency” property.*/</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static RCCResult</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">run(RCCWorker *w, RCCBoolean timedout, RCCBoolean *newRunCondition)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">{</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XyzProperties *p = w-&gt;properties;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XyzInOp1     *in = w-&gt;ports[XYZ_IN].current.data;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XyzOutOp2   *out = w-&gt;ports[XYZ_OUT].current.data;</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">	</span><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Do computation based in ishorts, and frequency put results */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	</span><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* in oshorts.  Extern is here simply for readability.</span><span style="font-family:Courier,serif;font-size:13.333334px"> */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	extern void compute(int16_t *, int16_t *, float);</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">	compute(in-&gt;ishorts, out-&gt;oshorts, p-&gt;center_frequency);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	</span><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Ask container to get new input and output buffers *</span><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">/</span><br /><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">	</span><span style="font-family:Courier,serif;font-size:13.333334px">return RCC_ADVANCE;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">}</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Initialize dispatch table for container, in a global symbol </span><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">/</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">RCCDispatch Xyz = {</span><br /><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">	/*</span><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> Consistency checking attributes */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCC_VERSION, 1, 1, sizeof(XyzProperties), RCC_NULL, RCC_FALSE,</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Methods */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	initialize, RCC_NULL, RCC_NULL, RCC_NULL, RCC_NULL, RCC_NULL,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCC_NULL, run,</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Default run condition */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCC_NULL</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">};</span></p>
    <p class="Body" dir="ltr">Other than the compute function, the above example compiles to use less than 120 bytes on an ARM processor.</p>
    <h3 dir="ltr" id="toc138"><span class="SectionNumber">9.1.1 </span><a id="RefHeadingToc717371826048042"></a><a id="Toc211781127"></a>Worker Using Input Callback</h3>
    <p class="Body" dir="ltr">This illustrates an input-based callback function that has a sequential coding style in which the worker blocks on the two-way remote call until the response is received and processing can continue.  No extra threads are used.</p>
    <p class="Body" dir="ltr">The code is:</p>
    <p class="Code" dir="ltr"><span style="font-family:Courier,serif;font-size:13.333334px">#include "Xyz_Worker.h"</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Define the input port callback method to call the local "compute"</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * function, reading from input buffer, applying the value of the</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * "center frequency" property, followed by two way  "process"</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * operation, finally writing the result to output port XYZ_OUT */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px"> static RCCResult</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">computeInput(RCCWorker *this, RCCPort *inPort, RCCResult reason)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">{</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XyzProperties *p = this-&gt;properties;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCCContainer *c = &amp;this-&gt;container;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	XyzInOp1 *data = inPort-&gt;current.data;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCCPort *computeOut = &amp;this-&gt;ports[XYZ_COMPUTE_REQUEST_OUT],</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	        *computeIn = &amp;this-&gt;ports[XYZ_COMPUTE_REPLY_IN],</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	        *otherOut = &amp;this-&gt;ports[XYZ_OUT];</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	extern void compute(int16_t *, int16_t *, float);</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">	if (reason != RCC_OK)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		return RCC_FATAL;</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Do computation based in ishorts, and frequency; put results</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	 * back in ishorts, in place */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	compute(data-&gt;ishorts, data-&gt;ishorts, p-&gt;center_frequency);</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Call Process operation on "uses" port: buffer ownership passes</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	 * back to container. */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	c-&gt;send(computeOut, &amp;inPort-&gt;current, XYZ_COMPUTE_PROCESS,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	        inPort-&gt;input.length);</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Wait until response received (or 100 msec error timeout). </span><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">/</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	c-&gt;wait(computeIn, 100, 100000);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	if (computeIn-&gt;input.u.exception == RCC_NO_EXCEPTION)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		c-&gt;send(otherOut, &amp;computeIn-&gt;current, XYZ_OUT_OP2,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		        computeIn-&gt;input.length);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	else</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		c-&gt;release(&amp;computeIn-&gt;current);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	return RCC_OK;</span><br /><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">}</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Define the initialize method to perform worker initialization. */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static RCCResult</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">initialize(RCCWorker *this)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">{</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">  this-&gt;ports[XYZ_IN].callBack = computeInput;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">  return RCC_OK;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">}</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Initialize dispatch table provided to container. We only need the</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * initialize method to register the callback.  No run method needed */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">RCCDispatch</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">Xyz = {</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Consistency checking attributes */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCC_VERSION, 1, 1, sizeof(XyzProperties), RCC_NULL, RCC_TRUE,</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Methods */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	initialize</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* all remaining members zero/NULL */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">};</span></p>
    <p class="Body" dir="ltr">Other than the compute function, the above example compiles to use less than 300 bytes on an ARM processor.</p>
    <h3 dir="ltr" id="toc139"><span class="SectionNumber">9.1.2 </span><a id="RefHeadingToc717391826048042"></a><a id="Toc211781128"></a>Worker Using the State-machine Style</h3>
    <p class="Body" dir="ltr">This illustrates a finite state machine coding style in a worker that maintains an internal state to simulate blocking on a two-way remote call until the response is received and processing can continue.</p>
    <p class="Code" dir="ltr"><span style="font-family:Courier,serif;font-size:13.333334px">#include "Xyz_Worker.h"</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Define two different run conditions to represent two states */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static uint32_t</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">  state1Ports[] = {1 &lt;&lt; XYZ_IN, 0},</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">  state2Ports[] = {1 &lt;&lt; XYZ_COMPUTE_REPLY_IN, 0};</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static RCCRunCondition</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">  awaitingInput = {state1Ports},</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">  awaitingResponse = {state2Ports};</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Define start method, set run condition, which is also state. </span><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">/</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static RCCResult</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">initialize(RCCWorker this)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">{</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	this-&gt;runCondition = &amp;awaitingInput;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	return RCC_OK;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">}</span><br /><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">/</span><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">* Define run method to call the local "compute" function</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * reading from input buffer, applying current value of the</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * “center frequency” property, followed by remote two way</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * “process” operation, finally writing result to output. */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">static RCCResult</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">run(RCCWorker *this, RCCBoolean timedout, RCCBoolean *newRunCondition)</span><br /><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">{</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCCContainer *c = &amp;this-&gt;container;</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Use run condition as state indicator */ </span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	if (this-&gt;runCondition == &amp;awaitingInput) {</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		RCCPort</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">			*inPort       = &amp;this-&gt;ports[XYZ_IN],</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">			*computeOut   = &amp;this-&gt;ports[XYZ_COMPUTE_REQUEST_OUT];</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		XyzInOp1 *in     = inPort-&gt;current.data;</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		XyzProperties *p = this-&gt;properties;</span><br /><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">		/* do some computation based in ishorts, and frequency;</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">		 * put results back in same buffer (in-place) */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		extern void compute(int16_t *, int16_t *, float);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		compute(in-&gt;ishorts, in-&gt;ishorts, p-&gt;center_frequency);</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">		/* Call Process op on user port - buffer ownership passes back</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		 * to container.  Input port is advanced by taking buffer away</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		 * from it. *</span><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">/</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		c-&gt;send(computeOut, &amp;inPort-&gt;current, XYZ_COMPUTE_PROCESS,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		        inPort-&gt;input.length);	/* length of message */				this-&gt;runCondition = &amp;awaitingResponse; /* update state */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	} else {</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		RCCPort *computeIn = &amp;this-&gt;ports[XYZ_COMPUTE_REPLY_IN];</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		RCCPort *otherOut = &amp;this-&gt;ports[XYZ_OUT];</span><br /><br /><span style="font-family:Courier,serif;font-size:13.333334px">		if (computeIn-&gt;input.u.exception == 0)</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">			c-&gt;send(otherOut, &amp;computeIn-&gt;current, XYZ_OUT_OP2,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">			        computeIn-&gt;input.length);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		else</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">			c-&gt;advance(computeIn, 0);</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">		this-&gt;runCondition = &amp;awaitingInput; /* update state */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	}</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	*newRunCondition = RCC_TRUE; /* to container: new runcondition </span><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">/</span><br /><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">	</span><span style="font-family:Courier,serif;font-size:13.333334px">return RCC_OK;</span><br /><span style="font-family:Courier,serif;font-weight:bold;font-size:13.333334px">}</span></p>
    <p class="Code" dir="ltr"><span style="font-family:Courier,serif;font-style:italic;font-weight:bold;font-size:13.333334px">/* continued on next page */</span><br /></p>
    <p class="Code" dir="ltr" style="page-break-before:always"><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">/* Initialize dispatch table provided to container. We only need the</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px"> * initialize method to register the callback.  No run method needed */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">RCCDispatch Xyz = {</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Consistency checking attributes */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCC_VERSION, 1, 1, sizeof(XyzProperties), RCC_NULL, RCC_FALSE,</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* Methods */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	initialize, RCC_NULL, RCC_NULL, RCC_NULL, RCC_NULL, RCC_NULL,</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">	RCC_NULL, run,</span><br /><span style="font-family:Courier,serif;font-style:italic;font-size:13.333334px">	/* all remaining members zero/NULL */</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">};</span></p>
    <p class="Body" dir="ltr">Other than the compute function, the above example compiles to use less than 330 bytes on a Pentium processor.</p>
    <h2 dir="ltr" id="toc140"><span class="SectionNumber">9.2 </span><a id="RefHeadingToc717411826048042"></a>C++ Language Examples</h2>
    <p class="Body" dir="ltr">Here is a simple example of a C++ language “xyz” worker whose:</p>
    <ul class="listlevel1WWNum32">
      <li>
        <p class="ListBullet" dir="ltr">Initial run condition was the default (condition == NULL, usecs == 0, run when all ports are ready, no timeout),</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr"><span class="FirstEmphasis">initialize, start</span> and <span class="FirstEmphasis">release</span> methods are not needed or implemented.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One input port (<span class="Code">in</span>),  and one output port (<span class="Code">out</span>)</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One interface operation Op1 on input, which is an array of 100 “shorts”.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One interface operation Op2 on output, a sequence of shorts.</p>
      </li>
      <li>
        <p class="ListBullet" dir="ltr">One simple property, called center_frequency, of type float.</p>
      </li>
    </ul>
    <p class="Body" dir="ltr">The OPS for the <span class="Code">in</span> port would be (in the <span class="Code">shortarray-prot.xml</span> file):</p>
    <p class="Code" dir="ltr" style="font-size:13.333334px">&lt;protocol&gt;<br />  &lt;operation name='op1'&gt;<br />    &lt;argument name='shorts' type='short' arraylength='100'/&gt;<br />  &lt;/operation&gt;<br />&lt;/protocol&gt;</p>
    <p class="Body" dir="ltr">'The OPS for the output port would be (in the <span class="Code">shortseq-prot.xml</span> file)</p>
    <p class="Code" dir="ltr" style="font-size:13.333334px">&lt;protocol&gt;<br />  &lt;operation name='op2'&gt;<br />    &lt;argument name='shorts' type='short' sequencelength='0'/&gt;<br />  &lt;/operation&gt;<br />&lt;/protocol&gt;</p>
    <p class="Body" dir="ltr">The OCS for the component would be (in the <span class="Code">xyz-spec.xml</span> file):</p>
    <p class="Code" dir="ltr" style="font-size:13.333334px">&lt;componentSpec&gt;<br />  &lt;port name='in' protocol='shortarray'/&gt;<br />  &lt;port name='out' protocol='shortseq'/&gt;<br />&lt;/componentSpec&gt;</p>
    <p class="Body" dir="ltr">The OWD would be (in the file <span class="Code">xyz.xml</span>):</p>
    <p class="Code" dir="ltr" style="font-size:13.333334px">&lt;RccWorker spec=”xyz-spec” language='c++'/&gt;</p>
    <p class="Body" dir="ltr">The worker would have automatically generated types and structures like this (based on OCS and OWD), and put in a file called <span class="Code">xyz-worker.hh</span>:</p>
    <p class="Code" dir="ltr"><span style="font-family:Courier,serif;font-size:13.333334px">#include &lt;</span>RCC_Worker.h<span style="font-family:Courier,serif;font-size:13.333334px">&gt;<br />namespace XyzWorkerTypes {</span><br />  <span style="font-family:Courier,serif;font-size:13.333334px">struct Properties {                // structure for properties<br />    // internal stuff here<br />    const RCCFloat center_frequency; // const since not volatile</span><br />  <span style="font-family:Courier,serif;font-size:13.333334px">};<br />  class XyzWorkerBase {              // base class inherited by worker<br />  // internal stuff here, including port members<br />  };</span><br /><span style="font-family:Courier,serif;font-size:13.333334px">}</span></p>
    <p class="Body" dir="ltr">The actual code for the C++worker would look like this (in the file <span class="Code">xyz.cc</span>):</p>
    <p class="Code" dir="ltr"><span style="font-size:13.333334px">#include </span><span style="font-family:&apos;Courier New&apos;,monospace;font-size:13.333334px">"</span><span style="font-size:13.333334px">xyz-worker.hh</span><span style="font-family:&apos;Courier New&apos;,monospace;font-size:13.333334px">"  // include generated declarations</span><span style="font-size:13.333334px"><br /></span><span style="font-size:13.333334px"><br />using namespace OCPI::RCC; // for access to RCC data types and constants<br />using namespace Bias_ccWorkerTypes;  // for generated types<br /><br />struct XyzWorker : public XyzWorkerBase { // use struct to avoid </span><span style="font-family:&apos;Courier New&apos;,monospace;font-size:13.333334px">"</span><span style="font-size:13.333334px">public</span><span style="font-family:&apos;Courier New&apos;,monospace;font-size:13.333334px">"</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">// In constructor, set output operation to be a constant,<br />  // since it is the only one used, but not the default (0)</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">XyzWorker() {</span><span style="font-size:13.333334px"><br />    </span><span style="font-size:13.333334px">out.setDefaultOpCode(ProtOp2_OPERATION);</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">}</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">void<br />  compute(int16_t *in, int16_t *out, size_t n, float freq) { ... }</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">// Define run method to call the “compute” function, reading from</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">// input buffer, writing to output, applying current value of the</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">// centerFrequency” property</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">RCCResult</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">run(RCCBoolean /* timedout */) {</span><span style="font-size:13.333334px"><br /></span><span style="font-size:13.333334px">    // Do computation from in.op0.shorts(), using frequency, put results</span><span style="font-size:13.333334px"><br /></span><span style="font-size:13.333334px">    // in out.op2.shorts().<br />    out.op2().shorts().resize(in.op0().shorts().size());</span><span style="font-size:13.333334px"><br />    </span><span style="font-size:13.333334px">compute(in.op0().shorts().data(), out.op2().shorts().data(),<br />            in.op0().shorts().size(), properties().center_frequency);</span><span style="font-size:13.333334px"><br />    </span><span style="font-size:13.333334px">// Ask container to send output and get new input/output buffers */</span><span style="font-size:13.333334px"><br />    </span><span style="font-size:13.333334px">return RCC_ADVANCE;</span><span style="font-size:13.333334px"><br />  </span><span style="font-size:13.333334px">}<br />};</span></p>
    <h3 dir="ltr" id="toc141"><span class="SectionNumber">9.2.1 </span><a id="RefHeadingToc717431826048042"></a><a id="Toc2117811281"></a>Worker Using the State-machine Style</h3>
    <p class="Body" dir="ltr">This illustrates a finite state machine coding style in a C++ worker that maintains an internal state to simulate blocking on a two-way remote call until the response is received and processing can continue.  It accepts data on its <span class="Code">in</span> port, performs computation in-place (in the input buffer), then sends this buffer to an <span class="Code">out</span> port, and starts awaiting a response from a <span class="Code">response</span> input port.  When the response arrives, it sends the response to an <span class="Code">other</span> output port, and reverts to its original condition, waiting for input.</p>
    <p class="Code" dir="ltr" style="font-size:13.333334px">#include "xyz-worker.hh"  // include generated declarations<br /><br />using namespace OCPI::RCC; // for access to RCC data types and constants<br />using namespace Bias_ccWorkerTypes;  // for this worker's generated types<br /><br />struct XyzWorker : public XyzWorkerBase { // use struct to avoid "public"<br />  // Define two different run conditions to represent two states<br />  // These could be static and initialized outside the class too.<br />  RCCRunCondition m_awaitingInput, m_awaitingResponse;<br />  XyzWorker()<br />  : m_awaitingInput(1 &lt;&lt; XYZ_IN, 0),<br />    m_waitingResponse(1 &lt;&lt; XYZ_RESPONSE, 0) {<br />    setRunCondition(&amp;m_awaitingInput);<br />  }<br />  RCCResult<br />  run(RCCBoolean /* timedout */) {<br />    // Use run condition as state indicator<br />    if (getRunCondition() == &amp;m_awaitingInput) {<br />      // do some computation based in in.op0().shorts(), and frequency;<br />      // put results back in same buffer (in-place)<br />      compute(in.op0().shorts().data(), in.op0().shorts().data(),<br />              in.op0().shorts().size(), properties().center_frequency);<br />      // Input port is advanced by taking buffer away from it.<br />      out.send(in);  // send input buffer to output, same op and length,<br />      setRunCondition(&amp;m_awaitingResponse); // await response<br />    } else {<br />      other.send(response);                 // got response, send to other<br />      setRunCondition(&amp;awaitingInput);      // change state to await input<br />    }<br />    return RCC_OK;<br />  }<br />};</p>
    <h1 dir="ltr" id="toc142"><span class="SectionNumber">10 </span><a id="RefHeading119071972665394"></a>Glossary</h1>
    <p class="Body" dir="ltr"><span style="font-weight:bold">Configuration Properties</span> – Named values associated with a worker that may be read or written by the control application and/or the worker. Their values indicate or control aspects of the worker’s operation. Reading and writing these property values may or may not have side effects on the operation of the worker. Configuration properties with side effects can be used for custom worker control. Each worker may have its own, possibly unique, set of configuration properties.  Some properties come from the OCS: they are common to all implementations that implement that OCS.  Other properties can be added in the OWD that are specific to that particular worker implementation.</p>
    <p class="Body" dir="ltr"><span style="font-weight:bold">Container</span> – An OpenCPI infrastructure element that “contains”, manages and executes a set of application workers.  Logically, the container “surrounds” the workers, mediating all interactions between the worker and the rest of the system.</p>
    <p class="Body" dir="ltr"><span style="font-family:Arial,serif;font-weight:bold;font-size:16.0px">Worker Attribute</span><span style="font-family:Arial,serif;font-size:16.0px"> – An attribute related to a particular implementation (design) of a worker.  I.e. one that is not necessarily common across a set of implementations of the same high level component definition (OCS).</span></p>
    <p class="Body" dir="ltr" style="font-size:16.0px"><span style="font-weight:bold">Worker</span> – A concrete implementation of a component.  Also, a runtime instance of a worker source code implementation, generally existing within a container.  A worker is implemented consistent with its authoring model and its OWD.</p>
    <h1 dir="ltr" id="toc143"><span class="SectionNumber">11 </span><a id="Toc270018464"></a><a id="RefHeading10658140039662"></a>List of Abbreviations and Acronyms</h1>
    <table cellspacing="0" dir="ltr" id="Table10table" style="margin-top:0;margin-bottom:0;margin-left:0;margin-right:auto;width:583.6704px;border-collapse:separate;border-spacing:0;table-layout:fixed">
      <tbody>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">ACI</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Application Control Interface</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">API</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Application Programming Interface</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">CBD</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Component-Based Development</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">CDG</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">OpenCPI Component Development Guide</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">CDK</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Component Developer’s Kit</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">OCS</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">OpenCPI Component Specification</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">OpenCPI</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Open-Source Component Portability Infrastructure</p>
          </td>
        </tr>
        <tr>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">OWD</p>
          </td>
          <td style="border-top:none;border-bottom:1.0px solid #000001;border-left:1.0px solid #000001;border-right:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">OpenCPI Worker Description</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">RCC</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Resource Constrained C Language</p>
          </td>
        </tr>
        <tr>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:117.7312px">
            <p class="TableContents" dir="ltr">XML</p>
          </td>
          <td style="border:1.0px solid #000001;padding:0;vertical-align:top;width:461.92963px">
            <p class="TableContents" dir="ltr">Extensible Markup Language</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Standard" dir="ltr"> </p>
  </body>
</html>
